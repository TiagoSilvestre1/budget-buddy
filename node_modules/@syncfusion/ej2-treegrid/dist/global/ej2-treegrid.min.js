/*!
*  filename: ej2-treegrid.min.js
*  version : 21.2.3
*  Copyright Syncfusion Inc. 2001 - 2020. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
this.ej=this.ej||{},this.ej.treegrid=function(e,t,r,i,n,o){"use strict";function a(e){if(e.dataSource instanceof n.DataManager){var t=e.dataSource.adaptor;return t instanceof n.ODataAdaptor||t instanceof n.WebApiAdaptor||t instanceof n.WebMethodAdaptor||t instanceof n.CacheAdaptor||t instanceof n.UrlAdaptor}return!1}function s(e){return!!(e.dataSource&&"result"in e.dataSource)}function d(e){for(var t=0;t<e.columns.length;t++)if(e.columns[parseInt(t.toString(),10)].showCheckbox)return!0;return!1}function l(e){return!((t.isNullOrUndefined(e.grid.searchSettings.key)||""===e.grid.searchSettings.key||"Child"!==e.searchSettings.hierarchyMode&&"None"!==e.searchSettings.hierarchyMode)&&(!e.allowFiltering||!e.grid.filterSettings.columns.length||"Child"!==e.filterSettings.hierarchyMode&&"None"!==e.filterSettings.hierarchyMode))}function p(e){for(var t=[],i=0,n=Object.keys(e).length;i<n;i++)r.getObject("hasChildRecords",e[parseInt(i.toString(),10)])&&t.push(e[parseInt(i.toString(),10)]);return t}function h(e,r,i){var n,o=t.isNullOrUndefined(r.parentItem)?null:y(e,r.parentItem.uniqueID);return null==o||(!e.initialRender||t.isNullOrUndefined(o[e.expandStateMapping])||o[e.expandStateMapping]?!1!==o.expanded&&(!o.parentItem||(n=y(e,o.parentItem.uniqueID),n&&e.initialRender&&!t.isNullOrUndefined(n[e.expandStateMapping])&&!n[e.expandStateMapping]?(n.expanded=!1,!1):(!n||!1!==n.expanded)&&(!n||h(e,n,i)))):(o.expanded=!1,!1))}function c(e){var r=[];if(t.isNullOrUndefined(e)||!e.hasChildRecords&&!t.isNullOrUndefined(e.childRecords)&&!e.childRecords.length)return[];if(!t.isNullOrUndefined(e.childRecords))for(var i=e.childRecords.filter(function(e){return!e.isSummaryRow}),n=0,o=Object.keys(i).length;n<o;n++)r.push(i[parseInt(n.toString(),10)]),(i[parseInt(n.toString(),10)].hasChildRecords||!t.isNullOrUndefined(i[parseInt(n.toString(),10)].childRecords)&&i[parseInt(n.toString(),10)].childRecords.length)&&(r=r.concat(c(i[parseInt(n.toString(),10)])));return r}function u(e){if(a(e)){var r=e.dataSource;return!t.isNullOrUndefined(r.ready)}return!0}function g(e){for(var t,r,i=[],n=0;e&&n<e.length;n++){r=Object.keys(e[parseInt(n.toString(),10)]),t={};for(var o=0;o<r.length;o++)t[r[parseInt(o.toString(),10)]]=e[parseInt(n.toString(),10)][r[parseInt(o.toString(),10)]];i.push(t)}return i}function f(e){return delete e.hasChildRecords,delete e.childRecords,delete e.index,delete e.parentItem,delete e.level,delete e.taskData,delete e.uniqueID,e}function y(e,t,r){if(r){return e.uniqueIDFilterCollection[""+t]}return e.uniqueIDCollection[""+t]}function m(e){var t=window.getComputedStyle(e);return"none"===t.display||"hidden"===t.visibility}function v(e,r,i,o,a,s,d){var l,p,h,c=e.value,u=e.action,f=r.grid.getPrimaryKeyFieldNames()[0],m=r.dataSource instanceof n.DataManager?r.dataSource.dataSource.json:r.dataSource,v=[],R=c,C=!1;if("Batch"===r.editSettings.mode&&(h=r.grid.editModule.getBatchChanges()),"add"===u||"batchsave"===u&&"Batch"===r.editSettings.mode&&h.addedRecords.length){var x=S(e,m,r,i,o,a,d);c=x.value,C=x.isSkip}if(c instanceof Array?v=g(c):v.push(t.extend({},c)),!C&&("add"!==u||"Top"!==r.editSettings.newRowPosition&&"Bottom"!==r.editSettings.newRowPosition))for(var b=0;b<v.length;b++){"object"==typeof v[parseInt(b.toString(),10)][""+f]&&(v[parseInt(b.toString(),10)]=v[parseInt(b.toString(),10)][""+f]);var D=v[parseInt(b.toString(),10)].taskData?Object.keys(v[parseInt(b.toString(),10)].taskData):Object.keys(v[parseInt(b.toString(),10)]);l=m.length;for(;l--&&l>=0&&"break"!==function(){if(m[parseInt(l.toString(),10)][""+f]===v[parseInt(b.toString(),10)][""+f]){if("delete"!==u){if("edit"===u){for(p=0;p<D.length;p++)if(Object.prototype.hasOwnProperty.call(m[parseInt(l.toString(),10)],D[parseInt(p.toString(),10)])&&("Cell"!==r.editSettings.mode||!t.isNullOrUndefined(h)&&0===h.changedRecords.length||D[parseInt(p.toString(),10)]===s)){var e=y(r,v[parseInt(b.toString(),10)].uniqueID);m[parseInt(l.toString(),10)][D[parseInt(p.toString(),10)]]=v[parseInt(b.toString(),10)][D[parseInt(p.toString(),10)]],e&&e.taskData&&(e.taskData[D[parseInt(p.toString(),10)]]=e[D[parseInt(p.toString(),10)]]=m[parseInt(l.toString(),10)][D[parseInt(p.toString(),10)]])}}else if("add"===u||"batchsave"===u){var n=void 0;"Child"===r.editSettings.newRowPosition?i?(R.taskData[""+r.parentIdMapping]=m[parseInt(l.toString(),10)][""+r.idMapping],m.splice(l+1,0,R.taskData)):(Object.prototype.hasOwnProperty.call(m[parseInt(l.toString(),10)],r.childMapping)||(m[parseInt(l.toString(),10)][""+r.childMapping]=[]),m[parseInt(l.toString(),10)][""+r.childMapping].push(R.taskData),I(f,m[parseInt(l.toString(),10)],u,r,i,R)):"Below"===r.editSettings.newRowPosition?(m.splice(l+1,0,R.taskData),t.isNullOrUndefined(R.parentItem)||I(f,m[l+1],u,r,i,R)):o?"Above"===r.editSettings.newRowPosition&&(m.splice(l,0,R.taskData),t.isNullOrUndefined(R.parentItem)||I(f,m[parseInt(l.toString(),10)],u,r,i,R)):(n=0,m.splice(n,0,R.taskData))}return"break"}var a=m[parseInt(l.toString(),10)];if(m.splice(l,1),i){if(!t.isNullOrUndefined(a[""+r.parentIdMapping]))for(var d=r.flatData.filter(function(e){return e[""+r.idMapping]===a[""+r.parentIdMapping]})[0],c=d?d[""+r.childMapping]:[],g=c.length-1;g>=0;g--)if(c[parseInt(g.toString(),10)][""+r.idMapping]===a[""+r.idMapping]){r.enableImmutableMode||d.childRecords.length!==d.Children.length||d.childRecords.splice(g,1),c.splice(g,1),c.length||(d.hasChildRecords=!1,I(f,d,u,r,i));break}return"break"}}else t.isNullOrUndefined(m[parseInt(l.toString(),10)][""+r.childMapping])||w(m[parseInt(l.toString(),10)][""+r.childMapping],v[parseInt(b.toString(),10)],u,f,r,i,R,s)&&I(f,m[parseInt(l.toString(),10)],u,r,i)}(););}}function S(e,r,i,n,o,a,s){var d,l=!1,p=i.grid.getCurrentViewRecords();switch(d=t.extend({},e.value),d=f(d),i.editSettings.newRowPosition){case"Top":r.unshift(d),l=!0;break;case"Bottom":r.push(d),l=!0;break;case"Above":d=f(t.isNullOrUndefined(s)?d=t.extend({},p[o+1]):d=t.extend({},s));break;case"Below":case"Child":if(t.isNullOrUndefined(s)){var h=i.grid.getPrimaryKeyFieldNames()[0],c=p[parseInt(o.toString(),10)];d=f(d=!t.isNullOrUndefined(c)&&c[""+h]===e.value[""+h]||-1!==a?t.extend({},c):t.extend({},e.value));i.editModule.internalProperties.taskData=d}else d=f(d=t.extend({},s));-1===a&&(r.unshift(d),l=!0)}return{value:d,isSkip:l}}function w(e,r,i,n,o,a,s,d){for(var l=!1,p=e.length;p--&&p>=0;)if(e[parseInt(p.toString(),10)][""+n]===r[""+n]||a&&e[parseInt(p.toString(),10)][o.parentIdMapping]===r[o.idMapping]){if("edit"===i){for(var h=Object.keys(r),c=y(o,r.uniqueID),u=0;u<h.length;u++)if(Object.prototype.hasOwnProperty.call(e[parseInt(p.toString(),10)],h[parseInt(u.toString(),10)])&&("Cell"!==o.editSettings.mode||h[parseInt(u.toString(),10)]===d)&&(c[h[parseInt(u.toString(),10)]]=c.taskData[h[parseInt(u.toString(),10)]]=e[parseInt(p.toString(),10)][h[parseInt(u.toString(),10)]]=r[h[parseInt(u.toString(),10)]],"Normal"===o.grid.editSettings.mode&&"Cell"===o.editSettings.mode)){o.grid.editModule.editModule.editRowIndex=r.index,o.grid.editModule.editModule.updateCurrentViewData(r)}break}"add"===i||"batchsave"===i?"Child"===o.editSettings.newRowPosition?a?(s[""+o.parentIdMapping]=e[parseInt(p.toString(),10)][o.idMapping],e.splice(p+1,0,s),I(n,e[parseInt(p.toString(),10)],i,o,a,s)):(Object.prototype.hasOwnProperty.call(e[parseInt(p.toString(),10)],o.childMapping)||(e[parseInt(p.toString(),10)][o.childMapping]=[]),e[parseInt(p.toString(),10)][o.childMapping].push(s.taskData),I(n,e[parseInt(p.toString(),10)],i,o,a,s)):"Above"===o.editSettings.newRowPosition?(e.splice(p,0,s.taskData),t.isNullOrUndefined(s.parentItem)||I(n,e[parseInt(p.toString(),10)],i,o,a,s)):"Below"===o.editSettings.newRowPosition&&(e.splice(p+1,0,s.taskData),t.isNullOrUndefined(s.parentItem)||I(n,e[parseInt(p.toString(),10)],i,o,a,s)):(e.splice(p,1),e.length||(l=!0))}else t.isNullOrUndefined(e[parseInt(p.toString(),10)][o.childMapping])||w(e[parseInt(p.toString(),10)][o.childMapping],r,i,n,o,a,s,d)&&I(n,e[parseInt(p.toString(),10)],i,o,a);return l}function I(e,r,i,o,a,s){if("Above"!==o.editSettings.newRowPosition&&"Below"!==o.editSettings.newRowPosition||"add"!==i&&"batchsave"!==i||t.isNullOrUndefined(s.parentItem)){var d,l=o.grid.getCurrentViewRecords();if(l.map(function(t,i){if(t[""+e]===r[""+e])return void(d=i)}),o.enableVirtualization&&t.isNullOrUndefined(d)){var p=t.getValue("uniqueIDCollection."+s.parentUniqueID,o);r=p}if(t.isNullOrUndefined(d)||(r=l[parseInt(d.toString(),10)]),o.enableVirtualization&&t.isNullOrUndefined(r)&&!t.isNullOrUndefined(s)&&(r=t.getValue("uniqueIDCollection."+s.parentUniqueID,o)),a||t.isNullOrUndefined(r.childRecords)||!r.childRecords.length?r.hasChildRecords=!1:r.hasChildRecords=!0,"add"===i||"batchsave"===i){r.expanded=!0,r.hasChildRecords=!0,o.sortSettings.columns.length&&t.isNullOrUndefined(s)&&(s=l.filter(function(e){return e.parentUniqueID===r.uniqueID?e:null}));var h=s?s instanceof Array?s[0]:s:l[d+1];"Below"!==o.editSettings.newRowPosition&&(Object.prototype.hasOwnProperty.call(r,"childRecords")?t.isNullOrUndefined(s)||r[""+e]===s[""+e]||r.childRecords.push(s):r.childRecords=[],-1===r.childRecords.indexOf(h)&&r[""+e]!==s[""+e]&&r.childRecords.unshift(h),a&&(Object.prototype.hasOwnProperty.call(r,o.childMapping)||(r[o.childMapping]=[]),-1===r[""+o.childMapping].indexOf(h)&&r[""+e]!==s[""+e]&&r[o.childMapping].unshift(h)))}for(var c=o.grid.getPrimaryKeyFieldNames()[0],u=o.grid.dataSource instanceof n.DataManager?o.grid.dataSource.dataSource.json:o.grid.dataSource,g=0;g<u.length;g++)if(u[parseInt(g.toString(),10)][""+c]===r[""+c]){u[parseInt(g.toString(),10)]=r;break}o.grid.setRowData(e,r);var f=o.getRowByIndex(d);"Batch"===o.editSettings.mode&&(f="add"===i?o.getRows()[o.grid.getCurrentViewRecords().indexOf(r)]:o.getRows()[o.grid.getRowIndexByPrimaryKey(r[""+e])]);var m=void 0;if((o.frozenRows||o.getFrozenColumns())&&(m=o.getMovableRowByIndex(d)),!o.enableVirtualization&&!t.isNullOrUndefined(f)||!t.isNullOrUndefined(m)){var v=o.treeColumnIndex;o.allowRowDragAndDrop&&o.enableImmutableMode&&(v+=1),o.renderModule.cellRender({data:r,cell:f.cells[parseInt(v.toString(),10)]?f.cells[parseInt(v.toString(),10)]:m.cells[v-o.getFrozenColumns()],column:o.grid.getColumns()[o.treeColumnIndex],requestType:i}),(o.enableImmutableMode&&"indenting"===o.action||"outdenting"===o.action)&&o.renderModule.RowModifier({data:r,row:f})}}else y(o,s.parentItem.uniqueID).childRecords.push(s)}var R=function(){function e(e){this.allowEditing=!0,this.edit={},this.disableHtmlEncode=!0,this.allowReordering=!0,this.showColumnMenu=!0,this.allowFiltering=!0,this.allowSorting=!0,this.allowResizing=!0,this.filter={},t.merge(this,e)}return e.prototype.setProperties=function(e){for(var t=Object.keys(e),r=0;r<t.length;r++)if(this[t[parseInt(r.toString(),10)]]=e[t[parseInt(r.toString(),10)]],this.parent&&this.parent.isReact&&"template"===t[parseInt(r.toString(),10)]){this.parent.clipboardModule.treeGridParent.renderModule.refreshReactColumnTemplateByUid(this.uid)}},e}(),C=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),x=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},b=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return C(r,e),x([t.Property("Spinner")],r.prototype,"indicatorType",void 0),r}(t.ChildProperty),D=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),M=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},O=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return D(r,e),M([t.Property()],r.prototype,"field",void 0),M([t.Property()],r.prototype,"operator",void 0),M([t.Property()],r.prototype,"value",void 0),M([t.Property()],r.prototype,"matchCase",void 0),M([t.Property()],r.prototype,"ignoreAccent",void 0),M([t.Property()],r.prototype,"predicate",void 0),M([t.Property({})],r.prototype,"actualFilterValue",void 0),M([t.Property({})],r.prototype,"actualOperator",void 0),M([t.Property()],r.prototype,"type",void 0),M([t.Property()],r.prototype,"ejpredicate",void 0),M([t.Property()],r.prototype,"uid",void 0),M([t.Property()],r.prototype,"isForeignKey",void 0),r}(t.ChildProperty),P=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return D(r,e),M([t.Collection([],O)],r.prototype,"columns",void 0),M([t.Property("FilterBar")],r.prototype,"type",void 0),M([t.Property()],r.prototype,"mode",void 0),M([t.Property(!0)],r.prototype,"showFilterBarStatus",void 0),M([t.Property(1500)],r.prototype,"immediateModeDelay",void 0),M([t.Property()],r.prototype,"operators",void 0),M([t.Property(!1)],r.prototype,"ignoreAccent",void 0),M([t.Property("Parent")],r.prototype,"hierarchyMode",void 0),r}(t.ChildProperty),E=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),A=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},N=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return E(r,e),A([t.Property("Both")],r.prototype,"wrapMode",void 0),r}(t.ChildProperty),k=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),q="https://ej2.syncfusion.com/documentation/treegrid",U="https://ej2.syncfusion.com/documentation",V=!1,B=function(e){function i(t){return r.Grid.Inject(r.Logger),e.call(this,t)||this}return k(i,e),i.prototype.getModuleName=function(){return"logger"},i.prototype.log=function(e,i){e instanceof Array||(e=[e]);for(var n=e,o=0;o<n.length;o++){var a=r.detailLists[n[parseInt(o.toString(),10)]],s=a.check(i,this.parent);if(s.success){var d=a.generateMessage(i,this.parent,s.options);d=d.replace("EJ2Grid","EJ2TreeGrid").replace("* Hierarchy Grid","").replace("* Grouping",""),V&&"primary_column_missing"===n[parseInt(o.toString(),10)]&&(d=d.replace("Editing","Row DragAndDrop"),V=!1);var l=d.indexOf("https"),p=d.substring(l);"module_missing"===n[parseInt(o.toString(),10)]?d=d.replace(p,q+"/modules"):"primary_column_missing"===n[parseInt(o.toString(),10)]||"selection_key_missing"===n[parseInt(o.toString(),10)]?d=d.replace(p,U+"/api/treegrid/column/#isprimarykey"):"grid_remote_edit"===n[parseInt(o.toString(),10)]?d=d.replace(p,q+"/edit"):"virtual_height"===n[parseInt(o.toString(),10)]?d=d.replace(p,q+"/virtual"):"check_datasource_columns"===n[parseInt(o.toString(),10)]?d=d.replace(p,q+"/columns"):"locale_missing"===n[parseInt(o.toString(),10)]&&(d=d.replace(p,q+"/global-local/#localization")),"datasource_syntax_mismatch"===n[parseInt(o.toString(),10)]?t.isNullOrUndefined(this.treeGridObj)||t.isNullOrUndefined(this.treeGridObj.dataStateChange)||console[a.logType](d):console[a.logType](d)}}},i.prototype.treeLog=function(e,t,r){this.treeGridObj=r,e instanceof Array||(e=[e]);var i=e;r.allowRowDragAndDrop&&!r.columns.filter(function(e){return e.isPrimaryKey}).length&&(V=!0,this.log("primary_column_missing",t));for(var n=0;n<i.length;n++){var o=T[i[parseInt(n.toString(),10)]],a=o.check(t,r);if(a.success){var s=o.generateMessage(t,r,a.options);console[o.logType](s)}}},i}(r.Logger),T={mapping_fields_missing:{type:"mapping_fields_missing",logType:"error",check:function(e,r){var i={success:!1};return(t.isNullOrUndefined(r.idMapping)&&t.isNullOrUndefined(r.childMapping)&&t.isNullOrUndefined(r.parentIdMapping)||!t.isNullOrUndefined(r.idMapping)&&t.isNullOrUndefined(r.parentIdMapping)||t.isNullOrUndefined(r.idMapping)&&!t.isNullOrUndefined(r.parentIdMapping))&&(i={success:!0}),i},generateMessage:function(){return"[EJ2TreeGrid.Error]: MAPPING FIELDS MISSING \nOne of the following fields is missing. It is required for the hierarchical relationship of records in TreeGrid:\n* childMapping\n* idMapping\n* parentIdMapping\nRefer to the following documentation links for more details.\n"+U+"/api/treegrid#childmapping\n"+U+"/api/treegrid#idmapping\n"+U+"/api/treegrid#$parentidmapping"}}},z=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),L=function(e){function r(t,r){var i=e.call(this,t.grid,r)||this;return i.treeCopyContent="",i.copiedUniqueIdCollection=[],i.treeGridParent=t,i.serviceLocator=r,i}return z(r,e),r.prototype.setCopyData=function(r){var i=this.treeGridParent.getCurrentViewRecords();if(""===window.getSelection().toString()){this.clipBoardTextArea.value=this.copyContent="";var n=this.treeGridParent.grid.getRows();if("Cell"!==this.treeGridParent.selectionSettings.mode){for(var o=this.treeGridParent.getSelectedRowIndexes().sort(function(e,t){return e-t}),a=0;a<o.length;a++)if(a>0&&(this.treeCopyContent+="\n"),!n[o[parseInt(a.toString(),10)]].classList.contains("e-summaryrow")){var s=[].slice.call(n[o[parseInt(a.toString(),10)]].querySelectorAll(".e-rowcell")),d=this.treeGridParent.getSelectedRecords()[parseInt(a.toString(),10)].uniqueID;-1===this.copiedUniqueIdCollection.indexOf(d)&&("Parent"!==this.treeGridParent.copyHierarchyMode&&"Both"!==this.treeGridParent.copyHierarchyMode||this.parentContentData(i,o[parseInt(a.toString(),10)],n,r,a),this.getCopyData(s,!1,"\t",r),this.treeCopyContent+=this.copyContent,this.copiedUniqueIdCollection.push(d),this.copyContent="","Child"!==this.treeGridParent.copyHierarchyMode&&"Both"!==this.treeGridParent.copyHierarchyMode||this.childContentData(i,o[parseInt(a.toString(),10)],n,r))}if(r){for(var l=[],a=0;a<this.treeGridParent.getVisibleColumns().length;a++)l[parseInt(a.toString(),10)]=this.treeGridParent.getVisibleColumns()[parseInt(a.toString(),10)].headerText;this.getCopyData(l,!1,"\t",r),this.treeCopyContent=this.copyContent+"\n"+this.treeCopyContent}var p={data:this.treeCopyContent,cancel:!1};if(this.treeGridParent.trigger("beforeCopy",p),p.cancel)return;this.clipBoardTextArea.value=this.copyContent=p.data,t.Browser.userAgent.match(/ipad|ipod|iphone/i)?this.clipBoardTextArea.setSelectionRange(0,this.clipBoardTextArea.value.length):this.clipBoardTextArea.select(),this.isSelect=!0,this.copiedUniqueIdCollection=[],this.treeCopyContent=""}else e.prototype.setCopyData.call(this,r)}},r.prototype.parentContentData=function(e,r,i,n,o){if(!t.isNullOrUndefined(e[parseInt(r.toString(),10)].parentItem))for(var a=e[parseInt(r.toString(),10)].parentItem.level,s=0;s<a+1;s++)for(var d=0;d<e.length;d++)if(!t.isNullOrUndefined(e[parseInt(r.toString(),10)].parentItem)&&e[parseInt(d.toString(),10)].uniqueID===e[parseInt(r.toString(),10)].parentItem.uniqueID){r=d;var l=[].slice.call(i[parseInt(r.toString(),10)].querySelectorAll(".e-rowcell")),p=e[parseInt(d.toString(),10)].uniqueID;if(-1===this.copiedUniqueIdCollection.indexOf(p)){this.getCopyData(l,!1,"\t",n),this.treeCopyContent=o>0?this.treeCopyContent+this.copyContent+"\n":this.copyContent+"\n"+this.treeCopyContent,this.copiedUniqueIdCollection.push(p),this.copyContent="";break}}},r.prototype.copy=function(t){e.prototype.copy.call(this,t)},r.prototype.paste=function(t,r,i){e.prototype.paste.call(this,t,r,i)},r.prototype.getModuleName=function(){return"clipboard"},r.prototype.destroy=function(){e.prototype.destroy.call(this)},r.prototype.childContentData=function(e,r,i,n){if(e[parseInt(r.toString(),10)].hasChildRecords)for(var o=e[parseInt(r.toString(),10)].childRecords,a=0;a<o.length;a++)for(var s=0;s<e.length;s++)if(!t.isNullOrUndefined(o[parseInt(a.toString(),10)].uniqueID)&&e[parseInt(s.toString(),10)].uniqueID===o[parseInt(a.toString(),10)].uniqueID){if(!t.isNullOrUndefined(i[parseInt(s.toString(),10)])&&!i[parseInt(s.toString(),10)].classList.contains("e-summaryrow")){var d=[].slice.call(i[parseInt(s.toString(),10)].querySelectorAll(".e-rowcell")),l=e[parseInt(s.toString(),10)].uniqueID;-1===this.copiedUniqueIdCollection.indexOf(l)&&(this.getCopyData(d,!1,"\t",n),this.treeCopyContent+="\n"+this.copyContent,this.copyContent="",this.copiedUniqueIdCollection.push(l),this.childContentData(e,s,i,n))}break}},r}(r.Clipboard),F=function(){function e(e){this.parent=e,this.selectedItems=[],this.selectedIndexes=[],this.filteredList=[],this.searchingRecords=[],this.addEventListener()}return e.prototype.getModuleName=function(){return"selection"},e.prototype.addEventListener=function(){this.parent.on("dataBoundArg",this.headerCheckbox,this),this.parent.on("columnCheckbox",this.columnCheckbox,this),this.parent.on("updateGridActions",this.updateGridActions,this),this.parent.grid.on("colgroup-refresh",this.headerCheckbox,this),this.parent.on("checkboxSelection",this.checkboxSelection,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("dataBoundArg",this.headerCheckbox),this.parent.off("columnCheckbox",this.columnCheckbox),this.parent.grid.off("colgroup-refresh",this.headerCheckbox),this.parent.off("checkboxSelection",this.checkboxSelection),this.parent.off("updateGridActions",this.updateGridActions))},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.checkboxSelection=function(e){var t,i=r.getObject("target",e),n=r.parentsUntil(i,"e-checkbox-wrapper");if(n&&n.querySelectorAll(".e-treecheckselect").length>0){t=n.querySelector('input[type="checkbox"]');var o=[];o.push(i.closest("tr").rowIndex),this.selectCheckboxes(o),this.triggerChkChangeEvent(t,t.nextElementSibling.classList.contains("e-check"),i.closest("tr"))}else if(n&&n.querySelectorAll(".e-treeselectall").length>0&&this.parent.autoCheckHierarchy){var a=!n.querySelector(".e-frame").classList.contains("e-check")&&!n.querySelector(".e-frame").classList.contains("e-stop");this.headerSelection(a),t=n.querySelector('input[type="checkbox"]'),this.triggerChkChangeEvent(t,a,i.closest("tr"))}},e.prototype.triggerChkChangeEvent=function(e,t,r){var i=this.parent.getCurrentViewRecords()[r.rowIndex],n={checked:t,target:e,rowElement:r,rowData:e.classList.contains("e-treeselectall")?this.parent.getCheckedRecords():i};this.parent.trigger("checkboxChange",n)},e.prototype.getCheckboxcolumnIndex=function(){for(var e,t,r=this.parent.stackedHeader?this.parent.columnModel:this.parent.columns,i=0;i<r.length;i++)r[parseInt(i.toString(),10)].showCheckbox&&(e=r[parseInt(i.toString(),10)].uid);for(var n=this.parent.getHeaderContent().querySelectorAll(".e-headercelldiv").length,o=0;o<n;o++)this.parent.getHeaderContent().querySelectorAll(".e-headercelldiv")[parseInt(o.toString(),10)].getAttribute("e-mappinguid")===e&&(t=o);return t},e.prototype.headerCheckbox=function(){if(this.columnIndex=this.getCheckboxcolumnIndex(),this.columnIndex>-1&&0===this.parent.getHeaderContent().querySelectorAll(".e-treeselectall").length){var e=this.parent.getHeaderContent().querySelectorAll(".e-headercelldiv")[this.columnIndex],r=this.parent.createElement("input",{className:"e-treeselectall",attrs:{type:"checkbox"}});(n=i.createCheckBox(this.parent.createElement,!1,{checked:!1,label:" "})).classList.add("e-hierarchycheckbox"),n.insertBefore(r.cloneNode(),n.firstChild),t.isNullOrUndefined(e)||e.insertBefore(n,e.firstChild),this.parent.autoCheckHierarchy&&this.headerSelection()}else if(this.columnIndex>-1&&this.parent.getHeaderContent().querySelectorAll(".e-treeselectall").length>0){var n=this.parent.getHeaderContent().querySelectorAll(".e-checkbox-wrapper")[0],o=n.querySelector(".e-frame").classList.contains("e-check");this.parent.autoCheckHierarchy&&o&&this.headerSelection(o)}},e.prototype.renderColumnCheckbox=function(e){var r=this.parent.createElement("input",{className:"e-treecheckselect",attrs:{type:"checkbox","aria-label":"checkbox"}}),n=e.data;e.cell.classList.add("e-treegridcheckbox"),e.cell.setAttribute("aria-label","checkbox");var o=!t.isNullOrUndefined(n.checkboxState)&&"uncheck"!==n.checkboxState,a=i.createCheckBox(this.parent.createElement,!1,{checked:o,label:" "});if(a.classList.add("e-hierarchycheckbox"),this.parent.allowTextWrap&&(a.querySelector(".e-frame").style.width="18px"),"indeterminate"===n.checkboxState){var s=a.querySelectorAll(".e-frame")[0];t.removeClass([s],["e-check","e-stop","e-uncheck"]),a.querySelector(".e-frame").classList.add("e-stop")}return a.insertBefore(r.cloneNode(),a.firstChild),a},e.prototype.columnCheckbox=function(e){var r=this.renderColumnCheckbox(e),i=e.cell.querySelector(".e-treecolumn-container");if(t.isNullOrUndefined(i)){var n=this.parent.createElement("span",{className:"e-treecheckbox"}),o=e.cell.innerHTML;e.cell.innerHTML="",n.innerHTML=o;var a=this.parent.createElement("div",{className:"e-treecheckbox-container"});a.appendChild(r),a.appendChild(n),e.cell.appendChild(a)}else e.cell.querySelector(".e-hierarchycheckbox")||i.insertBefore(r,i.querySelectorAll(".e-treecell")[0])},e.prototype.selectCheckboxes=function(e){for(var t=0;t<e.length;t++){var r=this.parent.getCurrentViewRecords()[e[parseInt(t.toString(),10)]],i=y(this.parent,r.uniqueID),n="uncheck"===(r=i).checkboxState?"check":"uncheck";r.checkboxState=n;for(var o=Object.keys(r),a=0;a<o.length;a++)Object.prototype.hasOwnProperty.call(i,o[parseInt(a.toString(),10)])&&(i[o[parseInt(a.toString(),10)]]=r[o[parseInt(a.toString(),10)]]);this.traverSelection(r,n,!1),this.parent.autoCheckHierarchy&&this.headerSelection()}},e.prototype.traverSelection=function(e,r,i){var n=0;if(this.updateSelectedItems(e,r),!i&&e.parentItem&&this.parent.autoCheckHierarchy&&this.updateParentSelection(e.parentItem),e.childRecords&&this.parent.autoCheckHierarchy){var o=e.childRecords;!t.isNullOrUndefined(this.parent.filterModule)&&this.parent.filterModule.filteredResult.length>0&&this.parent.autoCheckHierarchy&&(o=this.getFilteredChildRecords(o)),n=o.length;for(var a=0;a<n;a++)o[parseInt(a.toString(),10)].isSummaryRow||(o[parseInt(a.toString(),10)].hasChildRecords?this.traverSelection(o[parseInt(a.toString(),10)],r,!0):this.updateSelectedItems(o[parseInt(a.toString(),10)],r))}},e.prototype.getFilteredChildRecords=function(e){var t=this;return e.filter(function(e){return t.parent.filterModule.filteredResult.indexOf(e)>-1})},e.prototype.updateParentSelection=function(e){var r=0,i=[],n=y(this.parent,e.uniqueID);n&&n.childRecords&&(i=n.childRecords),!t.isNullOrUndefined(this.parent.filterModule)&&this.parent.filterModule.filteredResult.length>0&&this.parent.autoCheckHierarchy&&(i=this.getFilteredChildRecords(i)),r=i&&i.length;var o=0,a=0;if(!t.isNullOrUndefined(n)){for(var s=0;s<i.length;s++){var d=y(this.parent,i[parseInt(s.toString(),10)].uniqueID);t.isNullOrUndefined(d)||("indeterminate"===d.checkboxState?o++:"check"===d.checkboxState&&a++)}o>0||a>0&&a!==r?n.checkboxState="indeterminate":(0!==a||n.hasFilteredChildRecords&&!t.isNullOrUndefined(n.hasFilteredChildRecords)||t.isNullOrUndefined(this.parent.dataResults.actionArgs)||"searching"!==this.parent.dataResults.actionArgs.requestType&&"filtering"!==this.parent.dataResults.actionArgs.requestType||"check"!==n.checkboxState)&&(0===a&&0===o||0===a&&n.hasFilteredChildRecords&&!t.isNullOrUndefined(this.parent.dataResults.actionArgs)&&("searching"===this.parent.dataResults.actionArgs.requestType||"filtering"===this.parent.dataResults.actionArgs.requestType)&&"check"===n.checkboxState)?n.checkboxState="uncheck":n.checkboxState="check",this.updateSelectedItems(n,n.checkboxState),n.parentItem&&this.updateParentSelection(n.parentItem)}},e.prototype.headerSelection=function(e){var r=this,i=0,n=!1;if(!t.isNullOrUndefined(this.parent.filterModule)&&this.parent.filterModule.filteredResult.length>0){var o=this.parent.filterModule.filteredResult;0===this.filteredList.length&&(this.filteredList=o),this.parent.grid.searchSettings.key.length?this.searchingRecords=o:this.filteredList!==o?(this.filteredList=o,n=!0):n=!1}this.filteredList.length>0&&(this.parent.filterSettings.columns.length||!this.filteredList.length||this.parent.grid.searchSettings.key.length||(this.filteredList=[]),this.searchingRecords.length&&!t.isNullOrUndefined(e)&&(this.filteredList=this.searchingRecords));var s;if(s=!t.isNullOrUndefined(this.parent.filterModule)&&0===this.parent.filterModule.filteredResult.length&&0===this.parent.getCurrentViewRecords().length&&this.parent.filterSettings.columns.length>0?this.filteredList:!t.isNullOrUndefined(this.parent.filterModule)&&this.filteredList.length>0?this.filteredList:this.parent.flatData,s=a(this.parent)?this.parent.getCurrentViewRecords():s,!t.isNullOrUndefined(e))for(var d=0;d<s.length;d++)if(e){if("check"===s[parseInt(d.toString(),10)].checkboxState)continue;if(n)continue;s[parseInt(d.toString(),10)].checkboxState="check",this.updateSelectedItems(s[parseInt(d.toString(),10)],s[parseInt(d.toString(),10)].checkboxState)}else this.selectedItems.indexOf(s[parseInt(d.toString(),10)])>-1&&(s[parseInt(d.toString(),10)].checkboxState="uncheck",this.updateSelectedItems(s[parseInt(d.toString(),10)],s[parseInt(d.toString(),10)].checkboxState),this.parent.autoCheckHierarchy&&this.updateParentSelection(s[parseInt(d.toString(),10)]));!1===e&&this.parent.enableVirtualization&&(this.selectedItems=[],this.selectedIndexes=[],s.filter(function(e){e.checkboxState="uncheck",r.updateSelectedItems(e,e.checkboxState)})),i=this.selectedItems.length;var l=this.parent.getHeaderContent().querySelectorAll(".e-frame")[0];i>0&&s.length>0?i===s.length||e?(t.removeClass([l],["e-stop"]),l.classList.add("e-check")):(t.removeClass([l],["e-check"]),l.classList.add("e-stop")):t.removeClass([l],["e-check","e-stop"])},e.prototype.updateSelectedItems=function(e,r){var i,n,o=this.parent.getCurrentViewRecords().filter(function(t){return t.uniqueID===e.uniqueID}),a=this.parent.getCurrentViewRecords().indexOf(o[0]),s=y(this.parent,e.uniqueID),d=this.parent.getRows()[parseInt(a.toString(),10)];if(a>-1){var l=void 0;(this.parent.frozenRows||this.parent.getFrozenColumns())&&(l=this.parent.getMovableDataRows()[parseInt(a.toString(),10)]),n=d.querySelectorAll(".e-frame")[0]?d.querySelectorAll(".e-frame")[0]:l.querySelectorAll(".e-frame")[0],t.isNullOrUndefined(n)||t.removeClass([n],["e-check","e-stop","e-uncheck"])}if(i=s,t.isNullOrUndefined(i)&&(i=e),i.checkboxState=r,"check"===r&&t.isNullOrUndefined(e.isSummaryRow))-1!==a&&-1===this.selectedIndexes.indexOf(a)&&this.selectedIndexes.push(a),-1===this.selectedItems.indexOf(i)&&-1!==a&&!t.isNullOrUndefined(this.parent.filterModule)&&this.parent.filterModule.filteredResult.length>0&&this.selectedItems.push(i),-1===this.selectedItems.indexOf(i)&&this.parent.enableVirtualization&&!t.isNullOrUndefined(this.parent.filterModule)&&this.parent.filterModule.filteredResult.length>0&&this.selectedItems.push(i),-1!==this.selectedItems.indexOf(i)||t.isNullOrUndefined(this.parent.filterModule)||0!==this.parent.filterModule.filteredResult.length||this.selectedItems.push(i),-1===this.selectedItems.indexOf(i)&&t.isNullOrUndefined(this.parent.filterModule)&&this.selectedItems.push(i);else if(("uncheck"===r||"indeterminate"===r)&&t.isNullOrUndefined(e.isSummaryRow)){var p=this.selectedItems.indexOf(i);if(-1!==p&&this.selectedItems.splice(p,1),-1!==this.selectedIndexes.indexOf(a)){var h=this.selectedIndexes.indexOf(a);this.selectedIndexes.splice(h,1)}}var c="indeterminate"===r?"e-stop":"e-"+r;if(a>-1&&!t.isNullOrUndefined(n)){n.classList.add(c);var u="check"===r?"checked":"uncheck"===r?"unchecked":"mixed";d.querySelector(".e-treecheckselect").setAttribute("aria-checked","check"===r?"true":"uncheck"===r?"false":"mixed"),d.querySelector(".e-frame").setAttribute("title","checkbox"+u)}},e.prototype.updateGridActions=function(e){var r,i,n=this,o=e.requestType;if(d(this.parent)&&this.parent.autoCheckHierarchy)if("sorting"===o||"paging"===o){var s=this.parent.grid.getRows();i=(r=this.parent.getCurrentViewRecords()).length,this.selectedIndexes=[];for(p=0;p<i;p++)s[parseInt(p.toString(),10)].classList.contains("e-summaryrow")||this.updateSelectedItems(r[parseInt(p.toString(),10)],r[parseInt(p.toString(),10)].checkboxState)}else if("delete"===o||"add"===e.action){var l=[];"delete"===o?l=e.data:l.push(e.data);for(var p=0;p<l.length;p++){if("delete"===o){var h=this.parent.flatData.indexOf(l[parseInt(p.toString(),10)]),u=this.selectedIndexes.indexOf(h);this.selectedIndexes.splice(u,1),this.updateSelectedItems(l[parseInt(p.toString(),10)],"uncheck")}t.isNullOrUndefined(l[parseInt(p.toString(),10)].parentItem)||this.updateParentSelection(l[parseInt(p.toString(),10)].parentItem)}}else"add"===e.requestType&&this.parent.autoCheckHierarchy?e.data.checkboxState="uncheck":("filtering"===o||"searching"===o||"refresh"===o&&!a(this.parent))&&(this.selectedItems=[],this.selectedIndexes=[],(r=!t.isNullOrUndefined(this.parent.filterModule)&&this.parent.filterModule.filteredResult.length>0?this.parent.getCurrentViewRecords():this.parent.flatData).forEach(function(e){if(n.parent.enableVirtualization){e.hasChildRecords&&e.childRecords.length>0?n.updateParentSelection(e):n.updateSelectedItems(e,e.checkboxState);var r=c(e);r=n.getFilteredChildRecords(r);for(var i=0;i<r.length;i++)r[parseInt(i.toString(),10)].hasChildRecords?n.updateParentSelection(r[parseInt(i.toString(),10)]):r[parseInt(i.toString(),10)].hasChildRecords||t.isNullOrUndefined(r[parseInt(i.toString(),10)])||n.updateSelectedItems(r[parseInt(i.toString(),10)],r[parseInt(i.toString(),10)].checkboxState)}else e.hasChildRecords?n.updateParentSelection(e):n.updateSelectedItems(e,e.checkboxState)}),this.headerSelection())},e.prototype.getCheckedrecords=function(){return this.selectedItems},e.prototype.getCheckedRowIndexes=function(){return this.selectedIndexes},e}(),j=function(){function e(e){this.parent=e,r.Grid.Inject(r.Print),this.addEventListener()}return e.prototype.getModuleName=function(){return"print"},e.prototype.addEventListener=function(){this.parent.grid.on("printGrid-Init",this.printTreeGrid,this)},e.prototype.removeEventListener=function(){this.parent.grid.off("printGrid-Init",this.printTreeGrid)},e.prototype.printTreeGrid=function(e){var i=r.getObject("printgrid",e),n=r.getObject("element",e);i.addEventListener("queryCellInfo",this.parent.grid.queryCellInfo),i.addEventListener("rowDataBound",this.parent.grid.rowDataBound),i.addEventListener("beforeDataBound",this.parent.grid.beforeDataBound),t.addClass([n],"e-treegrid")},e.prototype.print=function(){this.parent.grid.print()},e.prototype.destroy=function(){this.removeEventListener()},e}(),_=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),H=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},G=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return _(r,e),H([t.Property()],r.prototype,"fields",void 0),H([t.Property(!1)],r.prototype,"ignoreCase",void 0),H([t.Property("contains")],r.prototype,"operator",void 0),H([t.Property()],r.prototype,"key",void 0),H([t.Property()],r.prototype,"hierarchyMode",void 0),r}(t.ChildProperty),Q=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),K=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},W=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Q(r,e),K([t.Property("Row")],r.prototype,"mode",void 0),K([t.Property("Flow")],r.prototype,"cellSelectionMode",void 0),K([t.Property("Single")],r.prototype,"type",void 0),K([t.Property(!1)],r.prototype,"persistSelection",void 0),K([t.Property("Default")],r.prototype,"checkboxMode",void 0),K([t.Property(!1)],r.prototype,"checkboxOnly",void 0),K([t.Property(!0)],r.prototype,"enableToggle",void 0),r}(t.ChildProperty),Y=function(){function e(e){this.parent=e,this.templateResult=null,this.parent.grid.on("template-result",this.columnTemplateResult,this),this.parent.grid.on("reactTemplateRender",this.reactTemplateRender,this)}return e.prototype.RowModifier=function(e){if(e.data){var i=e.data,n=i.parentItem;if(!t.isNullOrUndefined(i.parentItem)&&!l(this.parent)&&(!this.parent.allowPaging||"Root"===this.parent.pageSettings.pageSizeMode||a(this.parent)&&!u(this.parent))&&(this.parent.initialRender&&(!(t.isNullOrUndefined(n[this.parent.expandStateMapping])||n[this.parent.expandStateMapping])||this.parent.enableCollapseAll)||!h(this.parent,e.data,this.parent.grid.getCurrentViewRecords()))&&!t.isNullOrUndefined(e.row)){e.row.style.display="none";var o=this.parent.grid.getRowsObject();t.isNullOrUndefined(e.row.getAttribute("data-uid"))||(o.filter(function(t){return t.uid===e.row.getAttribute("data-uid")})[0].visible=!1)}if(a(this.parent)&&!u(this.parent)){var s=this.parent,d=this.parent.getCurrentViewRecords().filter(function(e){return t.getValue(s.idMapping,e)===t.getValue(s.parentIdMapping,i)});if(d.length>0&&!d[0].isSummaryRow&&!t.isNullOrUndefined(e.row)){var p=d[0].expanded?"table-row":"none";e.row.setAttribute("style","display: "+p+";")}}r.getObject("isSummaryRow",e.data)&&t.addClass([e.row],"e-summaryrow"),t.isNullOrUndefined(e.row)||(e.row.querySelector(".e-treegridexpand")?e.row.setAttribute("aria-expanded","true"):e.row.querySelector(".e-treegridcollapse")&&e.row.setAttribute("aria-expanded","false"),this.parent.enableCollapseAll&&this.parent.initialRender&&(t.isNullOrUndefined(i.parentItem)||(e.row.style.display="none")));if(this.parent.rowDragAndDropModule&&this.parent.grid.rowDragAndDropModule&&(this.parent.grid.rowDragAndDropModule.dragStartData||this.parent.rowDragAndDropModule.draggedRecord)&&this.parent.getContentTable().scrollHeight<=this.parent.getContent().clientHeight){this.parent.getVisibleRecords()[this.parent.getVisibleRecords().length-1].uniqueID!==e.data.uniqueID||t.isNullOrUndefined(e.row)||e.row.cells[0].classList.contains("e-lastrowcell")||this.parent.lastRowBorder(e.row,!0)}this.parent.trigger("rowDataBound",e)}},e.prototype.cellRender=function(e){if(e.data){var i,n,o=this.parent.grid,a=e.data,s=t.isNullOrUndefined(a.filterLevel)?a.level:a.filterLevel,d=0,l=this.parent.getColumnByUid(e.column.uid),p=a.isSummaryRow,c=this.parent.getFrozenColumns();i=t.isNullOrUndefined(a.parentItem)?a.index:a.parentItem.index;if((this.parent.enableColumnVirtualization&&!this.parent.initialRender?this.parent.getVirtualColIndexByUid(e.column.uid):o.getColumnIndexByUid(e.column.uid))!==this.parent.treeColumnIndex||"add"!==e.requestType&&"rowDragAndDrop"!==e.requestType&&"delete"!==e.requestType&&!t.isNullOrUndefined(e.cell.querySelector(".e-treecell")))this.templateResult&&(this.templateResult=null);else{for(var u=t.createElement("div",{className:"e-treecolumn-container"}),g=t.createElement("span",{className:"e-icons e-none",styles:"width: 10px; display: inline-block"}),f=0;f<s;f++)d+=10,u.appendChild(g.cloneNode());var y=t.isNullOrUndefined(a.hasFilteredChildRecords)?a.hasChildRecords:a.hasFilteredChildRecords;if(y&&!t.isNullOrUndefined(a.childRecords)&&(y=!(0===a.childRecords.length)),y){t.addClass([e.cell],"e-treerowcell"),e.cell.setAttribute("aria-expanded",a.expanded?"true":"false");var m=t.createElement("span",{className:"e-icons"}),v=void 0;v=this.parent.initialRender?a.expanded&&(t.isNullOrUndefined(a[this.parent.expandStateMapping])||a[this.parent.expandStateMapping])&&!this.parent.enableCollapseAll:!(!a.expanded||!h(this.parent,a,this.parent.grid.getCurrentViewRecords())),t.addClass([m],v?"e-treegridexpand":"e-treegridcollapse"),d+=18,u.appendChild(m),g.style.width="4px",d+=7,u.appendChild(g.cloneNode())}else(s||!s&&!a.level)&&(d+=20,u.appendChild(g.cloneNode()),u.appendChild(g.cloneNode()));n=t.createElement("span",{className:"e-treecell"}),this.parent.allowTextWrap&&(n.style.width="Calc(100% - "+d+"px)"),t.addClass([e.cell],"e-gridrowindex"+i+"level"+a.level),this.updateTreeCell(e,n),u.appendChild(n),e.cell.appendChild(u)}if(o.getFrozenLeftColumnsCount()>0||o.getFrozenRightColumnsCount()>0){var S=o.getFrozenRightColumns(),w=o.getFrozenLeftColumns(),I=o.getMovableColumns();S.length>0&&S[0].field===e.column.field?t.addClass([e.cell],"e-gridrowindex"+i+"level"+a.level):w.length>0&&w[0].field===e.column.field?t.addClass([e.cell],"e-gridrowindex"+i+"level"+a.level):I.length>0&&I[0].field===e.column.field&&t.addClass([e.cell],"e-gridrowindex"+i+"level"+a.level)}else c>this.parent.treeColumnIndex&&c>0&&o.getColumnIndexByUid(e.column.uid)===c?t.addClass([e.cell],"e-gridrowindex"+i+"level"+a.level):c<this.parent.treeColumnIndex&&c>0&&(o.getColumnIndexByUid(e.column.uid)===c||o.getColumnIndexByUid(e.column.uid)===c-1)?t.addClass([e.cell],"e-gridrowindex"+i+"level"+a.level):c===this.parent.treeColumnIndex&&c>0&&o.getColumnIndexByUid(e.column.uid)===this.parent.treeColumnIndex-1&&t.addClass([e.cell],"e-gridrowindex"+i+"level"+a.level);if(!t.isNullOrUndefined(l)&&l.showCheckbox&&(this.parent.notify("columnCheckbox",e),this.parent.allowTextWrap)){var R=e.cell.querySelectorAll(".e-frame")[0];d+=parseInt(R.style.width,16),d+=10,(n=o.getColumnIndexByUid(e.column.uid)===this.parent.treeColumnIndex?e.cell.querySelector(".e-treecell"):e.cell.querySelector(".e-treecheckbox")).style.width="Calc(100% - "+d+"px)"}if(p){t.addClass([e.cell],"e-summarycell");var C=r.getObject(e.column.field,e.data);null!=e.cell.querySelector(".e-treecell")?e.cell.querySelector(".e-treecell").innerHTML=C:e.column.template?e.cell.innerHTML=null:e.cell.innerHTML=C}t.isNullOrUndefined(this.parent.rowTemplate)&&this.parent.trigger("queryCellInfo",e)}},e.prototype.updateTreeCell=function(e,i){var n=t.getValue("columnModel",this.parent)[this.parent.treeColumnIndex],o=e.column.index;t.isNullOrUndefined(n.field)&&e.cell.setAttribute("data-colindex",o+""),n.field!==e.column.field||t.isNullOrUndefined(n.template)||(e.column.template=n.template,e.column.templateFn=r.templateCompiler(e.column.template),e.cell.classList.add("e-templatecell"));var a=null!=e.cell.querySelector(".e-treecell")?e.cell.querySelector(".e-treecell").innerHTML:e.cell.innerHTML;if("object"==typeof e.column.template&&this.templateResult)r.appendChildren(i,this.templateResult),this.templateResult=null,e.cell.innerHTML="";else if(e.cell.classList.contains("e-templatecell")){var s=e.cell.children.length,d=this.parent.element.id+e.column.uid;if(n.field!==e.column.field||t.isNullOrUndefined(n.template))for(;0<s;s=e.cell.children.length)i.appendChild(e.cell.children[parseInt((0).toString(),10)]);else{if(this.parent.isReact&&"string"!=typeof e.column.template)e.column.templateFn(e.data,this.parent,"columnTemplate",d,null,null,i),t.isNullOrUndefined(this.parent.grid.portals)&&(this.parent.grid.portals=this.parent.portals),this.parent.notify("renderReactTemplate",this.parent.portals),this.parent.renderReactTemplates();else{var l=e.column.templateFn(r.extend({index:""},e.data),this.parent,"template",d,this.parent.isStringTemplate);r.appendChildren(i,l)}delete e.column.template,delete e.column.templateFn,e.cell.innerHTML=""}}else i.innerHTML=a,e.cell.innerHTML=""},e.prototype.refreshReactColumnTemplateByUid=function(e){var i=this;this.parent.isReact&&this.parent.clearTemplate(["columnTemplate"],void 0,function(){for(var n=i.parent.grid.getRowsObject(),o=i.parent.grid.getIndentCount(),a=i.parent.grid.getNormalizedColumnIndex(e),s=0;s<n.length;s++)if(n[parseInt(s.toString(),10)].isDataRow&&!t.isNullOrUndefined(n[parseInt(s.toString(),10)].index)){var d=n[parseInt(s.toString(),10)].cells[parseInt(a.toString(),10)],l=new r.CellRenderer(i.parent.grid,i.parent.grid.serviceLocator),p=i.parent.getCellFromIndex(n[parseInt(s.toString(),10)].index,a-o);l.refreshTD(p,d,n[parseInt(s.toString(),10)].data,{index:n[parseInt(s.toString(),10)].index});var h=i.parent.getRows()[parseInt(s.toString(),10)].cells[parseInt(a.toString(),10)];i.cellRender({data:n[parseInt(s.toString(),10)].data,cell:h,column:d.column})}})},e.prototype.columnTemplateResult=function(e){this.templateResult=e.template},e.prototype.reactTemplateRender=function(e){this.parent.portals=e,this.parent.notify("renderReactTemplate",this.parent.portals),this.parent.renderReactTemplates()},e.prototype.destroy=function(){this.parent.grid.off("template-result",this.columnTemplateResult),this.parent.grid.off("reactTemplateRender",this.reactTemplateRender)},e}(),J=function(){function e(e){this.addedRecords="addedRecords",this.parent=e,this.parentItems=[],this.taskIds=[],this.hierarchyData=[],this.storedIndex=-1,this.sortedData=[],this.isSortAction=!1,this.addEventListener(),this.dataResults={},this.isSelfReference=!t.isNullOrUndefined(this.parent.parentIdMapping)}return e.prototype.addEventListener=function(){this.parent.on("updateRemoteLevel",this.updateParentRemoteData,this),this.parent.grid.on("sorting-begin",this.beginSorting,this),this.parent.on("updateAction",this.updateData,this),this.parent.on("remoteExpand",this.collectExpandingRecs,this),this.parent.on("dataProcessor",this.dataProcessor,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("remoteExpand",this.collectExpandingRecs),this.parent.off("updateRemoteLevel",this.updateParentRemoteData),this.parent.off("updateAction",this.updateData),this.parent.off("dataProcessor",this.dataProcessor),this.parent.grid.off("sorting-begin",this.beginSorting))},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.isRemote=function(){return this.parent.dataSource instanceof n.DataManager},e.prototype.convertToFlatData=function(e){var i=this;if(this.parent.flatData=0!==Object.keys(e).length||this.parent.dataSource instanceof n.DataManager?[]:this.parent.dataSource,this.parent.parentData=[],a(this.parent)&&!u(this.parent)&&e instanceof n.DataManager&&!(e instanceof Array)){var o=this.parent.dataSource;if(this.parent.parentIdMapping){if(this.parent.query=t.isNullOrUndefined(this.parent.query)?new n.Query:this.parent.query,this.parent.parentIdMapping){var s=this.parent.query.params.filter(function(e){return"IdMapping"===e.key});this.parent.initialRender&&!s.length&&(this.parent.query.where(this.parent.parentIdMapping,"equal",null),this.parent.query.addParams("IdMapping",this.parent.idMapping))}if(!this.parent.hasChildMapping){var d=this.parent.query.clone();d.queries=[],(d=d.select([this.parent.parentIdMapping])).isCountRequired=!0,o.executeQuery(d).then(function(e){i.parentItems=n.DataUtil.distinct(e.result,i.parent.parentIdMapping,!1),0===r.getObject("dataSource.requests",i.parent).filter(function(e){return"OK"!==e.httpRequest.statusText}).length&&(t.setValue("grid.contentModule.isLoaded",!0,i.parent),t.isNullOrUndefined(i.zerothLevelData)||(t.setValue("cancel",!1,i.zerothLevelData),t.getValue("grid.renderModule",i.parent).dataManagerSuccess(i.zerothLevelData),i.zerothLevelData=null),i.parent.grid.hideSpinner())})}}}else e instanceof Array&&this.convertJSONData(e)},e.prototype.convertJSONData=function(e){if(this.hierarchyData=[],this.taskIds=[],this.parent.idMapping)for(var r=Object.keys(e),i=0;i<r.length;i++){var o=e[parseInt(i.toString(),10)];this.hierarchyData.push(t.extend({},o)),t.isNullOrUndefined(o[this.parent.idMapping])||this.taskIds.push(o[this.parent.idMapping])}else this.hierarchyData=e;if(this.isSelfReference){for(var a=[],s=new n.DataManager(this.hierarchyData).executeLocal((new n.Query).group(this.parent.parentIdMapping)),i=0;i<s.length;i++){var d=s[parseInt(i.toString(),10)],l=this.taskIds.indexOf(d.key);if(!t.isNullOrUndefined(d.key)&&l>-1){var p=d.items;this.hierarchyData[parseInt(l.toString(),10)][this.parent.childMapping]=p}else a.push.apply(a,d.items)}this.hierarchyData=this.selfReferenceUpdate(a)}if(Object.keys(this.hierarchyData).length)this.createRecords(this.hierarchyData);else{var h=!(this.parent.dataSource instanceof n.DataManager)&&this.parent.isGantt;this.parent.flatData=h?this.parent.dataSource:[]}this.storedIndex=-1},e.prototype.selfReferenceUpdate=function(e){for(var t=[];this.hierarchyData.length>0&&e.length>0;){var r=e.indexOf(this.hierarchyData[0]);-1===r?this.hierarchyData.shift():(t.push(this.hierarchyData.shift()),e.splice(r,1))}return t},e.prototype.updateParentRemoteData=function(e){a(this.parent)&&this.parent.enableVirtualization&&"virtualscroll"===e.actionArgs.requestType&&this.parent.hideSpinner();var i=e.result;if(a(this.parent)&&this.parent.enableVirtualization&&("virtualscroll"===e.actionArgs.requestType||"clearFilter"===e.actionArgs.action||""===e.actionArgs.searchString)&&(this.parent.query.expands=[]),this.parent.hasChildMapping||this.parentItems.length||this.parent.loadChildOnDemand)if(this.parent.loadChildOnDemand){t.isNullOrUndefined(i)||this.parent.loadChildOnDemand&&s(this.parent)&&!t.isNullOrUndefined(this.parent.dataResults.expandRecord)||a(this.parent)&&this.parent.loadChildOnDemand&&e.actionArgs.isExpandCollapse&&this.parent.enableVirtualization||this.convertToFlatData(i)}else for(var n=this,o=0;o<i.length;o++)!function(e){if(s(n.parent)&&i[parseInt(e.toString(),10)].hasChildRecords&&n.parent.initialRender&&(i[parseInt(e.toString(),10)].expanded=!1),a(n.parent)&&n.parent.enableVirtualization){var o=[],d=n.parent;i.filter(function(t){t[""+d.parentIdMapping]===i[parseInt(e.toString(),10)][""+d.idMapping]&&o.push(t)}),o.length?i[parseInt(e.toString(),10)].expanded=!0:i[parseInt(e.toString(),10)].hasChildRecords&&(i[parseInt(e.toString(),10)].expanded=!1)}t.isNullOrUndefined(i[parseInt(e.toString(),10)].index)&&(i[parseInt(e.toString(),10)].taskData=t.extend({},i[parseInt(e.toString(),10)]),i[parseInt(e.toString(),10)].uniqueID=r.getUid(n.parent.element.id+"_data_"),t.setValue("uniqueIDCollection."+i[parseInt(e.toString(),10)].uniqueID,i[parseInt(e.toString(),10)],n.parent),i[parseInt(e.toString(),10)].level=0,a(n.parent)&&n.parent.enableVirtualization&&i[parseInt(e.toString(),10)][""+n.parent.parentIdMapping]&&0===i[parseInt(e.toString(),10)].level&&(i[parseInt(e.toString(),10)].level=i[parseInt(e.toString(),10)].level+1),i[parseInt(e.toString(),10)].index=Math.ceil(1e3*Math.random()),(i[parseInt(e.toString(),10)][n.parent.hasChildMapping]||-1!==n.parentItems.indexOf(i[parseInt(e.toString(),10)][n.parent.idMapping]))&&(i[parseInt(e.toString(),10)].hasChildRecords=!0),i[parseInt(e.toString(),10)].checkboxState="uncheck")}(o);else this.zerothLevelData=e,t.setValue("cancel",!0,e);if(a(this.parent)&&this.parent.loadChildOnDemand&&e.actionArgs.isExpandCollapse&&this.parent.enableVirtualization?e.result=i:a(this.parent)&&this.parent.enableVirtualization&&!this.parent.loadChildOnDemand?e.result=i:e.result=this.parent.loadChildOnDemand?this.parent.flatData:i,a(this.parent)&&this.parent.enableVirtualization&&this.parent.loadChildOnDemand&&this.parent.grid.aggregates.length&&0===this.parent.grid.sortSettings.columns.length&&0===this.parent.grid.filterSettings.columns.length&&!this.parent.grid.searchSettings.key.length){var d=e.query.queries.filter(function(e){return"onAggregates"===e.fn});e.result=this.parent.summaryModule.calculateSummaryValue(d,this.parent.flatData,!0)}this.parent.notify("updateResults",e)},e.prototype.collectExpandingRecs=function(e,r){var i=this.parent.getRows();if(this.parent.rowTemplate){var n=this.parent.getContentTable().rows;i=[].slice.call(n)}var o;if(e.rows.length>0){r||(e.record.expanded=!0);for(var a=0;a<e.rows.length;a++){if(e.rows[parseInt(a.toString(),10)].style.display="table-row",this.parent.loadChildOnDemand){var s=e.rows[parseInt(a.toString(),10)].getElementsByClassName("e-treegridcollapse")[0];o=this.parent.rowTemplate?this.parent.grid.getCurrentViewRecords()[e.rows[parseInt(a.toString(),10)].rowIndex]:this.parent.grid.getRowObjectFromUID(e.rows[parseInt(a.toString(),10)].getAttribute("data-Uid")).data,!t.isNullOrUndefined(s)&&o.expanded&&(t.addClass([s],"e-treegridexpand"),t.removeClass([s],"e-treegridcollapse"));var d=[];(d=i.filter(function(e){return e.querySelector(".e-gridrowindex"+o.index+"level"+(o.level+1))})).length&&o.expanded&&this.collectExpandingRecs({record:o,rows:d,parentRow:e.parentRow},!0)}var l=e.rows[parseInt(a.toString(),10)].querySelector(".e-detailrowcollapse");t.isNullOrUndefined(l)||this.parent.grid.detailRowModule.expand(l)}}else this.fetchRemoteChildData({action:e.name,record:e.record,rows:e.rows,parentRow:e.parentRow})},e.prototype.fetchRemoteChildData=function(e){var i=this,a={row:e.parentRow,data:e.record},s=this.parent.dataSource,d=this.parent.grid.getDataModule().generateQuery(),l=d.queries.filter(function(e){return"onPage"!==e.fn&&"onWhere"!==e.fn});if(d.queries=l,d.isCountRequired=!0,this.parent.enableVirtualization&&"remoteExpand"===e.action)d.take(this.parent.pageSettings.pageSize),(p=[]).push("ExpandingAction",parseInt(e.record[this.parent.idMapping],10).toString()),d.expand(p);else if(this.parent.enableVirtualization&&"collapse"===e.action){d.take(this.parent.grid.pageSettings.pageSize);var p=[];p.push("CollapsingAction",parseInt(e.record[this.parent.idMapping],10).toString()),d.expand(p)}d.where(this.parent.parentIdMapping,"equal",e.record[this.parent.idMapping]),o.showSpinner(this.parent.element),s.executeQuery(d).then(function(s){var d=i.parent.grid.currentViewData.slice(),l=d.indexOf(e.record);if(i.parent.enableVirtualization&&("collapse"===e.action||"remoteExpand"===e.action)){d=[];for(f=0;f<l;f++)d.push(i.parent.grid.currentViewData[parseInt(f.toString(),10)])}-1===l&&i.parent.grid.getRowsObject().forEach(function(t){t.data.uniqueID===e.record.uniqueID&&(l=t.index)});var p=r.getObject("actual.nextLevel",s),h=s.result;e.record.childRecords=h;for(var c=0;c<h.length;c++){if(i.parent.enableVirtualization&&h[parseInt(c.toString(),10)][""+i.parent.idMapping]===e.record[""+i.parent.idMapping]&&"remoteExpand"===e.action)i.parent.remoteExpandedData.push(e.record);else if(i.parent.enableVirtualization&&h[parseInt(c.toString(),10)][""+i.parent.idMapping]===e.record[""+i.parent.idMapping]&&"collapse"===e.action)for(f=0;f<i.parent.remoteExpandedData.length;f++)e.record[""+i.parent.idMapping]===i.parent.remoteExpandedData[parseInt(f.toString(),10)][""+i.parent.idMapping]&&i.parent.remoteExpandedData.splice(f,1);if(h[parseInt(c.toString(),10)].taskData=t.extend({},h[parseInt(c.toString(),10)]),h[parseInt(c.toString(),10)][""+i.parent.parentIdMapping]&&i.parent.enableVirtualization&&i.parent.remoteExpandedData.length){for(f=0;f<i.parent.remoteExpandedData.length;f++)if(h[parseInt(c.toString(),10)][""+i.parent.parentIdMapping]===i.parent.remoteExpandedData[parseInt(f.toString(),10)][""+i.parent.idMapping]){h[parseInt(c.toString(),10)].level=i.parent.remoteExpandedData[parseInt(f.toString(),10)].level+1;var u=i.parent.remoteExpandedData[parseInt(f.toString(),10)];h[parseInt(c.toString(),10)].parentItem=u,h[parseInt(c.toString(),10)].parentUniqueID=e.record.uniqueID}}else i.parent.enableVirtualization?!h[parseInt(c.toString(),10)][""+i.parent.hasChildMapping]&&-1===i.parentItems.indexOf(h[parseInt(c.toString(),10)][""+i.parent.idMapping])||p&&!p[parseInt(c.toString(),10)]?(delete(u=t.extend({},e.record)).childRecords,h[parseInt(c.toString(),10)].parentItem=u,h[parseInt(c.toString(),10)].parentUniqueID=e.record.uniqueID):t.isNullOrUndefined(h[parseInt(c.toString(),10)][""+i.parent.parentIdMapping])?h[parseInt(c.toString(),10)].level=0:h[parseInt(c.toString(),10)].level=e.record.level:(h[parseInt(c.toString(),10)].level=e.record.level+1,delete(u=t.extend({},e.record)).childRecords,h[parseInt(c.toString(),10)].parentItem=u,h[parseInt(c.toString(),10)].parentUniqueID=e.record.uniqueID);if(h[parseInt(c.toString(),10)].index=Math.ceil(1e3*Math.random()),h[parseInt(c.toString(),10)].uniqueID=r.getUid(i.parent.element.id+"_data_"),h[parseInt(c.toString(),10)].checkboxState="uncheck",i.parent.enableVirtualization&&t.isNullOrUndefined(h[parseInt(c.toString(),10)].level))for(var g=0;g<i.parent.grid.currentViewData.length;g++)i.parent.grid.currentViewData[parseInt(g.toString(),10)][""+i.parent.idMapping]===h[parseInt(c.toString(),10)][""+i.parent.parentIdMapping]&&(h[parseInt(c.toString(),10)].level=i.parent.grid.currentViewData[parseInt(g.toString(),10)].level+1);if(t.setValue("uniqueIDCollection."+h[parseInt(c.toString(),10)].uniqueID,h[parseInt(c.toString(),10)],i.parent),(h[parseInt(c.toString(),10)][""+i.parent.hasChildMapping]||-1!==i.parentItems.indexOf(h[parseInt(c.toString(),10)][""+i.parent.idMapping]))&&(!p||p[parseInt(c.toString(),10)]))if(h[parseInt(c.toString(),10)].hasChildRecords=!0,i.parent.enableVirtualization&&i.parent.loadChildOnDemand){for(f=0;f<i.parent.remoteCollapsedData.length;f++)h[parseInt(c.toString(),10)][""+i.parent.idMapping]===i.parent.remoteCollapsedData[parseInt(f.toString(),10)][""+i.parent.idMapping]&&(h[parseInt(c.toString(),10)].expanded=i.parent.remoteCollapsedData[parseInt(f.toString(),10)].expanded);if("collapse"===e.action&&h[parseInt(c.toString(),10)][""+i.parent.idMapping]!==e.record[""+i.parent.idMapping]&&!1!==h[parseInt(c.toString(),10)].expanded)h[parseInt(c.toString(),10)].expanded=!0;else if("collapse"===e.action&&h[parseInt(c.toString(),10)][""+i.parent.idMapping]===e.record[""+i.parent.idMapping])h[parseInt(c.toString(),10)].expanded=!1,i.parent.remoteCollapsedData.push(e.record);else if("remoteExpand"===e.action){for(f=0;f<i.parent.grid.currentViewData.length;f++)i.parent.grid.currentViewData[parseInt(f.toString(),10)][""+i.parent.idMapping]===h[parseInt(c.toString(),10)][""+i.parent.idMapping]&&h.splice(c,1,i.parent.grid.currentViewData[parseInt(f.toString(),10)]);if(h[parseInt(c.toString(),10)][i.parent.idMapping]===e.record[""+i.parent.idMapping])for(var f=0;f<i.parent.remoteCollapsedData.length;f++)e.record[""+i.parent.idMapping]===i.parent.remoteCollapsedData[parseInt(f.toString(),10)][""+i.parent.idMapping]&&i.parent.remoteCollapsedData.splice(f,1);!1!==h[parseInt(c.toString(),10)].expanded&&(h[parseInt(c.toString(),10)].expanded=!0)}}else i.parent.enableVirtualization&&h[parseInt(c.toString(),10)][""+i.parent.idMapping]===e.record[""+i.parent.idMapping]&&"collapse"!==e.action?h[parseInt(c.toString(),10)].expanded=!0:i.parent.enableVirtualization&&i.parent.loadChildOnDemand||(h[parseInt(c.toString(),10)].expanded=!1);d.splice(l+c+1,0,h[parseInt(c.toString(),10)])}if(t.setValue("result",d,s),t.setValue("action","beforecontentrender",s),i.parent.trigger("actionComplete",s),o.hideSpinner(i.parent.element),i.parent.grid.aggregates.length>0&&!i.parent.enableVirtualization){var y=r.getObject("query",s);if(t.isNullOrUndefined(y)&&(y=t.getValue("grid.renderModule.data",i.parent).aggregateQuery(new n.Query)),!t.isNullOrUndefined(y)){var m=y.queries.filter(function(e){return"onAggregates"===e.fn});s.result=i.parent.summaryModule.calculateSummaryValue(m,s.result,!0)}}i.parent.enableVirtualization&&(i.parent.grid.pageSettings.totalRecordsCount=s.count),s.count=i.parent.grid.pageSettings.totalRecordsCount;var v={};i.parent.enableVirtualization&&i.remoteVirtualAction(v);var S={index:l,childData:h};i.parent.enableInfiniteScrolling?i.parent.notify("infinite-remote-expand",S):t.getValue("grid.renderModule",i.parent).dataManagerSuccess(s,v),i.parent.trigger("expanded",a)})},e.prototype.remoteVirtualAction=function(e){e.requestType="refresh",t.setValue("isExpandCollapse",!0,e);var r=t.getValue("grid.contentModule",this.parent),i=t.getValue("currentInfo",r),n=t.getValue("prevInfo",r);i.loadNext&&this.parent.grid.pageSettings.currentPage===i.nextInfo.page&&(this.parent.grid.pageSettings.currentPage=n.page)},e.prototype.beginSorting=function(){if(this.isSortAction=!0,a(this.parent)&&this.parent.enableVirtualization){var e=this.parent.query.queries.indexOf(this.parent.query.queries.filter(function(e){return"onSortBy"===e.fn})[0]);-1!==e&&this.parent.query.queries.splice(e,1),0===this.parent.grid.sortSettings.columns.length&&this.parent.query.sortBy(null,null)}},e.prototype.createRecords=function(e,i){for(var n=[],o=0,d=Object.keys(e).length;o<d;o++){var l=t.extend({},e[parseInt(o.toString(),10)]);l.taskData=e[parseInt(o.toString(),10)];var p=0;if(this.storedIndex++,Object.prototype.hasOwnProperty.call(l,"index")||(l.index=this.storedIndex),(!t.isNullOrUndefined(l[this.parent.childMapping])&&!s(this.parent)||l[this.parent.hasChildMapping]&&s(this.parent))&&(l.hasChildRecords=!0,this.parent.enableCollapseAll||!t.isNullOrUndefined(this.parent.dataStateChange)&&t.isNullOrUndefined(l[this.parent.childMapping])?l.expanded=!1:l.expanded=!!t.isNullOrUndefined(l[this.parent.expandStateMapping])||l[this.parent.expandStateMapping]),Object.prototype.hasOwnProperty.call(l,"index")||(l.index=(l.hasChildRecords,this.storedIndex)),this.isSelfReference&&t.isNullOrUndefined(l[this.parent.parentIdMapping])&&this.parent.parentData.push(l),l.uniqueID=r.getUid(this.parent.element.id+"_data_"),t.setValue("uniqueIDCollection."+l.uniqueID,l,this.parent),!t.isNullOrUndefined(i)){var h=t.extend({},i);delete h.childRecords,delete h[this.parent.childMapping],this.isSelfReference&&delete h.taskData[this.parent.childMapping],l.parentItem=h,l.parentUniqueID=h.uniqueID,p=i.level+1}Object.prototype.hasOwnProperty.call(l,"level")||(l.level=p),l.checkboxState="uncheck";if(this.parent.enableVirtualization&&this.parent.loadChildOnDemand&&a(this.parent)&&!this.parent.initialRender){if(!l.hasChildRecords&&t.isNullOrUndefined(l[""+this.parent.parentIdMapping])){l.hasChildRecords=!0;for(var c=0;c<this.parent.remoteCollapsedData.length;c++)this.parent.remoteCollapsedData[parseInt(c.toString(),10)][""+this.parent.idMapping]===l[""+this.parent.idMapping]&&(l.expanded=!1)}else 0===l.level&&t.isNullOrUndefined(i)&&!l.hasChildRecords&&(l.level=l.level+1);l[""+this.parent.hasChildMapping]&&!t.isNullOrUndefined(l[""+this.parent.expandStateMapping])&&(l.expanded=l[""+this.parent.expandStateMapping],l.hasChildRecords=!0),this.parent.flatData.push(l)}else(t.isNullOrUndefined(l[""+this.parent.parentIdMapping])||l.parentItem)&&(this.parent.flatData.push(l),this.parent.infiniteScrollData.push(l));if(this.isSelfReference||0!==l.level||this.parent.parentData.push(l),!t.isNullOrUndefined(l[this.parent.childMapping]&&l[this.parent.childMapping].length)){var u=this.createRecords(l[this.parent.childMapping],l);l.childRecords=u}n.push(l)}return n},e.prototype.dataProcessor=function(e){var i,o=r.getObject("isExport",e),a=r.getObject("expresults",e),d=r.getObject("exportType",e),l=r.getObject("isPrinting",e),p=r.getObject("actionArgs",e),h=r.getObject("requestType",e),c=r.getObject("data",e),g=r.getObject("action",e),f=p,y=this.parent.getPrimaryKeyFieldNames()[0],m=r.getObject("data",f);t.isNullOrUndefined(f)||t.isNullOrUndefined(f.action)||"add"!==f.action||t.isNullOrUndefined(f.data)||!t.isNullOrUndefined(f.data[""+y])||(f.data[""+y]=e.result[f.index][""+y],m.taskData[""+y]=e.result[f.index][""+y]),(!t.isNullOrUndefined(p)&&Object.keys(p).length||"save"===h)&&(h=h||p.requestType,c=c||r.getObject("data",p),g=g||r.getObject("action",p),"Batch"===this.parent.editSettings.mode&&(this.batchChanges=this.parent.grid.editModule.getBatchChanges()),this.parent.isLocalData&&this.updateAction(c,g,h));var v,S,w=(i=o&&!t.isNullOrUndefined(a)?a:s(this.parent)?t.getValue("result",this.parent.grid.dataSource):this.parent.grid.dataSource)instanceof n.DataManager?i.dataSource.json:i,I=s(this.parent)?t.getValue("count",this.parent.dataSource):w.length,R=new n.Query,C=r.getObject("query",e);if(t.isNullOrUndefined(C)||(v=C.queries.filter(function(e){return"onWhere"===e.fn}),S=C.queries.filter(function(e){return"onSearch"===e.fn})),this.parent.grid.allowFiltering&&this.parent.grid.filterSettings.columns.length||this.parent.grid.searchSettings.key.length>0||!t.isNullOrUndefined(C)&&(v.length||S.length)&&this.parent.isLocalData){t.isNullOrUndefined(C)&&(C=new n.Query,C=t.getValue("grid.renderModule.data",this.parent).filterQuery(C),C=t.getValue("grid.renderModule.data",this.parent).searchQuery(C));var x=C.queries.filter(function(e){return"onWhere"===e.fn}),b=C.queries.filter(function(e){return"onSearch"===e.fn});R.queries=x.concat(b);var D=new n.DataManager(w).executeLocal(R);if(this.parent.notify("updateFilterRecs",{data:D}),w=this.dataResults.result,this.dataResults.result=null,this.parent.grid.aggregates.length>0){P=r.getObject("query",e);if(t.isNullOrUndefined(C)&&(C=t.getValue("grid.renderModule.data",this.parent).aggregateQuery(new n.Query)),!t.isNullOrUndefined(P)){T=P.queries.filter(function(e){return"onAggregates"===e.fn});w=this.parent.summaryModule.calculateSummaryValue(T,w,!0)}}}if(this.parent.grid.aggregates.length&&0===this.parent.grid.sortSettings.columns.length&&0===this.parent.grid.filterSettings.columns.length&&!this.parent.grid.searchSettings.key.length){var M=r.getObject("query",e);t.isNullOrUndefined(M)&&(M=t.getValue("grid.renderModule.data",this.parent).aggregateQuery(new n.Query));T=M.queries.filter(function(e){return"onAggregates"===e.fn});w=this.parent.summaryModule.calculateSummaryValue(T,this.parent.flatData,!0)}if(this.parent.grid.sortSettings.columns.length>0||this.isSortAction){this.isSortAction=!1;for(var O=this.parent.parentData,P=r.getObject("query",e),E=new n.Query,A=this.parent.grid.sortSettings.columns.length-1;A>=0;A--){var N=this.parent.grid.renderModule.data.getColumnByField(this.parent.grid.sortSettings.columns[parseInt(A.toString(),10)].field),k=N.sortComparer&&u(this.parent)?N.sortComparer.bind(N):this.parent.grid.sortSettings.columns[parseInt(A.toString(),10)].direction;E.sortBy(this.parent.grid.sortSettings.columns[parseInt(A.toString(),10)].field,k)}var q=new n.DataManager(O).executeLocal(E);if(this.parent.allowRowDragAndDrop&&!t.isNullOrUndefined(this.parent.rowDragAndDropModule.draggedRecord)&&this.parent.rowDragAndDropModule.droppedRecord.hasChildRecords&&"middleSegment"!==this.parent.rowDragAndDropModule.dropPosition){var U=q.indexOf(this.parent.rowDragAndDropModule.draggedRecord);q.splice(U,1);var V=q.indexOf(this.parent.rowDragAndDropModule.droppedRecord);this.parent.rowDragAndDropModule.droppedRecord.hasChildRecords&&"topSegment"===this.parent.rowDragAndDropModule.dropPosition?q.splice(V,0,this.parent.rowDragAndDropModule.draggedRecord):"bottomSegment"===this.parent.rowDragAndDropModule.dropPosition&&q.splice(V+1,0,this.parent.rowDragAndDropModule.draggedRecord)}var B={modifiedData:q,filteredData:w,srtQry:E};if(this.parent.notify("createSort",B),w=B.modifiedData,this.dataResults.result=null,this.sortedData=w,this.parent.notify("updateModel",{}),this.parent.grid.aggregates.length>0&&!t.isNullOrUndefined(P)){var T=r.getObject("query",e).queries.filter(function(e){return"onAggregates"===e.fn});w=this.parent.summaryModule.calculateSummaryValue(T,this.sortedData,!1)}}I=s(this.parent)?t.getValue("count",this.parent.dataSource):w.length;var z=this.paging(w,I,o,l,d,e);w=z.result,I=z.count,e.result=w,e.count=I,this.parent.notify("updateResults",e)},e.prototype.paging=function(e,r,i,n,o,a){if(!this.parent.allowPaging||i&&"CurrentPage"!==o||n&&"CurrentPage"!==this.parent.printMode){if((this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)&&(!i||"CurrentPage"===o)&&"save"!==t.getValue("requestType",a)){var d=this.parent.enableInfiniteScrolling?a:t.getValue("actionArgs",a);this.parent.notify("pagingActions",{result:e,count:r,actionArgs:d}),e=this.dataResults.result,r=this.dataResults.count}}else this.parent.notify("pagingActions",{result:e,count:r}),e=this.dataResults.result,r=s(this.parent)?t.getValue("count",this.parent.dataSource):this.dataResults.count;if((!0===n||a.isPdfExport&&(t.isNullOrUndefined(a.isCollapsedStatePersist)||a.isCollapsedStatePersist))&&"AllPages"===this.parent.printMode){for(var l=[],p=0;p<e.length;p++)h(this.parent,e[parseInt(p.toString(),10)],this.parent.parentData)&&l.push(e[parseInt(p.toString(),10)]);r=(e=l).length}return{result:e,count:r}},e.prototype.updateData=function(e){this.dataResults=e},e.prototype.updateAction=function(e,t,r){"delete"!==r&&"save"!==r||this.parent.notify("crudAction",{value:e,action:t||r}),"batchsave"===r&&"Batch"===this.parent.editSettings.mode&&this.parent.notify("batchSave",{})},e}();!function(e){e[e.Add=0]="Add",e[e.Edit=1]="Edit",e[e.Update=2]="Update",e[e.Delete=3]="Delete",e[e.Cancel=4]="Cancel",e[e.Search=5]="Search",e[e.ExpandAll=6]="ExpandAll",e[e.CollapseAll=7]="CollapseAll",e[e.ExcelExport=8]="ExcelExport",e[e.PdfExport=9]="PdfExport",e[e.CsvExport=10]="CsvExport",e[e.Print=11]="Print",e[e.RowIndent=12]="RowIndent",e[e.RowOutdent=13]="RowOutdent"}(e.ToolbarItem||(e.ToolbarItem={})),function(e){e[e.AutoFit=0]="AutoFit",e[e.AutoFitAll=1]="AutoFitAll",e[e.SortAscending=2]="SortAscending",e[e.SortDescending=3]="SortDescending",e[e.Edit=4]="Edit",e[e.Delete=5]="Delete",e[e.Save=6]="Save",e[e.Cancel=7]="Cancel",e[e.PdfExport=8]="PdfExport",e[e.ExcelExport=9]="ExcelExport",e[e.CsvExport=10]="CsvExport",e[e.FirstPage=11]="FirstPage",e[e.PrevPage=12]="PrevPage",e[e.LastPage=13]="LastPage",e[e.NextPage=14]="NextPage",e[e.AddRow=15]="AddRow",e[e.RowIndent=16]="RowIndent",e[e.RowOutdent=17]="RowOutdent"}(e.ContextMenuItems||(e.ContextMenuItems={}));var X=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),$=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Z=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return X(r,e),$([t.Property(12)],r.prototype,"pageSize",void 0),$([t.Property(8)],r.prototype,"pageCount",void 0),$([t.Property(1)],r.prototype,"currentPage",void 0),$([t.Property()],r.prototype,"totalRecordsCount",void 0),$([t.Property(!1)],r.prototype,"enableQueryString",void 0),$([t.Property(!1)],r.prototype,"pageSizes",void 0),$([t.Property(null)],r.prototype,"template",void 0),$([t.Property("All")],r.prototype,"pageSizeMode",void 0),r}(t.ChildProperty),ee=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),te=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},re=function(e){function i(){var r=null!==e&&e.apply(this,arguments)||this;return r.intl=new t.Internationalization,r.templateFn={},r}return ee(i,e),i.prototype.setFormatter=function(e){this.format&&(this.format.skeleton||this.format.format)&&(this.formatFn=this.getFormatFunction(this.format))},i.prototype.getFormatFunction=function(e){return e.type?this.intl.getDateFormat(e):this.intl.getNumberFormat(e)},i.prototype.getFormatter=function(){return this.formatFn},i.prototype.setTemplate=function(e){void 0===e&&(e={}),void 0!==this.footerTemplate&&(this.templateFn[t.getEnumValue(r.CellType,r.CellType.Summary)]={fn:t.compile(this.footerTemplate,e),property:"footerTemplate"})},i.prototype.getTemplate=function(e){return this.templateFn[t.getEnumValue(r.CellType,e)]},i.prototype.setPropertiesSilent=function(e){this.setProperties(e,!0)},te([t.Property()],i.prototype,"type",void 0),te([t.Property()],i.prototype,"footerTemplate",void 0),te([t.Property()],i.prototype,"field",void 0),te([t.Property()],i.prototype,"format",void 0),te([t.Property()],i.prototype,"columnName",void 0),te([t.Property()],i.prototype,"customAggregate",void 0),i}(t.ChildProperty),ie=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return ee(r,e),te([t.Collection([],re)],r.prototype,"columns",void 0),te([t.Property(!0)],r.prototype,"showChildSummary",void 0),r}(t.ChildProperty),ne=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),oe=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},ae=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return ne(r,e),oe([t.Property(!1)],r.prototype,"allowAdding",void 0),oe([t.Property(!1)],r.prototype,"allowEditing",void 0),oe([t.Property(!1)],r.prototype,"allowDeleting",void 0),oe([t.Property("Cell")],r.prototype,"mode",void 0),oe([t.Property("Top")],r.prototype,"newRowPosition",void 0),oe([t.Property(!0)],r.prototype,"allowEditOnDblClick",void 0),oe([t.Property(!0)],r.prototype,"showConfirmDialog",void 0),oe([t.Property(!1)],r.prototype,"showDeleteConfirmDialog",void 0),oe([t.Property("")],r.prototype,"template",void 0),oe([t.Property({})],r.prototype,"dialog",void 0),oe([t.Property(!1)],r.prototype,"allowNextRowEdit",void 0),r}(t.ChildProperty),se=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),de=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},le=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return se(r,e),de([t.Property()],r.prototype,"field",void 0),de([t.Property()],r.prototype,"direction",void 0),r}(t.ChildProperty),pe=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return se(r,e),de([t.Collection([],le)],r.prototype,"columns",void 0),de([t.Property(!0)],r.prototype,"allowUnsort",void 0),r}(t.ChildProperty),he=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ce=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},ue=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return he(r,e),ce([t.Property(!1)],r.prototype,"enableCache",void 0),ce([t.Property(3)],r.prototype,"maxBlocks",void 0),ce([t.Property(3)],r.prototype,"initialBlocks",void 0),r}(t.ChildProperty),ge=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),fe=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},ye=function(i){function d(e,n){var o=i.call(this,e,n)||this;o.dataResults={},o.uniqueIDCollection={},o.uniqueIDFilterCollection={},o.changedRecords="changedRecords",o.deletedRecords="deletedRecords",o.addedRecords="addedRecords",o.indentOutdentAction="indentOutdentAction",o.modifiedRecords=[],o.stackedHeader=!1,o.objectEqualityChecker=function(e,t){if(e){for(var r=Object.keys(e),i=!0,n=["Children","childRecords","taskData","uniqueID","parentItem","parentUniqueID","index"],o=0;o<r.length;o++)if(!(e[r[parseInt(o.toString(),10)]]===t[r[parseInt(o.toString(),10)]]||-1!==n.indexOf(r[parseInt(o.toString(),10)])||e[r[parseInt(o.toString(),10)]]instanceof Date&&t[r[parseInt(o.toString(),10)]]instanceof Date&&e[r[parseInt(o.toString(),10)]].getTime()===t[r[parseInt(o.toString(),10)]].getTime())){i=!1;break}return i}return!1},l.Inject(F),t.setValue("mergePersistData",o.mergePersistTreeGridData,o);return t.isNullOrUndefined(o.injectedModules.Logger)||r.Grid.Inject(r.Logger),o.grid=new r.Grid,o}ge(d,i),l=d,d.prototype.excelExport=function(e,t,r,i){return this.excelExportModule.Map(e,t,r,i,!1)},d.prototype.csvExport=function(e,t,r,i){return this.excelExportModule.Map(e,t,r,i,!0)},d.prototype.pdfExport=function(e,t,r,i){return this.pdfExportModule.Map(e,t,r,i)},d.prototype.getModuleName=function(){return"treegrid"},d.prototype.preRender=function(){this.TreeGridLocale(),this.initProperties(),this.defaultLocale={Above:"Above",Below:"Below",Child:"Child",AddRow:"Add Row",ExpandAll:"Expand All",CollapseAll:"Collapse All",RowIndent:"Indent",RowOutdent:"Outdent"},this.l10n=new t.L10n("treegrid",this.defaultLocale,this.locale),this.isSelfReference&&t.isNullOrUndefined(this.childMapping)&&(this.childMapping="Children")},d.prototype.sortByColumn=function(e,t,r){this.sortModule&&this.sortModule.sortColumn(e,t,r)},d.prototype.clearSorting=function(){this.sortModule&&this.sortModule.clearSorting()},d.prototype.removeSortColumn=function(e){this.sortModule&&this.sortModule.removeSortColumn(e)},d.prototype.search=function(e){this.grid.search(e)},d.prototype.autoFitColumns=function(e){this.resizeModule.autoFitColumns(e),this.updateColumnModel()},d.prototype.reorderColumns=function(e,t){this.grid.reorderColumns(e,t)},d.prototype.TreeGridLocale=function(){var e=t.L10n.locale,i={};t.setValue(this.locale,{},i);var n;n={},n=r.getObject(this.locale,e);var o;o={},o=r.getObject(this.getModuleName(),n),t.setValue("grid",o,r.getObject(this.locale,i)),t.L10n.load(i)},d.prototype.print=function(){this.printModule.print()},d.prototype.treeGridkeyActionHandler=function(e){if(this.allowKeyboard){var r=void 0,i=void 0,n=void 0,o=void 0;switch(e.action){case"ctrlDownArrow":this.expandAll();break;case"ctrlUpArrow":this.collapseAll();break;case"ctrlShiftUpArrow":i=e.target.closest(".e-rowcell"),t.isNullOrUndefined(i)||(n=i.closest("tr"),t.isNullOrUndefined(n)||t.isNullOrUndefined(n.getElementsByClassName("e-treegridexpand")[0])||this.expandCollapseRequest(n.querySelector(".e-treegridexpand")));break;case"ctrlShiftDownArrow":i=e.target.closest(".e-rowcell"),t.isNullOrUndefined(i)||(n=i.closest("tr"),t.isNullOrUndefined(n)||t.isNullOrUndefined(n.getElementsByClassName("e-treegridcollapse")[0])||this.expandCollapseRequest(n.querySelector(".e-treegridcollapse")));break;case"downArrow":if(!this.enableVirtualization)if(r=e.target.parentElement,null!==(o=this.findnextRowElement(r))){var a=o.rowIndex;this.selectRow(a);var s=e.target.cellIndex,d=o.children[parseInt(s.toString(),10)];t.addClass([d],"e-focused"),t.addClass([d],"e-focus")}else this.clearSelection();break;case"upArrow":if(!this.enableVirtualization)if(r=e.target.parentElement,null!==(o=this.findPreviousRowElement(r))){var l=o.rowIndex;this.selectRow(l);var p=e.target.cellIndex,h=o.children[parseInt(p.toString(),10)];t.addClass([h],"e-focused"),t.addClass([h],"e-focus")}else this.clearSelection()}}},d.prototype.findnextRowElement=function(e){var t=e.nextElementSibling;return null===t||-1===t.className.indexOf("e-summaryrow")&&"none"!==t.style.display||(t=this.findnextRowElement(t)),t},d.prototype.findPreviousRowElement=function(e){var t=e.previousElementSibling;return null===t||-1===t.className.indexOf("e-summaryrow")&&"none"!==t.style.display||(t=this.findPreviousRowElement(t)),t},d.prototype.initProperties=function(){this.defaultLocale={},this.flatData=[],this.infiniteScrollData=[],this.remoteCollapsedData=[],this.remoteExpandedData=[],this.parentData=[],this.columnModel=[],this.isExpandAll=!1,this.isCollapseAll=!1,this.keyConfigs={ctrlDownArrow:"ctrl+downarrow",ctrlUpArrow:"ctrl+uparrow",ctrlShiftUpArrow:"ctrl+shift+uparrow",ctrlShiftDownArrow:"ctrl+shift+downarrow",downArrow:"downArrow",upArrow:"upArrow"},this.isLocalData=!(this.dataSource instanceof n.DataManager)||this.dataSource.dataSource.offline||!t.isNullOrUndefined(this.dataSource.ready)||this.dataSource.adaptor instanceof n.RemoteSaveAdaptor,this.isSelfReference=!t.isNullOrUndefined(this.parentIdMapping)},d.prototype.wireEvents=function(){t.EventHandler.add(this.grid.element,"click",this.mouseClickHandler,this),t.EventHandler.add(this.element,"touchend",this.mouseClickHandler,this),this.keyboardModule=new t.KeyboardEvents(this.element,{keyAction:this.treeGridkeyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"}),this.allowKeyboard&&(this.element.tabIndex=-1===this.element.tabIndex?0:this.element.tabIndex)},d.prototype.requiredModules=function(){var e=[];if(this.grid.splitFrozenCount(this.getGridColumns(this.columns)),this.isDestroyed)return e;e.push({member:"filter",args:[this,this.filterSettings]}),t.isNullOrUndefined(this.toolbar)||e.push({member:"toolbar",args:[this]}),this.contextMenuItems&&e.push({member:"contextMenu",args:[this]}),this.allowPaging&&e.push({member:"pager",args:[this,this.pageSettings]}),this.allowReordering&&e.push({member:"reorder",args:[this]}),this.allowSorting&&e.push({member:"sort",args:[this]}),this.aggregates.length>0&&e.push({member:"summary",args:[this]}),e.push({member:"resize",args:[this]}),this.allowExcelExport&&e.push({member:"ExcelExport",args:[this]});var r=this.injectedModules.filter(function(e){return"freeze"===e.prototype.getModuleName()});return(this.frozenColumns||this.frozenRows||this.getFrozenColumns()||this.grid.getFrozenLeftColumnsCount()||this.grid.getFrozenRightColumnsCount()||r.length)&&e.push({member:"freeze",args:[this]}),this.detailTemplate&&e.push({member:"detailRow",args:[this]}),this.allowPdfExport&&e.push({member:"PdfExport",args:[this]}),this.showColumnMenu&&e.push({member:"columnMenu",args:[this]}),this.showColumnChooser&&e.push({member:"ColumnChooser",args:[this]}),this.extendRequiredModules(e),e},d.prototype.extendRequiredModules=function(e){var r=this.injectedModules.filter(function(e){return"rowDragAndDrop"===e.prototype.getModuleName()});(this.allowRowDragAndDrop||r.length)&&(t.isNullOrUndefined(this.toolbar)||!this.toolbar.includes("Indent")&&!this.toolbar.includes("Outdent")||(this.isIndentEnabled=!0),e.push({member:"rowDragAndDrop",args:[this]})),(this.editSettings.allowAdding||this.editSettings.allowDeleting||this.editSettings.allowEditing)&&e.push({member:"edit",args:[this]}),this.isCommandColumn(this.columns)&&e.push({member:"commandColumn",args:[this]}),this.allowSelection&&e.push({member:"selection",args:[this]}),this.enableVirtualization&&e.push({member:"virtualScroll",args:[this]}),this.enableInfiniteScrolling&&e.push({member:"infiniteScroll",args:[this]}),e.push({member:"logger",args:[this.grid]})},d.prototype.isCommandColumn=function(e){var t=this;return e.some(function(e){return e.columns?t.isCommandColumn(e.columns):!(!e.commands&&!e.commandsTemplate)})},d.prototype.unwireEvents=function(){this.grid&&this.grid.element&&t.EventHandler.remove(this.grid.element,"click",this.mouseClickHandler)},d.prototype.log=function(e,t){this.loggerModule&&this.loggerModule.treeLog(e,t,this)},d.prototype.render=function(){var e=this;this.isReact&&(this.grid.isReact=!0,this.grid.portals=[]),this.isVue&&(this.grid.isVue=!0,this.grid.vueInstance=this.vueInstance),o.createSpinner({target:this.element},this.createElement),this.log(["mapping_fields_missing"]),this.renderModule=new Y(this),this.dataModule=new J(this),this.printModule=new j(this),this.trigger("load"),this.autoGenerateColumns(),this.initialRender=!0,t.isNullOrUndefined(this.dataSource)||this.convertTreeData(this.dataSource),this.loadGrid(),this.element.classList.contains("e-treegrid")&&this.rowDropSettings.targetID&&(this.grid.rowDropSettings.targetID+="_gridcontrol"),this.addListener();var r=t.createElement("div",{id:this.element.id+"_gridcontrol"});t.addClass([this.element],"e-treegrid"),t.isNullOrUndefined(this.height)||"string"!=typeof this.height||-1===this.height.indexOf("%")||(this.element.style.height=this.height),t.isNullOrUndefined(this.width)||"string"!=typeof this.width||-1===this.width.indexOf("%")||(this.element.style.width=this.width),this.element.appendChild(r);var i=this.grid.requiredModules;this.grid.requiredModules=function(){var e=[];e=i.apply(this);for(var t=0;t<e.length;t++)"virtualscroll"===e[parseInt(t.toString(),10)].member&&(e[parseInt(t.toString(),10)].member="treeVirtualScroll");return e};this.grid.root=this.root?this.root:this,this.grid.appendTo(r),this.isIndentEnabled&&this.refreshToolbarItems(),this.wireEvents(),this.renderComplete();var n=this.grid.destroyTemplate;this.grid.destroyTemplate=function(r,i){n.apply(e.grid);e.isReact&&t.isNullOrUndefined(e.portals)||e.clearTemplate(r,i)}},d.prototype.refreshToolbarItems=function(){var e=this.toolbarModule.getToolbar(),t=this.element.id+"_gridcontrol_indent",r=this.element.id+"_gridcontrol_outdent",i=e.querySelector("#"+t).parentElement,n=e.querySelector("#"+r).parentElement;i.classList.add("e-hidden"),n.classList.add("e-hidden")},d.prototype.afterGridRender=function(){t.isNullOrUndefined(this.grid.clipboardModule)||this.grid.clipboardModule.destroy(),this.clipboardModule=this.grid.clipboardModule=new L(this,this.grid.serviceLocator)},d.prototype.convertTreeData=function(e){var r=this;if(s(this)&&(e=t.getValue("result",e)),e instanceof Array&&e.length>0&&Object.prototype.hasOwnProperty.call(e[0],"level"))this.flatData=e,this.flatData.filter(function(e){t.setValue("uniqueIDCollection."+e.uniqueID,e,r),0===e.level&&r.parentData.push(e)});else if(s(this)){var i=t.getValue("result",this.dataSource);this.dataModule.convertToFlatData(i)}else this.dataModule.convertToFlatData(e)},d.prototype.bindGridProperties=function(){this.bindedDataSource(),this.grid.enableRtl=this.enableRtl,this.grid.allowKeyboard=this.allowKeyboard,this.grid.columns=this.getGridColumns(this.columns),this.grid.allowExcelExport=this.allowExcelExport,this.grid.allowPdfExport=this.allowPdfExport,this.grid.query=this.query,this.grid.columnQueryMode=this.columnQueryMode,this.grid.allowPaging=this.allowPaging,this.grid.pageSettings=r.getActualProperties(this.pageSettings),this.grid.pagerTemplate=this.pagerTemplate,this.grid.showColumnMenu=this.showColumnMenu,this.grid.allowSorting=this.allowSorting,this.grid.allowFiltering=this.allowFiltering,this.grid.enableVirtualization=this.enableVirtualization,this.grid.enableColumnVirtualization=this.enableColumnVirtualization,this.grid.enableInfiniteScrolling=this.enableInfiniteScrolling,this.grid.infiniteScrollSettings=this.infiniteScrollSettings,this.grid.enableVirtualMaskRow=this.enableVirtualMaskRow,this.grid.loadingIndicator=this.loadingIndicator,this.grid.width=this.width,this.grid.height=this.height,this.grid.enableAltRow=this.enableAltRow,this.grid.allowReordering=this.allowReordering,this.grid.allowTextWrap=this.allowTextWrap,this.grid.allowResizing=this.allowResizing,this.grid.enableHover=this.enableHover,this.grid.enableAutoFill=this.enableAutoFill,this.grid.enableAdaptiveUI=this.enableAdaptiveUI,this.grid.enableImmutableMode=this.enableImmutableMode,this.grid.allowRowDragAndDrop=this.allowRowDragAndDrop,this.grid.rowDropSettings=r.getActualProperties(this.rowDropSettings),this.grid.rowHeight=this.rowHeight,this.grid.gridLines=this.gridLines,this.grid.allowSelection=this.allowSelection,this.grid.toolbar=r.getActualProperties(this.getGridToolbar()),this.grid.toolbarTemplate=this.toolbarTemplate,this.grid.showColumnChooser=this.showColumnChooser,this.grid.filterSettings=r.getActualProperties(this.filterSettings),this.grid.selectionSettings=r.getActualProperties(this.selectionSettings),this.grid.sortSettings=r.getActualProperties(this.sortSettings),this.grid.searchSettings=r.getActualProperties(this.searchSettings),this.grid.aggregates=r.getActualProperties(this.aggregates),this.grid.textWrapSettings=r.getActualProperties(this.textWrapSettings),this.grid.printMode=r.getActualProperties(this.printMode),this.grid.locale=r.getActualProperties(this.locale),this.grid.selectedRowIndex=this.selectedRowIndex,this.grid.contextMenuItems=r.getActualProperties(this.getContextMenu()),this.grid.columnMenuItems=r.getActualProperties(this.columnMenuItems),this.grid.editSettings=this.getGridEditSettings(),this.grid.rowTemplate=r.getActualProperties(this.rowTemplate),this.grid.detailTemplate=r.getActualProperties(this.detailTemplate),this.grid.frozenRows=this.frozenRows,this.grid.frozenColumns=this.frozenColumns,this.grid.clipMode=r.getActualProperties(this.clipMode);this.grid.templateDotnetInstance=this.templateDotnetInstance;this.grid.isJsComponent=!0;this.grid.enableHtmlSanitizer=this.enableHtmlSanitizer},d.prototype.triggerEvents=function(e){this.trigger(r.getObject("name",e),e)},d.prototype.IsExpandCollapseClicked=function(e){if(!t.isNullOrUndefined(e.target)&&(e.target.classList.contains("e-treegridexpand")||e.target.classList.contains("e-treegridcollapse")||e.target.classList.contains("e-summarycell"))&&!t.isNullOrUndefined(e.data)&&e.data.hasChildRecords&&!this.selectionSettings.checkboxOnly)return void(e.cancel=!0)},d.prototype.bindGridEvents=function(){var e=this;this.grid.rowSelecting=function(t){e.IsExpandCollapseClicked(t),e.trigger("rowSelecting",t)},this.grid.rowDeselecting=function(t){e.IsExpandCollapseClicked(t),e.trigger("rowDeselecting",t)},this.grid.rowSelected=function(t){if(e.enableVirtualization&&t.isHeaderCheckboxClicked&&e.grid.currentViewData.length!==e.grid.selectionModule.selectedRowIndexes.length)for(var r=0;r<e.getRows().length;r++)e.getRows()[parseInt(r.toString(),10)].getElementsByClassName("e-frame e-icons e-uncheck").length&&e.grid.selectionModule.updateRowSelection(e.getRows()[parseInt(r.toString(),10)],e.getCurrentViewRecords()[parseInt(r.toString(),10)].index);e.selectedRowIndex=e.grid.selectedRowIndex,e.notify("rowSelected",t),e.trigger("rowSelected",t)},this.grid.rowDeselected=function(r){e.selectedRowIndex=e.grid.selectedRowIndex,t.isNullOrUndefined(r.data)||e.notify("rowDeselected",r),e.trigger("rowDeselected",r)},this.grid.resizeStop=function(t){e.updateColumnModel(),e.trigger("resizeStop",t)},this.grid.excelQueryCellInfo=function(t){e.notify("excelCellInfo",t),t=e.dataResults},this.grid.pdfQueryCellInfo=function(t){e.notify("pdfCellInfo",t),t=e.dataResults},this.grid.checkBoxChange=function(t){e.trigger("checkboxChange",t)},this.grid.pdfExportComplete=this.triggerEvents.bind(this),this.grid.excelExportComplete=this.triggerEvents.bind(this),this.grid.excelHeaderQueryCellInfo=this.triggerEvents.bind(this),this.grid.pdfHeaderQueryCellInfo=this.triggerEvents.bind(this),this.grid.dataSourceChanged=this.triggerEvents.bind(this),this.grid.recordDoubleClick=this.triggerEvents.bind(this),this.grid.cellDeselected=this.triggerEvents.bind(this),this.grid.cellDeselecting=this.triggerEvents.bind(this),this.grid.columnMenuOpen=this.triggerEvents.bind(this),this.grid.columnMenuClick=this.triggerEvents.bind(this),this.grid.cellSelected=this.triggerEvents.bind(this),this.grid.headerCellInfo=this.triggerEvents.bind(this),this.grid.resizeStart=this.triggerEvents.bind(this),this.grid.resizing=this.triggerEvents.bind(this),this.grid.columnDrag=this.triggerEvents.bind(this),this.grid.columnDragStart=this.triggerEvents.bind(this),this.grid.columnDrop=this.triggerEvents.bind(this),this.grid.beforePrint=this.triggerEvents.bind(this),this.grid.beforeCopy=this.triggerEvents.bind(this),this.grid.beforePaste=function(t){for(var r=e.getRows();r[t.rowIndex].classList.contains("e-summaryrow");)t.rowIndex++;e.trigger("beforePaste",t)},this.grid.load=function(){if(e.grid.on("initial-end",e.afterGridRender,e),!t.isNullOrUndefined(e.loggerModule)){e.loggerModule=e.grid.loggerModule=new B(e.grid)}},this.grid.printComplete=this.triggerEvents.bind(this),this.grid.actionFailure=this.triggerEvents.bind(this),this.extendedGridDataBoundEvent(),this.extendedGridEvents(),this.extendedGridActionEvents(),this.extendedGridEditEvents(),this.bindGridDragEvents(),this.bindCallBackEvents()},d.prototype.lastRowBorder=function(e,r){for(var i=0;i<e.cells.length;i++)r?t.addClass([e.cells[parseInt(i.toString(),10)]],"e-lastrowcell"):t.removeClass([e.cells[parseInt(i.toString(),10)]],"e-lastrowcell")},d.prototype.isPixelHeight=function(){return"auto"!==this.height&&-1===this.height.toString().indexOf("%")},d.prototype.extendedGridDataBoundEvent=function(){var e=this;this.grid.dataBound=function(i){if(e.updateRowTemplate(),e.updateColumnModel(),e.updateAltRow(e.getRows()),e.notify("dataBoundArg",i),a(e)&&!u(e)&&!e.hasChildMapping){var n=r.getObject("dataSource.requests",e).filter(function(e){return"OK"!==e.httpRequest.statusText}).length;t.setValue("grid.contentModule.isLoaded",!(n>0),e)}if(e.isPixelHeight()&&e.initialRender)for(var o=e.getContentTable().rows,s=[].slice.call(o),d=s.length-1;d>0;d--)if(!m(s[parseInt(d.toString(),10)])){s[parseInt(d.toString(),10)].nextElementSibling&&e.lastRowBorder(s[parseInt(d.toString(),10)],!0);break}if(e.enableVirtualization&&e.selectionSettings.persistSelection&&("expand"===e.dataResults.action||"collapse"===e.dataResults.action)){if(e.grid.selectionModule.refreshPersistSelection(),"Single"===e.grid.selectionSettings.type){var l=e.getCurrentViewRecords().indexOf(e.grid.selectionModule.data);e.grid.selectionModule.updateRowSelection(e.getRows()[parseInt(l.toString(),10)],l)}}e.trigger("dataBound",i),e.initialRender=!1};var i=this;this.grid.beforeDataBound=function(e){var o=r.getObject("action",e);if((a(i)&&!u(i)||s(this))&&"edit"!==o)i.notify("updateRemoteLevel",e),e=i.dataResults;else if(0===i.flatData.length&&u(i)&&i.dataSource instanceof n.DataManager){var d=i.dataSource;i.dataModule.convertToFlatData(d.dataSource.json),e.result=i.grid.dataSource.dataSource.json=i.flatData}if(a(i)||s(this)||t.isNullOrUndefined(i.dataSource)||(this.isPrinting&&t.setValue("isPrinting",!0,e),i.notify("dataProcessor",e)),t.extend(e,i.dataResults),i.enableImmutableMode&&(e.result=e.result.slice()),i.initialRender&&(this.contentModule.objectEqualityChecker=i.objectEqualityChecker),!this.isPrinting){var l=new n.Deferred;return i.trigger("beforeDataBound",e,function(e){l.resolve(e)}),l}},this.grid.log=function(t,r){e.loggerModule&&e.loggerModule.log(t,r)}},d.prototype.bindCallBackEvents=function(){var e=this;this.grid.toolbarClick=function(t){if(!(t.item.id===e.grid.element.id+"_excelexport"&&!1===e.allowExcelExport||t.item.id===e.grid.element.id+"_pdfexport"&&!1===e.allowPdfExport||t.item.id===e.grid.element.id+"_csvexport"&&!1===e.allowExcelExport)){var r=new n.Deferred;return e.trigger("toolbarClick",t,function(i){i.cancel||e.notify("toolbarClick",t),r.resolve(i)}),r}},this.grid.cellSelecting=function(i){var o=e.grid.selectionModule.actualTarget;t.isNullOrUndefined(o)||!o.classList.contains("e-treegridexpand")&&!o.classList.contains("e-treegridcollapse")||(i.cancel=!0);var a=new n.Deferred;return e.trigger(r.getObject("name",i),i,function(e){a.resolve(e)}),a},this.grid.beginEdit=function(r){if(!t.isNullOrUndefined(r.row)&&r.row.classList.contains("e-summaryrow"))return void(r.cancel=!0);var i=new n.Deferred;return e.trigger("beginEdit",r,function(e){i.resolve(e)}),i}},d.prototype.extendedGridEditEvents=function(){var e=this;this.grid.dataStateChange=function(r){e.isExpandRefresh?(e.isExpandRefresh=!1,e.grid.dataSource={result:e.flatData,count:t.getValue("count",e.grid.dataSource)}):("infiniteScroll"!==r.action.requestType&&(e.infiniteScrollData=[]),e.trigger("dataStateChange",r))},this.grid.cellSave=function(r){if(e.grid.isContextMenuOpen()){var i=e.grid.contextMenuModule.contextMenu.element.getElementsByClassName("e-selected")[0];(t.isNullOrUndefined(i)||i.id!==e.element.id+"_gridcontrol_cmenu_Save")&&(r.cancel=!0)}var o=new n.Deferred;return e.trigger("cellSave",r,function(t){t.cancel||e.notify("cellSave",t),o.resolve(t)}),o},this.grid.cellSaved=function(t){e.trigger("cellSaved",t),e.notify("cellSaved",t)},this.grid.cellEdit=function(t){var r=new n.Deferred;return t.promise=r,e.notify("cellEdit",t),r},this.grid.batchAdd=function(t){e.trigger("batchAdd",t),e.notify("batchAdd",t)},this.grid.beforeBatchSave=function(t){e.trigger("beforeBatchSave",t),e.notify("beforeBatchSave",t)},this.grid.beforeBatchAdd=function(t){e.trigger("beforeBatchAdd",t),e.notify("beforeBatchAdd",t)},this.grid.batchDelete=function(t){e.trigger("batchDelete",t),e.notify("batchDelete",t)},this.grid.beforeBatchDelete=function(t){e.trigger("beforeBatchDelete",t),e.notify("beforeBatchDelete",t)},this.grid.batchCancel=function(t){"Cell"!==e.editSettings.mode&&e.trigger("batchCancel",t),e.notify("batchCancel",t)}},d.prototype.updateRowTemplate=function(){var e=this;this.rowTemplate&&(this.isReact&&0===this.getContentTable().rows.length?setTimeout(function(){if(e.treeColumnRowTemplate(),e.enableCollapseAll)for(var t=e.getCurrentViewRecords(),r=e.getContentTable().rows,i=0;i<r.length;i++){var n={data:t[parseInt(i.toString(),10)],row:r[parseInt(i.toString(),10)]};e.renderModule.RowModifier(n)}},0):this.treeColumnRowTemplate())},d.prototype.bindedDataSource=function(){if(this.dataSource&&s(this)){var e=this.flatData,r=t.getValue("count",this.dataSource);this.grid.dataSource={result:e,count:r}}else this.grid.dataSource=this.dataSource instanceof n.DataManager?new n.DataManager(this.dataSource.dataSource,this.dataSource.defaultQuery,this.dataSource.adaptor):this.flatData;if(this.dataSource instanceof n.DataManager&&(this.dataSource.dataSource.offline||this.dataSource.ready)){this.grid.dataSource.dataSource.json=g(this.dataSource.dataSource.json),this.grid.dataSource.ready=this.dataSource.ready;var i=this;t.isNullOrUndefined(this.grid.dataSource.ready)||this.grid.dataSource.ready.then(function(e){var t=i.grid.dataSource;t.dataSource.offline=!0,t.isDataAvailable=!0,t.dataSource.json=e.result,t.adaptor=new n.JsonAdaptor})}},d.prototype.extendedGridActionEvents=function(){var e=this;this.grid.actionBegin=function(i){if("sorting"===i.requestType&&i.target&&i.target.parentElement&&i.target.parentElement.classList.contains("e-hierarchycheckbox")&&(i.cancel=!0),"reorder"===r.getObject("requestType",i)&&e.notify("getColumnIndex",{}),a(e)&&e.enableVirtualization&&("virtualscroll"===i.requestType?(e.query.expand("VirtualScrollingAction"),e.showSpinner()):"searching"===i.requestType&&""===i.searchString?e.query.expand("ClearSearchingAction"):"clearFilter"===i.action&&e.query.expand("ClearFilteringAction")),e.notify("actionBegin",{editAction:i}),a(e)||t.isNullOrUndefined(e.filterModule)||s(e)||0!==e.grid.filterSettings.columns.length||0!==e.grid.searchSettings.key.length||(e.notify("clearFilters",{flatData:e.grid.dataSource}),e.grid.setProperties({dataSource:e.dataResults.result},!0),t.isNullOrUndefined(e.grid.changedProperties.dataSource)&&(e.grid.renderModule.data.dataManager=e.grid.dataSource instanceof n.DataManager?e.grid.dataSource:t.isNullOrUndefined(e.grid.dataSource)?new n.DataManager:new n.DataManager(e.grid.dataSource),e.grid.renderModule.data.isQueryInvokedFromData=!0,e.grid.query=e.grid.query instanceof n.Query?e.grid.query:new n.Query)),"indenting"!==e.action&&"outdenting"!==e.action){var o=new n.Deferred;return e.trigger("actionBegin",i,function(t){t.cancel||e.notify("beginEdit",t),o.resolve(t)}),o}},this.grid.actionComplete=function(t){if(e.notify("actioncomplete",t),e.updateColumnModel(),e.updateTreeGridModel(),"reorder"===t.requestType&&e.notify("setColumnIndex",{}),e.notify("actionComplete",{editAction:t}),"add"===t.requestType&&"Top"!==e.editSettings.newRowPosition&&"Bottom"!==e.editSettings.newRowPosition&&e.notify("beginAdd",t),"batchsave"===t.requestType&&e.notify("batchSave",t),e.notify("updateGridActions",t),"save"===t.requestType&&e.aggregates.map(function(e){return!0===e.showChildSummary}).length&&e.grid.refresh(),"filter"===t.action&&(""===e.filterModule.currentFilterObject||!e.enableVirtualization||e.initialRender||a(e)&&e.enableVirtualization||e.expandAll()),"searching"===t.requestType&&(""===e.searchSettings.key||!e.enableVirtualization||e.initialRender||a(e)&&e.enableVirtualization||e.expandAll()),"clearFilter"===t.action&&e.enableCollapseAll&&e.collapseAll(),"indenting"===e.action||"outdenting"===e.action){e.action="indenting"===e.action?"indented":"outdented";var r=[e.selectedRecords],i={data:r,dropIndex:e.dropIndex,dropPosition:e.dropPosition,modifiedRecords:e.modifiedRecords,requestType:e.action,row:e.selectedRows};e.trigger("actionComplete",i),e.getCurrentViewRecords().filter(function(e){return e.uniqueID===r[0].uniqueID}).length||e.refreshToolbarItems(),e.action="",e.selectedRecords=e.selectedRows=e.modifiedRecords=[]}else{if(e.grid.isFrozenGrid()&&e.enableVirtualization&&"movable"===t.tableName){var n=e.grid.element.querySelector(".e-movablecontent"),o=e.grid.element.querySelector(".e-frozencontent");n.style.height=o.style.height="auto"}e.trigger("actionComplete",t)}}},d.prototype.extendedGridEvents=function(){var e=this,r=this;this.grid.recordDoubleClick=function(t){e.trigger("recordDoubleClick",t),e.notify("recordDoubleClick",t)},this.grid.detailDataBound=function(t){e.notify("detaildataBound",t),e.trigger("detailDataBound",t)},this.grid.rowDataBound=function(e){t.isNullOrUndefined(this.isPrinting)?t.setValue("isPrinting",!1,e):t.setValue("isPrinting",this.isPrinting,e),r.renderModule.RowModifier(e)},this.grid.queryCellInfo=function(e){t.isNullOrUndefined(this.isPrinting)?t.setValue("isPrinting",!1,e):t.setValue("isPrinting",this.isPrinting,e),r.renderModule.cellRender(e)},this.grid.contextMenuClick=function(t){e.notify("contextMenuClick",t),e.trigger("contextMenuClick",t)},this.grid.contextMenuOpen=function(t){e.notify("contextMenuOpen",t),e.trigger("contextMenuOpen",t)},this.grid.queryCellInfo=function(t){e.renderModule.cellRender(t)}},d.prototype.bindGridDragEvents=function(){var e=this;this.grid.rowDragStartHelper=function(t){e.trigger("rowDragStartHelper",t)},this.grid.rowDragStart=function(t){e.trigger("rowDragStart",t)},this.grid.rowDrag=function(t){if(e.grid.isEdit)return void(t.cancel=!0);e.notify("row-draging",t),e.trigger("rowDrag",t)},this.grid.rowDrop=function(t){if(e.grid.isEdit)return void(t.cancel=!0);e.notify("row-dropped",t),t.cancel=!0}},d.prototype.loadGrid=function(){this.bindGridProperties(),this.bindGridEvents(),t.setValue("registeredTemplate",this.registeredTemplate,this.grid);t.setValue("viewContainerRef",this.viewContainerRef,this.grid)},d.prototype.autoGenerateColumns=function(){if(!this.columns.length&&!this.dataModule.isRemote()&&Object.keys(this.dataSource).length){this.columns=[];for(var e=this.dataSource[0],t=Object.keys(e),r=0;r<t.length;r++)-1===[this.childMapping,this.parentIdMapping].indexOf(t[parseInt(r.toString(),10)])&&this.columns.push(t[parseInt(r.toString(),10)])}},d.prototype.getGridEditSettings=function(){var e={};switch(e.allowAdding=this.editSettings.allowAdding,e.allowEditing=this.editSettings.allowEditing,e.allowDeleting=this.editSettings.allowDeleting,e.newRowPosition="Bottom"===this.editSettings.newRowPosition?"Bottom":"Top",e.allowEditOnDblClick=this.editSettings.allowEditOnDblClick,e.showConfirmDialog=this.editSettings.showConfirmDialog,e.template=this.editSettings.template,e.showDeleteConfirmDialog=this.editSettings.showDeleteConfirmDialog,e.allowNextRowEdit=this.editSettings.allowNextRowEdit,e.guid=this.editSettings.guid,e.dialog=this.editSettings.dialog,this.editSettings.mode){case"Dialog":case"Batch":e.mode=this.editSettings.mode;break;case"Row":e.mode="Normal";break;case"Cell":e.mode="Normal",e.showConfirmDialog=!1}return e},d.prototype.getContextMenu=function(){if(this.contextMenuItems){for(var t=[],r=0;r<this.contextMenuItems.length;r++)switch(this.contextMenuItems[parseInt(r.toString(),10)]){case"AddRow":case e.ContextMenuItems.AddRow:t.push({text:this.l10n.getConstant("AddRow"),target:".e-content",id:this.element.id+"_gridcontrol_cmenu_AddRow",items:[{text:this.l10n.getConstant("Above"),id:"Above"},{text:this.l10n.getConstant("Below"),id:"Below"},{text:this.l10n.getConstant("Child"),id:"Child"}]});break;case"Indent":case e.ContextMenuItems.RowIndent:t.push({text:this.l10n.getConstant("RowIndent"),target:".e-content",iconCss:"e-indent e-icons",id:this.element.id+"_gridcontrol_cmenu_Indent"});break;case"Outdent":case e.ContextMenuItems.RowOutdent:t.push({text:this.l10n.getConstant("RowOutdent"),target:".e-content",iconCss:"e-outdent e-icons",id:this.element.id+"_gridcontrol_cmenu_Outdent"});break;default:t.push(this.contextMenuItems[parseInt(r.toString(),10)])}return t}return null},d.prototype.getGridToolbar=function(){if(this.toolbar){this.l10n=new t.L10n("treegrid",this.defaultLocale,this.locale);for(var r=[],i=void 0,n=0;n<this.toolbar.length;n++)switch(this.toolbar[parseInt(n.toString(),10)]){case"Search":case e.ToolbarItem.Search:r.push("Search");break;case"Print":case e.ToolbarItem.Print:r.push("Print");break;case"ExpandAll":case e.ToolbarItem.ExpandAll:i=this.l10n.getConstant("ExpandAll"),r.push({text:i,tooltipText:i,prefixIcon:"e-expand",id:this.element.id+"_gridcontrol_expandall"});break;case"CollapseAll":case e.ToolbarItem.CollapseAll:i=this.l10n.getConstant("CollapseAll"),r.push({text:i,tooltipText:i,prefixIcon:"e-collapse",id:this.element.id+"_gridcontrol_collapseall"});break;case"Indent":case e.ToolbarItem.RowIndent:i=this.l10n.getConstant("RowIndent"),r.push({text:i,tooltipText:i,prefixIcon:"e-indent",id:this.element.id+"_gridcontrol_indent"});break;case"Outdent":case e.ToolbarItem.RowOutdent:i=this.l10n.getConstant("RowOutdent"),r.push({text:i,tooltipText:i,prefixIcon:"e-outdent",id:this.element.id+"_gridcontrol_outdent"});break;default:r.push(this.toolbar[parseInt(n.toString(),10)])}return r}return null},d.prototype.getGridColumns=function(e,r,i){void 0===r&&(r=!0),void 0===i&&(i=0);var n=e;r&&(this.columnModel=[]);var o,a;0===this.columnModel.length&&(i=0===i?-1:i);for(var s=[],d=0;d<n.length;d++){i+=1;var l=this.grid.getColumnByUid(n[parseInt(d.toString(),10)].uid);if(a=l||{},o={},"string"==typeof this.columns[parseInt(d.toString(),10)])a.field=o.field=this.columns[parseInt(d.toString(),10)];else for(var p=0,h=Object.keys(n[parseInt(d.toString(),10)]);p<h.length;p++){var c=h[p];i===this.treeColumnIndex&&"template"===c?o[""+c]=n[parseInt(d.toString(),10)][""+c]:"columns"!==c||t.isNullOrUndefined(n[parseInt(d.toString(),10)][""+c])?this.initialRender&&!t.isNullOrUndefined(l)&&this.enablePersistence&&"edit"===c?a[""+c]=o[""+c]=l[""+c]:l&&"sortComparer"===c||(a[""+c]=o[""+c]=n[parseInt(d.toString(),10)][""+c]):(a[""+c]=this.getGridColumns(n[parseInt(d.toString(),10)][""+c],!1,this.columnModel.length-1),o[""+c]=n[parseInt(d.toString(),10)][""+c])}o.columns||this.columnModel.push(new R(o)),s.push(a),!t.isNullOrUndefined(this.columnModel[this.treeColumnIndex])&&this.enableRtl&&a.field===this.columnModel[this.treeColumnIndex].field&&(t.isNullOrUndefined(this.treeColumnTextAlign)&&(this.treeColumnTextAlign=this.columnModel[this.treeColumnIndex].textAlign,this.treeColumnField=this.columnModel[this.treeColumnIndex].field),a.textAlign="Right")}return s},d.prototype.onPropertyChanged=function(e){for(var i=!1,o=0,a=Object.keys(e);o<a.length;o++){var d=a[o];switch(d){case"columns":this.grid.columns=this.getGridColumns(this.columns);break;case"treeColumnIndex":this.grid.refreshColumns();break;case"allowPaging":this.grid.allowPaging=this.allowPaging;break;case"pageSettings":this.grid.pageSettings=r.getActualProperties(this.pageSettings),i=!0;break;case"enableVirtualization":this.grid.enableVirtualization=this.enableVirtualization;break;case"enableColumnVirtualization":this.grid.enableColumnVirtualization=this.enableColumnVirtualization;break;case"toolbar":this.grid.toolbar=this.getGridToolbar();break;case"allowSelection":this.grid.allowSelection=this.allowSelection;break;case"selectionSettings":this.grid.selectionSettings=r.getActualProperties(this.selectionSettings);break;case"allowSorting":this.grid.allowSorting=this.allowSorting;break;case"allowMultiSorting":this.grid.allowMultiSorting=this.allowMultiSorting;break;case"sortSettings":this.grid.sortSettings=r.getActualProperties(this.sortSettings);break;case"searchSettings":this.grid.searchSettings=r.getActualProperties(this.searchSettings);break;case"allowFiltering":this.grid.allowFiltering=this.allowFiltering;break;case"filterSettings":this.initialRender||(this.grid.filterSettings=r.getActualProperties(this.filterSettings));break;case"showColumnMenu":this.grid.showColumnMenu=this.showColumnMenu;break;case"allowRowDragAndDrop":this.grid.allowRowDragAndDrop=this.allowRowDragAndDrop;break;case"aggregates":this.grid.aggregates=r.getActualProperties(this.aggregates);break;case"enableInfiniteScrolling":this.grid.enableInfiniteScrolling=this.enableInfiniteScrolling;break;case"dataSource":if(this.isLocalData=!(this.dataSource instanceof n.DataManager)||!t.isNullOrUndefined(this.dataSource.ready)||this.dataSource.adaptor instanceof n.RemoteSaveAdaptor,this.convertTreeData(this.dataSource),this.isLocalData){if(s(this)){var l=t.getValue("count",this.dataSource);this.grid.dataSource={result:this.flatData,count:l}}else{var p=this.dataSource;this.grid.dataSource=p instanceof n.DataManager?new n.DataManager(p.dataSource,p.defaultQuery,p.adaptor):this.flatData}this.enableVirtualization&&(this.grid.contentModule.isDataSourceChanged=!0)}else this.bindedDataSource(),this.enableVirtualization&&(this.grid.contentModule.removeEventListener(),this.grid.contentModule.eventListener("on"),this.grid.contentModule.renderTable());break;case"query":this.grid.query=this.query;break;case"enableCollapseAll":e[""+d]?this.collapseAll():this.expandAll();break;case"expandStateMapping":this.grid.refresh();break;case"gridLines":this.grid.gridLines=this.gridLines;break;case"rowTemplate":this.grid.rowTemplate=r.getActualProperties(this.rowTemplate);break;case"frozenRows":this.grid.frozenRows=this.frozenRows;break;case"frozenColumns":this.grid.frozenColumns=this.frozenColumns;break;case"rowHeight":this.grid.rowHeight=this.rowHeight;break;case"height":t.isNullOrUndefined(this.height)||"string"!=typeof this.height||-1===this.height.indexOf("%")||(this.element.style.height=this.height),this.grid.height=this.height;break;case"width":t.isNullOrUndefined(this.width)||"string"!=typeof this.width||-1===this.width.indexOf("%")||(this.element.style.width=this.width),this.grid.width=this.width;break;case"locale":this.grid.locale=this.locale,this.TreeGridLocale(),this.grid.toolbar=this.getGridToolbar(),this.grid.contextMenuItems=this.getContextMenu();break;case"selectedRowIndex":this.grid.selectedRowIndex=this.selectedRowIndex;break;case"enableAltRow":this.grid.enableAltRow=this.enableAltRow;break;case"enableHover":this.grid.enableHover=this.enableHover;break;case"enableAutoFill":this.grid.enableAutoFill=this.enableAutoFill;break;case"enableAdaptiveUI":this.grid.enableAdaptiveUI=this.enableAdaptiveUI;break;case"enableImmutableMode":this.grid.enableImmutableMode=this.enableImmutableMode;break;case"allowExcelExport":this.grid.allowExcelExport=this.allowExcelExport;break;case"allowPdfExport":this.grid.allowPdfExport=this.allowPdfExport;break;case"enableRtl":t.isNullOrUndefined(this.treeColumnField)||this.updateTreeColumnTextAlign(),this.grid.enableRtl=this.enableRtl;break;case"allowReordering":this.grid.allowReordering=this.allowReordering;break;case"allowResizing":this.grid.allowResizing=this.allowResizing;break;case"textWrapSettings":this.grid.textWrapSettings=r.getActualProperties(this.textWrapSettings);break;case"allowTextWrap":this.grid.allowTextWrap=r.getActualProperties(this.allowTextWrap),this.grid.refresh();break;case"contextMenuItems":this.grid.contextMenuItems=this.getContextMenu();break;case"showColumnChooser":this.grid.showColumnChooser=this.showColumnChooser;break;case"detailTemplate":this.grid.detailTemplate=r.getActualProperties(this.detailTemplate);break;case"columnMenuItems":this.grid.columnMenuItems=r.getActualProperties(this.columnMenuItems);break;case"editSettings":this.grid.isEdit&&"Normal"===this.grid.editSettings.mode&&e[""+d].mode&&("Cell"===e[""+d].mode||"Row"===e[""+d].mode)&&this.grid.closeEdit(),this.grid.editSettings=this.getGridEditSettings()}i&&this.grid.refresh()}},d.prototype.updateTreeColumnTextAlign=function(){this.grid.getColumnByField(this.treeColumnField).textAlign=this.enableRtl?"Right":this.treeColumnTextAlign,this.grid.refreshColumns()},d.prototype.destroy=function(){var e=this.element;if(e){var t=!(!e.querySelector(".e-gridheader")||!e.querySelector(".e-gridcontent"));t&&this.unwireEvents(),this.removeListener(),t&&i.prototype.destroy.call(this),this.grid&&this.grid.destroy(),this.dataModule&&this.dataModule.destroy();for(var r=["dataModule","sortModule","renderModule","filterModule","printModule","clipboardModule","excelExportModule","pdfExportModule","toolbarModule","summaryModule","reorderModule","resizeModule","pagerModule","keyboardModule","columnMenuModule","contextMenuModule","editModule","virtualScrollModule","selectionModule","detailRow","rowDragAndDropModule","freezeModule"],n=0;n<r.length;n++)this[r[parseInt(n.toString(),10)]]&&(this[r[parseInt(n.toString(),10)]]=null);this.element.innerHTML="",this.grid=null}},d.prototype.dataBind=function(){t.isNullOrUndefined(this.grid)||(!t.isNullOrUndefined(this.rowDropSettings.targetID)&&t.isNullOrUndefined(document.getElementById(this.grid.rowDropSettings.targetID))&&(document.getElementById(this.rowDropSettings.targetID).id=this.grid.rowDropSettings.targetID,this.rowDropSettings.targetID=this.grid.rowDropSettings.targetID),i.prototype.dataBind.call(this),this.grid.dataBind())},d.prototype.getPersistData=function(){for(var e=["pageSettings","sortSettings","filterSettings","columns","searchSettings","selectedRowIndex","treeColumnIndex"],r={pageSettings:["template","pageSizes","pageSizeMode","enableQueryString","totalRecordsCount","pageCount"],filterSettings:["type","mode","showFilterBarStatus","immediateModeDelay","ignoreAccent","hierarchyMode"],searchSettings:["fields","operator","ignoreCase"],sortSettings:[],columns:[],selectedRowIndex:[]},i=["filter","edit","filterBarTemplate","headerTemplate","template","commandTemplate","commands","dataSource"],n=0;n<e.length;n++)for(var o=this[e[parseInt(n.toString(),10)]],a=0,s=r[e[parseInt(n.toString(),10)]];!t.isNullOrUndefined(s)&&a<s.length;a++)delete o[""+s[parseInt(a.toString(),10)]];return this.ignoreInArrays(i,this.columns),this.addOnPersist(e)},d.prototype.ignoreInArrays=function(e,t){for(var r=0;r<t.length;r++)t[parseInt(r.toString(),10)].columns?(this.ignoreInColumn(e,t[parseInt(r.toString(),10)]),this.ignoreInArrays(e,t[parseInt(r.toString(),10)].columns)):this.ignoreInColumn(e,t[parseInt(r.toString(),10)])},d.prototype.ignoreInColumn=function(e,t){for(var r=0;r<e.length;r++)delete t[e[parseInt(r.toString(),10)]],t.filter={}},d.prototype.mouseClickHandler=function(e){if(t.isNullOrUndefined(e.touches)){var r=e.target;!r.classList.contains("e-treegridexpand")&&!r.classList.contains("e-treegridcollapse")||this.isEditCollapse||this.grid.isEdit||this.expandCollapseRequest(r),this.isEditCollapse=!1,this.notify("checkboxSelection",{target:r})}},d.prototype.getRows=function(){return this.grid.getRows()},d.prototype.getPager=function(){return this.grid.getPager()},d.prototype.addRecord=function(e,t,r){if(this.editModule){this.editModule.isAddedRowByMethod=!0,this.editModule.addRecord(e,t,r)}},d.prototype.closeEdit=function(){this.grid.editModule&&this.grid.editModule.closeEdit()},d.prototype.saveCell=function(){this.grid.editModule&&this.grid.editModule.saveCell()},d.prototype.updateCell=function(e,t,r){this.grid.editModule&&this.grid.editModule.updateCell(e,t,r)},d.prototype.updateRow=function(e,r){if(this.grid.editModule)if(t.isNullOrUndefined(e))this.grid.editModule.updateRow(e,r);else{var i=this.grid.getCurrentViewRecords()[parseInt(e.toString(),10)];t.extend(i,r),this.grid.editModule.updateRow(e,i)}},d.prototype.deleteRecord=function(e,t){this.grid.editModule&&this.grid.editModule.deleteRecord(e,t)},d.prototype.startEdit=function(e){this.grid.editModule&&this.grid.editModule.startEdit(e)},d.prototype.editCell=function(e,t){this.editModule&&this.editModule.editCell(e,t)},d.prototype.enableToolbarItems=function(e,t){this.grid.toolbarModule&&this.grid.toolbarModule.enableItems(e,t)},d.prototype.endEdit=function(){this.grid.editModule&&this.grid.editModule.endEdit()},d.prototype.openColumnChooser=function(e,t){this.columnChooserModule&&this.columnChooserModule.openColumnChooser(e,t)},d.prototype.deleteRow=function(e){this.grid.editModule&&this.grid.editModule.deleteRow(e)},d.prototype.getPrimaryKeyFieldNames=function(){return this.grid.getPrimaryKeyFieldNames()},d.prototype.setCellValue=function(e,r,i){this.grid.setCellValue(e,r,i);var n=this.grid.getRowIndexByPrimaryKey(e),o=this.getCurrentViewRecords()[parseInt(n.toString(),10)];t.isNullOrUndefined(o)||v({value:o,action:"edit"},this,this.isSelfReference,o.index,this.grid.selectedRowIndex,r)},d.prototype.setRowData=function(e,t){var r=this.getCurrentViewRecords(),i=this.grid.getPrimaryKeyFieldNames()[0],n=0,o={};r.some(function(t){return t[""+i]===e&&(o=t,!0)}),n=o.level,t.level=n,t.index=o.index,t.childRecords=o.childRecords,t.taskData=o.taskData,t.uniqueID=o.uniqueID,t.parentItem=o.parentItem,t.checkboxState=o.checkboxState,t.hasChildRecords=o.hasChildRecords,t.parentUniqueID=o.parentUniqueID,t.expanded=o.expanded,this.grid.setRowData(e,t);var a=this.getVisibleRecords();if(a.length>0&&e===a[a.length-1][""+i]){var s=this.getContentTable().scrollHeight,d=this.getContent().clientHeight;this.lastRowBorder(this.getRows()[r.indexOf(o)],s<=d)}},d.prototype.goToPage=function(e){this.grid.pagerModule&&this.grid.pagerModule.goToPage(e)},d.prototype.updateExternalMessage=function(e){this.pagerModule&&this.grid.pagerModule.updateExternalMessage(e)},d.prototype.getCellFromIndex=function(e,t){return this.grid.getCellFromIndex(e,t)},d.prototype.getColumnByField=function(e){return r.iterateArrayOrObject(this.columnModel,function(t){if(t.field===e)return t})[0]},d.prototype.getColumnByUid=function(e){var t=this.initialRender?this.grid.columns:this.columns;return this.grid.columns.length!==this.columnModel.length&&(t=this.grid.columnModel),r.iterateArrayOrObject(t,function(t){if(t.uid===e)return t})[0]},d.prototype.getColumnFieldNames=function(){return this.grid.getColumnFieldNames()},d.prototype.getFooterContent=function(){return this.grid.getFooterContent()},d.prototype.getFooterContentTable=function(){return this.grid.getFooterContentTable()},d.prototype.showColumns=function(e,t){this.grid.showColumns(e,t),this.updateColumnModel()},d.prototype.hideColumns=function(e,t){this.grid.hideColumns(e,t),this.updateColumnModel()},d.prototype.getColumnHeaderByField=function(e){return this.grid.getColumnHeaderByField(e)},d.prototype.getColumnHeaderByIndex=function(e){return this.grid.getColumnHeaderByIndex(e)},d.prototype.getColumnHeaderByUid=function(e){return this.grid.getColumnHeaderByUid(e)},d.prototype.getColumnIndexByField=function(e){return this.grid.getColumnIndexByField(e)},d.prototype.getVirtualColIndexByUid=function(e){var i=r.iterateArrayOrObject(this.grid.columnModel,function(t,r){if(t.uid===e)return r})[0];return t.isNullOrUndefined(i)?-1:i},d.prototype.getColumnIndexByUid=function(e){return this.grid.getColumnIndexByUid(e)},d.prototype.getColumns=function(e){return this.updateColumnModel(this.grid.getColumns(e)),this.columnModel},d.prototype.updateColumnModel=function(e){var r,i,n=t.isNullOrUndefined(e)?this.grid.getColumns():e;-1!==this.treeColumnIndex&&this.columnModel[this.treeColumnIndex]&&!t.isNullOrUndefined(this.columnModel[this.treeColumnIndex].template)&&(r=this.columnModel[this.treeColumnIndex].template,i=this.columnModel[this.treeColumnIndex].field);var o;if(!this.enableColumnVirtualization||this.enableColumnVirtualization&&this.columnModel.length===n.length){this.columnModel=[];for(l=0;l<n.length;l++){o={};for(var a=0,s=Object.keys(n[parseInt(l.toString(),10)]);a<s.length;a++){var d=s[a];o[""+d]=n[parseInt(l.toString(),10)][""+d]}this.columnModel.push(new R(o)),i!==this.columnModel[parseInt(l.toString(),10)].field||"checkbox"===this.columnModel[parseInt(l.toString(),10)].type||t.isNullOrUndefined(r)||""===r||(this.columnModel[parseInt(l.toString(),10)].template=r)}}if(this.deepMerge=["columns"],this.grid.columns.length!==this.columnModel.length&&(this.stackedHeader=!0),this.stackedHeader&&this.allowResizing)for(var l=0;l<this.columns.length;l++)if(t.isNullOrUndefined(this.columns[parseInt(l.toString(),10)].columns)){if(!t.isNullOrUndefined(this.columns[parseInt(l.toString(),10)].field)){var p=this.columns[parseInt(l.toString(),10)].field,h=this.grid.getColumnByField(p);this.columns[parseInt(l.toString(),10)].width=h.width}}else for(var c=0;c<this.columns[parseInt(l.toString(),10)].columns.length;c++){var u=this.columns[parseInt(l.toString(),10)].columns[parseInt(c.toString(),10)],h=this.grid.getColumnByField(u.field);u.width=h.width}return this.stackedHeader||t.merge(this.columns,this.columnModel),this.deepMerge=void 0,this.columnModel},d.prototype.getContent=function(){return this.grid.getContent()},d.prototype.mergePersistTreeGridData=function(){this.grid.mergePersistGridData.apply(this)},d.prototype.mergeColumns=function(e,t){this.grid.mergeColumns.apply(this,[e,t])},d.prototype.updateTreeGridModel=function(){this.setProperties({filterSettings:r.getObject("properties",this.grid.filterSettings)},!0),this.setProperties({pageSettings:r.getObject("properties",this.grid.pageSettings)},!0),this.setProperties({searchSettings:r.getObject("properties",this.grid.searchSettings)},!0),this.setProperties({sortSettings:r.getObject("properties",this.grid.sortSettings)},!0)},d.prototype.getContentTable=function(){return this.grid.getContentTable()},d.prototype.getDataRows=function(){for(var e=[],t=this.grid.getDataRows(),r=0,i=t.length;r<i;r++)t[parseInt(r.toString(),10)].classList.contains("e-summaryrow")||e.push(t[parseInt(r.toString(),10)]);return e},d.prototype.getCurrentViewRecords=function(){return this.grid.currentViewData},d.prototype.getBatchChanges=function(){return this.grid.editModule.getBatchChanges()},d.prototype.getHeaderContent=function(){return this.grid.getHeaderContent()},d.prototype.getHeaderTable=function(){return this.grid.getHeaderTable()},d.prototype.getRowByIndex=function(e){return this.grid.getRowByIndex(e)},d.prototype.getRowInfo=function(e){return this.grid.getRowInfo(e)},d.prototype.getUidByColumnField=function(e){return this.grid.getUidByColumnField(e)},d.prototype.getVisibleColumns=function(){for(var e=[],t=0,r=this.columnModel;t<r.length;t++){var i=r[t];i.visible&&e.push(i)}return e},d.prototype.showSpinner=function(){o.showSpinner(this.element)},d.prototype.hideSpinner=function(){o.hideSpinner(this.element)},d.prototype.refresh=function(){this.uniqueIDCollection={},this.convertTreeData(this.dataSource),s(this)||(this.dataSource instanceof n.DataManager?this.grid.setProperties({dataSource:new n.DataManager(this.dataSource.dataSource,this.dataSource.defaultQuery,this.dataSource.adaptor)},!0):this.grid.dataSource=this.flatData),this.grid.refresh()},d.prototype.getCheckedRecords=function(){return this.selectionModule.getCheckedrecords()},d.prototype.getVisibleRecords=function(){var e=[],t=this.getCurrentViewRecords();if(this.allowPaging)e=t;else for(var r=0;r<t.length;r++)e.push(t[parseInt(r.toString(),10)]),t[parseInt(r.toString(),10)].expanded||(r+=c(t[parseInt(r.toString(),10)]).length);return e},d.prototype.getCheckedRowIndexes=function(){return this.selectionModule.getCheckedRowIndexes()},d.prototype.selectCheckboxes=function(e){this.selectionModule.selectCheckboxes(e)},d.prototype.refreshColumns=function(e){t.isNullOrUndefined(e)||e?(this.grid.columns=this.getGridColumns(this.columns),this.grid.refreshColumns()):this.grid.setProperties({columns:this.getGridColumns(this.columns)},!0)},d.prototype.refreshHeader=function(){this.grid.refreshHeader()},d.prototype.expandCollapseRequest=function(e){if("Batch"===this.editSettings.mode){if((this.getBatchChanges()[this.changedRecords].length||this.getBatchChanges()[this.deletedRecords].length||this.getBatchChanges()[this.addedRecords].length)&&this.editSettings.showConfirmDialog){var t=this.grid.editModule.dialogObj;return this.grid.editModule.showDialog("CancelEdit",t),void(this.targetElement=e)}}if(this.rowTemplate){var r=e.closest(".e-treerowcell").parentElement,i=this.getCurrentViewRecords()[r.rowIndex];e.classList.contains("e-treegridexpand")?this.collapseRow(r,i):this.expandRow(r,i)}else{var n=this.grid.getRowInfo(e),i=n.rowData;if(this.grid.isFrozenGrid()&&this.enableVirtualization&&!Object.keys(i).length){i=this.grid.contentModule.freezeRows.filter(function(e){return e.uid===n.row.getAttribute("data-uid")})[0].data}this.enableImmutableMode&&(i=this.getCurrentViewRecords()[n.rowIndex]),e.classList.contains("e-treegridexpand")?this.collapseRow(n.row,i):this.expandRow(n.row,i)}},d.prototype.expandRow=function(e,r,i,n){var o=this;r=this.getCollapseExpandRecords(e,r),!t.isNullOrUndefined(e)&&e.cells[0].classList.contains("e-lastrowcell")&&this.lastRowBorder(e,!1);var d={data:r,row:e,cancel:!1};this.trigger("expanding",d,function(d){if(!d.cancel){o.expandCollapse("expand",e,r),d.expandAll&&o.expandCollapseAllChildren(r,"expand",i,n);if((!a(o)||u(o))&&(!s(o)||!t.isNullOrUndefined(r.Children))){var l={data:r,row:e};o.setHeightForFrozenContent(),t.isNullOrUndefined(o.expandStateMapping)||o.updateExpandStateMapping(l.data,!0),o.trigger("expanded",l)}}})},d.prototype.expandCollapseAllChildren=function(e,r,i,n){if((t.isNullOrUndefined(i)||e[this.getPrimaryKeyFieldNames()[0]]===i)&&(t.isNullOrUndefined(n)||n===e.level)){var o=c(e).filter(function(e){return e.hasChildRecords});o.unshift(e);for(var a=0;a<o.length;a++)this.expandCollapse(r,null,o[parseInt(a.toString(),10)])}},d.prototype.setHeightForFrozenContent=function(){var e=this.grid.getFrozenLeftColumnsCount()>0||this.grid.getFrozenRightColumnsCount()>0;(this.grid.getFrozenColumns()>0||e)&&this.grid.contentModule.refreshScrollOffset()},d.prototype.getCollapseExpandRecords=function(e,r){return this.allowPaging&&"All"===this.pageSettings.pageSizeMode&&this.isExpandAll&&t.isNullOrUndefined(r)&&!a(this)?r=this.flatData.filter(function(e){return e.hasChildRecords}):t.isNullOrUndefined(r)&&(r=this.detailTemplate?this.grid.getCurrentViewRecords()[e.getAttribute("data-rowindex")]:this.grid.getCurrentViewRecords()[parseInt(e.getAttribute("data-rowindex"),10)]),r},d.prototype.collapseRow=function(e,r,i){var n=this,o={data:r=this.getCollapseExpandRecords(e,r),row:e,cancel:!1};this.trigger("collapsing",o,function(o){if(!o.cancel){o.collapseAll&&n.expandCollapseAllChildren(r,"collapse",i),n.expandCollapse("collapse",e,r);var s={data:r,row:e};a(n)||(n.setHeightForFrozenContent(),t.isNullOrUndefined(n.expandStateMapping)||n.updateExpandStateMapping(s.data,!1),n.trigger("collapsed",s),n.enableInfiniteScrolling&&n.grid.getContent().firstElementChild.scrollHeight-n.grid.getContent().firstElementChild.scrollTop<n.grid.getRowHeight()+ +n.height&&n.grid.getContent().firstElementChild.scrollBy(0,n.grid.getRowHeight()))}})},d.prototype.updateExpandStateMapping=function(e,t){var r=e;if(r.length)for(var i=0;i<r.length;i++)r[parseInt(i.toString(),10)][this.expandStateMapping]=t,v({value:r[parseInt(i.toString(),10)],action:"edit"},this,this.isSelfReference,r[parseInt(i.toString(),10)].index,this.grid.selectedRowIndex,this.expandStateMapping);else e[""+this.expandStateMapping]=t,v({value:e,action:"edit"},this,this.isSelfReference,e.index,this.grid.selectedRowIndex,this.expandStateMapping)},d.prototype.expandAtLevel=function(e){if((this.allowPaging&&"All"===this.pageSettings.pageSizeMode||this.enableVirtualization)&&!a(this)){t=this.grid.dataSource.filter(function(t){return t.hasChildRecords&&t.level===e&&(t.expanded=!0),t.hasChildRecords&&t.level===e});this.expandAction(t,null,e,!0)}else{var t=this.getRecordDetails(e),i=r.getObject("records",t);this.expandAction(i,null,e)}},d.prototype.expandByKey=function(e){this.expandCollapseActionByKey(e,"Expand")},d.prototype.expandAction=function(e,r,i,n){void 0===n&&(n=!1);for(var o=this,s=0;s<e.length;s++)!function(s){if(!t.isNullOrUndefined(e[parseInt(s.toString(),10)].parentItem)){var d=e[parseInt(s.toString(),10)].parentItem.uniqueID,l=o.flatData.filter(function(e){return e.uniqueID===d});a(o)&&(l=o.getCurrentViewRecords().filter(function(e){return e.uniqueID===d})),!1===l[0].expanded?(e.push(l[0]),l[0].expanded=!0):h(o,l[0],o.parentData)||l[0].expanded&&void 0!==l[0].parentItem&&e.push(l[0])}n||o.expandRow(null,e[parseInt(s.toString(),10)],r,i)}(s);n&&this.expandRow(null,e,r,i)},d.prototype.getRecordDetails=function(e){var t=this.getRows().filter(function(t){return-1!==t.className.indexOf("level"+e)&&(t.querySelector(".e-treegridcollapse")||t.querySelector(".e-treegridexpand"))});return{records:this.getCurrentViewRecords().filter(function(t){return t.level===e&&t.hasChildRecords}),rows:t}},d.prototype.collapseAtLevel=function(e){if((this.allowPaging&&"All"===this.pageSettings.pageSizeMode||this.enableVirtualization)&&!a(this)){var t=this.grid.dataSource.filter(function(t){return t.hasChildRecords&&t.level===e&&(t.expanded=!1),t.hasChildRecords&&t.level===e});this.collapseAction(t,null,!0)}else{var i=this.getRecordDetails(e),n=r.getObject("records",i);this.collapseAction(n)}},d.prototype.collapseByKey=function(e){this.expandCollapseActionByKey(e,"Collapse")},d.prototype.expandCollapseActionByKey=function(e,r){var i=this.getPrimaryKeyFieldNames()[0],n=a(this)?this.getCurrentViewRecords():this.grid.dataSource;if(!t.isNullOrUndefined(i)){var o=n.filter(function(t){return t[""+i].toString()===e.toString()});"Expand"===r?this.expandAction(o,e,null):this.collapseAction(o,e)}},d.prototype.collapseAction=function(e,t,r){if(void 0===r&&(r=!1),r)this.collapseRow(null,e);else for(var i=0;i<e.length;i++)this.collapseRow(null,e[parseInt(i.toString(),10)],t);if(!this.grid.contentModule.isDataSourceChanged&&this.enableVirtualization&&this.getRows()&&this.parentData.length===this.getRows().length){this.grid.contentModule.startIndex=-1,this.grid.contentModule.endIndex=-1}},d.prototype.expandAll=function(){this.expandCollapseAll("expand")},d.prototype.collapseAll=function(){this.expandCollapseAll("collapse")},d.prototype.expandCollapseAll=function(e){var t=this.getRows().filter(function(t){return t.querySelector(".e-treegrid"+("expand"===e?"collapse":"expand"))});if(!t.length&&this.getRows().length&&t.push(this.getRows()[0]),this.isExpandAll=!0,this.isCollapseAll=!0,(this.allowPaging&&"All"===this.pageSettings.pageSizeMode||this.enableVirtualization||this.enableInfiniteScrolling)&&!a(this)){if(this.flatData.filter(function(t){t.hasChildRecords&&(t.expanded="collapse"!==e)}),t.length)for(i=0;i<t.length;i++)"collapse"===e?this.collapseRow(t[parseInt(i.toString(),10)]):this.expandRow(t[parseInt(i.toString(),10)]);else if(this.allowPaging){var r=this.enableCollapseAll;this.setProperties({enableCollapseAll:!0},!0),this.grid.pagerModule.goToPage(1),this.setProperties({enableCollapseAll:r},!0)}}else for(var i=0;i<t.length;i++)"collapse"===e?this.collapseRow(t[parseInt(i.toString(),10)]):this.expandRow(t[parseInt(i.toString(),10)]);this.isExpandAll=!1,this.isCollapseAll=!1},d.prototype.expandCollapse=function(e,r,i,n){var o,d=this,l={row:r,data:i,childData:[],requestType:e},p=this.getCurrentViewRecords().filter(function(e){return e.parentUniqueID===i.uniqueID});(!a(this)&&"expand"===e&&this.isSelfReference&&s(this)&&!p.length||"collapse"===e||this.isExpandAll&&this.loadChildOnDemand&&!a(this)&&this.isSelfReference&&s(this))&&this.updateChildOnDemand(l);var c=this.getRows();if(this.rowTemplate){R=this.getContentTable().rows;c=[].slice.call(R)}var g;if(t.isNullOrUndefined(r)?(g=this.getCurrentViewRecords().indexOf(i),r=c[parseInt(g.toString(),10)]):g=+r.getAttribute("data-rowindex"),t.isNullOrUndefined(r)||r.setAttribute("aria-expanded","expand"===e?"true":"false"),!(this.allowPaging&&"All"===this.pageSettings.pageSizeMode||this.enableVirtualization||this.enableInfiniteScrolling)||a(this)||s(this)){var f=void 0;if("expand"===e){if(f="table-row",n||(i.expanded=!0,this.uniqueIDCollection[i.uniqueID].expanded=i.expanded),t.isNullOrUndefined(r)||(o=r.getElementsByClassName("e-treegridcollapse")[0]),n&&!t.isNullOrUndefined(i[this.expandStateMapping])&&i[this.expandStateMapping]&&t.isNullOrUndefined(o)&&(o=r.getElementsByClassName("e-treegridexpand")[0]),t.isNullOrUndefined(o))return;o.classList.contains("e-treegridexpand")||t.addClass([o],"e-treegridexpand"),t.removeClass([o],"e-treegridcollapse")}else{if(f="none",n&&!s(this)||(i.expanded=!1,this.uniqueIDCollection[i.uniqueID].expanded=i.expanded),t.isNullOrUndefined(r)||(o=r.getElementsByClassName("e-treegridexpand")[0]),n&&!t.isNullOrUndefined(i[this.expandStateMapping])&&!i[this.expandStateMapping]&&t.isNullOrUndefined(o)&&(o=r.getElementsByClassName("e-treegridcollapse")[0]),t.isNullOrUndefined(o))return;o.classList.contains("e-treegridcollapse")||t.addClass([o],"e-treegridcollapse"),t.removeClass([o],"e-treegridexpand")}r.querySelectorAll(".e-treerowcell")[0].setAttribute("aria-expanded","expand"===e?"true":"false");var y=c.filter(function(e){return e.classList.contains("e-griddetailrowindex"+i.index+"level"+(i.level+1))});if(a(this)&&!u(this))this.remoteExpand(e,r,i);else{s(this)&&!p.length&&"collapse"!==e||this.localExpand(e,r,i);var v=this.getVisibleRecords()[this.getVisibleRecords().length-1].index,S=this.getRowByIndex(v);this.grid.getContentTable().clientHeight<=this.grid.getContent().clientHeight&&!t.isNullOrUndefined(S)&&!S.cells[0].classList.contains("e-lastrowcell")&&this.lastRowBorder(S,!0)}if(s(this)&&"expand"===e){var w=this.getCurrentViewRecords().filter(function(e){return h(d,e,d.parentData)});this.dataResults.result=w}if(!t.isNullOrUndefined(o)&&o.closest(".e-treerowcell").classList.contains("e-cellselectionbackground")&&(o.closest(".e-treerowcell").classList.remove("e-cellselectionbackground"),o.closest(".e-treerowcell").removeAttribute("aria-selected")),this.isPixelHeight()&&!r.cells[0].classList.contains("e-lastrowcell"))for(var I=this.getRows(),R=this.getContentTable().rows,C=(I=[].slice.call(R)).length-1;C>=0;C--)if(!m(I[parseInt(C.toString(),10)])){var x=this.getContentTable().scrollHeight,b=this.getContent().clientHeight;this.lastRowBorder(I[parseInt(C.toString(),10)],x<=b);break}this.notify("rowExpandCollapse",{detailrows:y,action:f,record:i,row:r}),this.updateAltRow(c)}else this.notify("localPagedExpandCollapse",{action:e,row:r,record:i})},d.prototype.updateChildOnDemand=function(e){var i=this;if("collapse"===e.requestType&&s(this)){for(var o=this.flatData.slice(),a=0;a<o.length;a++)o[parseInt(a.toString(),10)].parentUniqueID===e.data.uniqueID&&(o.splice(a,1),a-=1);return void(this.dataResults.result=o)}var d=new n.Deferred;e.childDataBind=d.resolve;var l=e.data;this.trigger("dataStateChange",e),d.promise.then(function(){if(e.childData.length){s(i)&&(i.flatData=i.dataResults.result),i.enableInfiniteScrolling&&s(i)&&(i.flatData=i.infiniteScrollData);for(var n=i.flatData,o=0,a=0;a<n.length;a++)if(n[parseInt(a.toString(),10)].taskData===l.taskData){o=a;break}for(var d=t.getValue("result",i.dataSource),p=g(e.childData),h=l[i.childMapping]&&l[i.childMapping].length>p.length?l[i.childMapping].length:p.length,a=0;a<h;a++)l[i.childMapping]&&d.filter(function(e,t){e[i.parentIdMapping]===l[i.idMapping]&&d.splice(t,1)}),p[parseInt(a.toString(),10)]?(p[parseInt(a.toString(),10)].level=l.level+1,p[parseInt(a.toString(),10)].index=Math.ceil(1e3*Math.random()),p[parseInt(a.toString(),10)].parentItem=t.extend({},l),p[parseInt(a.toString(),10)].taskData=t.extend({},p[parseInt(a.toString(),10)]),delete p[parseInt(a.toString(),10)].parentItem.childRecords,delete p[parseInt(a.toString(),10)].taskData.parentItem,p[parseInt(a.toString(),10)].parentUniqueID=l.uniqueID,p[parseInt(a.toString(),10)].uniqueID=r.getUid(i.element.id+"_data_"),t.setValue("uniqueIDCollection."+p[parseInt(a.toString(),10)].uniqueID,p[parseInt(a.toString(),10)],i),(!t.isNullOrUndefined(p[parseInt(a.toString(),10)][i.childMapping])||p[parseInt(a.toString(),10)][i.hasChildMapping]&&s(i))&&(p[parseInt(a.toString(),10)].hasChildRecords=!0),s(i)&&l[i.childMapping]&&l[i.childMapping][parseInt(a.toString(),10)]?n.splice(o+1+a,0,p[parseInt(a.toString(),10)]):n.splice(o+1+a,l[i.childMapping]&&l[i.childMapping][parseInt(a.toString(),10)]?1:0,p[parseInt(a.toString(),10)])):n.splice(o+1+a,1);n[parseInt(o.toString(),10)][""+i.childMapping]=p,n[parseInt(o.toString(),10)].childRecords=p,n[parseInt(o.toString(),10)].expanded=!0,t.setValue("uniqueIDCollection."+n[parseInt(o.toString(),10)].uniqueID,n[parseInt(o.toString(),10)],i);for(var c=0;c<e.childData.length;c++)d.push(e.childData[parseInt(c.toString(),10)])}s(i)&&i.loadChildOnDemand&&"expand"===e.requestType&&(i.dataResults.expandRecord={},i.dataResults.expandRecord=e.data),i.isExpandRefresh=!0;var u=i.getContentTable().parentElement.scrollTop;i.grid.refresh(),i.setHeightForFrozenContent(),i.enableInfiniteScrolling&&(i.getContentTable().parentElement.scrollTop=u),i.trigger("expanded",e)})},d.prototype.remoteExpand=function(e,t,r){var i=this.getRows();if(this.rowTemplate){var n=this.getContentTable().rows;i=[].slice.call(n)}var o={data:r,row:t},a=[];if(a=i.filter(function(e){return e.querySelector(".e-gridrowindex"+r.index+"level"+(r.level+1))||e.querySelector(".e-gridrowindex"+r.index+"level0.e-summarycell")}),"expand"===e){this.notify("remoteExpand",{record:r,rows:a,parentRow:t});var s={row:t,data:r};a.length>0&&(this.setHeightForFrozenContent(),this.trigger("expanded",s))}else"collapse"===e&&this.enableVirtualization?this.dataModule.fetchRemoteChildData({action:e,record:o.data,rows:null,parentRow:o.row}):(this.collapseRemoteChild({record:r,rows:a}),this.setHeightForFrozenContent(),this.trigger("collapsed",o))},d.prototype.localExpand=function(e,r,i){var n,o=this.getCurrentViewRecords().filter(function(e){return e.parentUniqueID===i.uniqueID});this.isPixelHeight()&&r.cells[0].classList.contains("e-lastrowcell")&&this.lastRowBorder(r,!1);var d,l,p=this.getRows();if(this.rowTemplate){var h=this.getContentTable().rows;p=[].slice.call(h)}var c="expand"===e?"table-row":"none",u=this.getPrimaryKeyFieldNames()[0];if(this.enableImmutableMode&&!this.allowPaging){n=[];for(I=0;I<o.length;I++){var g=this.grid.getRowIndexByPrimaryKey(o[parseInt(I.toString(),10)][""+u]);n.push(this.getRows()[parseInt(g.toString(),10)])}}else n=p.filter(function(e){return e.querySelector(".e-gridrowindex"+i.index+"level"+(i.level+1))});var f=this.grid.getFrozenLeftColumnsCount()>0||this.grid.getFrozenRightColumnsCount()>0;(this.frozenRows||this.frozenColumns||this.getFrozenColumns()||f)&&(d=this.getMovableRows().filter(function(e){return e.querySelector(".e-gridrowindex"+i.index+"level"+(i.level+1))})),f&&(l=this.getFrozenRightRows().filter(function(e){return e.querySelector(".e-gridrowindex"+i.index+"level"+(i.level+1))}));var y=this.grid.getRowsObject(),m=this.getCurrentViewRecords(),v=m.filter(function(e){return e.uniqueID===i.uniqueID}),S=m.indexOf(v[0]);t.isNullOrUndefined(y[parseInt(S.toString(),10)].visible)||!1===y[parseInt(S.toString(),10)].visible||(y[parseInt(S.toString(),10)].visible=!0);for(var w=p.filter(function(e){return e.classList.contains("e-griddetailrowindex"+i.index+"level"+(i.level+1))}),I=0;I<n.length;I++){if(t.isNullOrUndefined(n[parseInt(I.toString(),10)])||(n[parseInt(I.toString(),10)].style.display=c),!t.isNullOrUndefined(n[parseInt(I.toString(),10)])&&!this.allowPaging&&!(this.enableVirtualization||this.enableInfiniteScrolling||a(this)||s(this))){y[n[parseInt(I.toString(),10)].rowIndex].visible="none"!==c;var R=m.filter(function(e){return e.uniqueID===v[0].parentUniqueID});!t.isNullOrUndefined(R[0])&&p[m.indexOf(R[0])].getElementsByClassName("e-treegridcollapse").length&&(y[parseInt(S.toString(),10)].visible=!1)}t.isNullOrUndefined(d)||(d[parseInt(I.toString(),10)].style.display=c),t.isNullOrUndefined(l)||(l[parseInt(I.toString(),10)].style.display=c),this.notify("childRowExpand",{row:n[parseInt(I.toString(),10)]}),!t.isNullOrUndefined(o[parseInt(I.toString(),10)].childRecords)&&o[parseInt(I.toString(),10)].childRecords.length>0&&("expand"!==e||t.isNullOrUndefined(o[parseInt(I.toString(),10)].expanded)||o[parseInt(I.toString(),10)].expanded)&&(this.expandCollapse(e,n[parseInt(I.toString(),10)],o[parseInt(I.toString(),10)],!0),this.frozenColumns<=this.treeColumnIndex&&!t.isNullOrUndefined(d)&&this.expandCollapse(e,d[parseInt(I.toString(),10)],o[parseInt(I.toString(),10)],!0))}for(I=0;I<w.length;I++)t.isNullOrUndefined(w[parseInt(I.toString(),10)])||this.allowPaging||this.enableVirtualization||this.enableInfiniteScrolling||a(this)||s(this)||(y[w[parseInt(I.toString(),10)].rowIndex].visible="none"!==c,w[parseInt(I.toString(),10)].style.display=c);this.allowPaging||this.enableVirtualization||this.enableInfiniteScrolling||a(this)||s(this)||this.grid.notify("refresh-Expand-and-Collapse",{rows:this.grid.getRowsObject()})},d.prototype.updateAltRow=function(e){if(this.enableAltRow&&!this.rowTemplate)for(var r=0,i=0;e&&i<e.length;i++){var n=e[parseInt(i.toString(),10)];"none"!==n.style.display&&(n.classList.contains("e-altrow")&&t.removeClass([n],"e-altrow"),r%2==0||n.classList.contains("e-summaryrow")||n.classList.contains("e-detailrow")||t.addClass([n],"e-altrow"),n.classList.contains("e-summaryrow")||n.classList.contains("e-detailrow")||r++)}},d.prototype.treeColumnRowTemplate=function(){var e=this.getContentTable().rows;e=[].slice.call(e);for(var t=0;t<e.length;t++){var r=this.grid.getContentTable().rows[parseInt(t.toString(),10)].cells[this.treeColumnIndex],i=e[parseInt(t.toString(),10)],n={data:this.grid.getRowsObject()[parseInt(t.toString(),10)].data,row:i,cell:r,column:this.getColumns()[this.treeColumnIndex]};this.renderModule.cellRender(n)}},d.prototype.collapseRemoteChild=function(e,r){r||(e.record.expanded=!1);var i,n,o=e.rows,a=[],s=[],d=this.getFrozenLeftColumnsCount()>0||this.getFrozenRightColumnsCount()>0;d&&(a=this.getMovableRows().filter(function(t){return t.querySelector(".e-gridrowindex"+e.record.index+"level"+(e.record.level+1))}),s=this.getFrozenRightRows().filter(function(t){return t.querySelector(".e-gridrowindex"+e.record.index+"level"+(e.record.level+1))}));for(var l=0;l<o.length;l++){o[parseInt(l.toString(),10)].style.display="none",i=o[parseInt(l.toString(),10)];var p=o[parseInt(l.toString(),10)].querySelector(".e-detailrowexpand");if(t.isNullOrUndefined(p)||this.grid.detailRowModule.collapse(p),d&&(a[parseInt(l.toString(),10)].style.display="none",s[parseInt(l.toString(),10)].style.display="none",o[parseInt(l.toString(),10)].querySelector(".e-treecolumn-container .e-treegridexpand")||(a[parseInt(l.toString(),10)].querySelector(".e-treecolumn-container .e-treegridexpand")?i=a[parseInt(l.toString(),10)]:s[parseInt(l.toString(),10)].querySelector(".e-treecolumn-container .e-treegridexpand")&&(i=s[parseInt(l.toString(),10)]))),i.querySelector(".e-treecolumn-container .e-treegridexpand")){var h=i.querySelector(".e-treecolumn-container .e-treegridexpand");n=this.rowTemplate?this.grid.getCurrentViewRecords()[o[parseInt(l.toString(),10)].rowIndex]:this.grid.getRowObjectFromUID(o[parseInt(l.toString(),10)].getAttribute("data-Uid")).data,!t.isNullOrUndefined(h)&&n.expanded&&(t.removeClass([h],"e-treegridexpand"),t.addClass([h],"e-treegridcollapse"));for(var c=[],u=this.getRows(),g=0;g<u.length;g++)u[parseInt(g.toString(),10)].querySelector(".e-gridrowindex"+n.index+"level"+(n.level+1))&&c.push(u[parseInt(g.toString(),10)]);c.length&&n.expanded&&this.collapseRemoteChild({record:n,rows:c},!0)}}},d.prototype.sanitize=function(e){return this.enableHtmlSanitizer&&"string"==typeof e?t.SanitizeHtmlHelper.sanitize(e):e},d.prototype.updateRowAndCellElements=function(e,t,r){for(var i=0;i<e.length;i++)this.renderModule.cellRender({data:e[parseInt(i.toString(),10)],cell:t[parseInt(i.toString(),10)].cells[parseInt(r.toString(),10)],column:this.grid.getColumns()[this.treeColumnIndex],requestType:"rowDragAndDrop"}),"indenting"!==this.action&&"outdenting"!==this.action||this.renderModule.RowModifier({data:e[parseInt(i.toString(),10)],row:t[parseInt(i.toString(),10)]})},d.prototype.addListener=function(){this.on("updateResults",this.updateResultModel,this),this.grid.on("initial-end",this.afterGridRender,this)},d.prototype.updateResultModel=function(e){this.dataResults=e},d.prototype.removeListener=function(){this.isDestroyed||(this.off("updateResults",this.updateResultModel),this.grid.off("initial-end",this.afterGridRender))},d.prototype.filterByColumn=function(e,t,r,i,n,o,a,s){this.grid.filterByColumn(e,t,r,i,n,o,a,s)},d.prototype.clearFiltering=function(){this.grid.clearFiltering()},d.prototype.removeFilteredColsByField=function(e,t){this.grid.removeFilteredColsByField(e,t)},d.prototype.selectRow=function(e,t){this.grid.selectRow(e,t)},d.prototype.selectRows=function(e){this.grid.selectRows(e)},d.prototype.clearSelection=function(){this.grid.clearSelection()},d.prototype.copy=function(e){this.clipboardModule.copy(e)},d.prototype.paste=function(e,t,r){this.clipboardModule.paste(e,t,r)},d.prototype.selectCell=function(e,t){this.grid.selectCell(e,t)},d.prototype.getSelectedRows=function(){return this.grid.getSelectedRows()},d.prototype.getMovableCellFromIndex=function(e,t){return this.grid.getMovableCellFromIndex(e,t)},d.prototype.getMovableDataRows=function(){return this.grid.getMovableDataRows()},d.prototype.getMovableRowByIndex=function(e){return this.grid.getMovableRowByIndex(e)},d.prototype.getMovableRows=function(){return this.grid.getMovableRows()},d.prototype.getFrozenRightRowByIndex=function(e){return this.grid.getFrozenRightRowByIndex(e)},d.prototype.getFrozenRightRows=function(){return this.grid.getFrozenRightRows()},d.prototype.getFrozenRightDataRows=function(){return this.grid.getFrozenRightDataRows()},d.prototype.getFrozenRightCellFromIndex=function(e,t){return this.grid.getFrozenRightCellFromIndex(e,t)},d.prototype.getFrozenLeftColumnHeaderByIndex=function(e){return this.grid.getFrozenLeftColumnHeaderByIndex(e)},d.prototype.getFrozenRightColumnHeaderByIndex=function(e){return this.grid.getFrozenRightColumnHeaderByIndex(e)},d.prototype.getMovableColumnHeaderByIndex=function(e){return this.grid.getMovableColumnHeaderByIndex(e)},d.prototype.getMovableColumnsCount=function(){return this.grid.getMovableColumnsCount()},d.prototype.getFrozenLeftColumnsCount=function(){return this.grid.getFrozenLeftColumnsCount()},d.prototype.getFrozenRightColumnsCount=function(){return this.grid.getFrozenRightColumnsCount()},d.prototype.getFrozenLeftColumns=function(){return this.updateColumnModel(this.grid.getFrozenLeftColumns()),this.columnModel},d.prototype.getFrozenRightColumns=function(){return this.updateColumnModel(this.grid.getFrozenRightColumns()),this.columnModel},d.prototype.getVisibleMovableCount=function(){return this.grid.getVisibleMovableCount()},d.prototype.getVisibleFrozenRightCount=function(){return this.grid.getVisibleFrozenRightCount()},d.prototype.getVisibleFrozenLeftCount=function(){return this.grid.getVisibleFrozenLeftCount()},d.prototype.getMovableColumns=function(){return this.updateColumnModel(this.grid.getMovableColumns()),this.columnModel},d.prototype.getFrozenColumns=function(){return this.getFrozenCount(this.columns,0)+this.frozenColumns},d.prototype.getFrozenCount=function(e,t){for(var r=0,i=e.length;r<i;r++)e[parseInt(r.toString(),10)].columns?t=this.getFrozenCount(e[parseInt(r.toString(),10)].columns,t):e[parseInt(r.toString(),10)].isFrozen&&t++;return t},d.prototype.getSelectedRowIndexes=function(){return this.grid.getSelectedRowIndexes()},d.prototype.getSelectedRowCellIndexes=function(){return this.grid.getSelectedRowCellIndexes()},d.prototype.getSelectedRecords=function(){return this.grid.getSelectedRecords()},d.prototype.getDataModule=function(){return{baseModule:this.grid.getDataModule(),treeModule:this.dataModule}},d.prototype.reorderRows=function(e,t,r){this.rowDragAndDropModule.reorderRows(e,t,r)},d.prototype.indent=function(e){t.isNullOrUndefined(this.rowDragAndDropModule)||(e=e,this.rowDragAndDropModule[this.indentOutdentAction](e,"indent"))},d.prototype.outdent=function(e){t.isNullOrUndefined(this.rowDragAndDropModule)||(e=e,this.rowDragAndDropModule[this.indentOutdentAction](e,"outdent"))};var l;return fe([t.Property(0)],d.prototype,"frozenRows",void 0),fe([t.Property(0)],d.prototype,"frozenColumns",void 0),fe([t.Property("Ellipsis")],d.prototype,"clipMode",void 0),fe([t.Property([])],d.prototype,"columns",void 0),fe([t.Property(null)],d.prototype,"childMapping",void 0),fe([t.Property(null)],d.prototype,"hasChildMapping",void 0),fe([t.Property(0)],d.prototype,"treeColumnIndex",void 0),fe([t.Property(null)],d.prototype,"idMapping",void 0),fe([t.Property(null)],d.prototype,"parentIdMapping",void 0),fe([t.Property(!1)],d.prototype,"enableCollapseAll",void 0),fe([t.Property(null)],d.prototype,"expandStateMapping",void 0),fe([t.Property(!1)],d.prototype,"allowRowDragAndDrop",void 0),fe([t.Property([])],d.prototype,"dataSource",void 0),fe([t.Property()],d.prototype,"query",void 0),fe([t.Property()],d.prototype,"cloneQuery",void 0),fe([t.Property("AllPages")],d.prototype,"printMode",void 0),fe([t.Property(!1)],d.prototype,"allowPaging",void 0),fe([t.Property(!1)],d.prototype,"loadChildOnDemand",void 0),fe([t.Property(!1)],d.prototype,"allowTextWrap",void 0),fe([t.Complex({},N)],d.prototype,"textWrapSettings",void 0),fe([t.Property(!1)],d.prototype,"allowReordering",void 0),fe([t.Property(!1)],d.prototype,"allowResizing",void 0),fe([t.Property(!1)],d.prototype,"autoCheckHierarchy",void 0),fe([t.Complex({},Z)],d.prototype,"pageSettings",void 0),fe([t.Complex({},r.RowDropSettings)],d.prototype,"rowDropSettings",void 0),fe([t.Property()],d.prototype,"pagerTemplate",void 0),fe([t.Property(!1)],d.prototype,"showColumnMenu",void 0),fe([t.Property(!1)],d.prototype,"showColumnChooser",void 0),fe([t.Property(!1)],d.prototype,"allowSorting",void 0),fe([t.Property(!0)],d.prototype,"allowMultiSorting",void 0),fe([t.Complex({},pe)],d.prototype,"sortSettings",void 0),fe([t.Collection([],ie)],d.prototype,"aggregates",void 0),fe([t.Complex({},ae)],d.prototype,"editSettings",void 0),fe([t.Property(!1)],d.prototype,"allowFiltering",void 0),fe([t.Property()],d.prototype,"detailTemplate",void 0),fe([t.Complex({},P)],d.prototype,"filterSettings",void 0),fe([t.Complex({},G)],d.prototype,"searchSettings",void 0),fe([t.Property()],d.prototype,"toolbar",void 0),fe([t.Property()],d.prototype,"toolbarTemplate",void 0),fe([t.Property("Default")],d.prototype,"gridLines",void 0),fe([t.Property()],d.prototype,"contextMenuItems",void 0),fe([t.Property()],d.prototype,"columnMenuItems",void 0),fe([t.Property()],d.prototype,"rowTemplate",void 0),fe([t.Property("Parent")],d.prototype,"copyHierarchyMode",void 0),fe([t.Property(null)],d.prototype,"rowHeight",void 0),fe([t.Property(!0)],d.prototype,"enableAltRow",void 0),fe([t.Property(!0)],d.prototype,"allowKeyboard",void 0),fe([t.Property(!1)],d.prototype,"enableHover",void 0),fe([t.Property(!1)],d.prototype,"enableAutoFill",void 0),fe([t.Property(!1)],d.prototype,"enableAdaptiveUI",void 0),fe([t.Property(!1)],d.prototype,"enableImmutableMode",void 0),fe([t.Property("auto")],d.prototype,"height",void 0),fe([t.Property("auto")],d.prototype,"width",void 0),fe([t.Complex({},b)],d.prototype,"loadingIndicator",void 0),fe([t.Property(!0)],d.prototype,"enableVirtualMaskRow",void 0),fe([t.Property(!1)],d.prototype,"enableVirtualization",void 0),fe([t.Property(!1)],d.prototype,"enableColumnVirtualization",void 0),fe([t.Property(!1)],d.prototype,"enableHtmlSanitizer",void 0),fe([t.Property(!1)],d.prototype,"enableInfiniteScrolling",void 0),fe([t.Complex({},ue)],d.prototype,"infiniteScrollSettings",void 0),fe([t.Property("All")],d.prototype,"columnQueryMode",void 0),fe([t.Event()],d.prototype,"created",void 0),fe([t.Event()],d.prototype,"load",void 0),fe([t.Event()],d.prototype,"expanding",void 0),fe([t.Event()],d.prototype,"expanded",void 0),fe([t.Event()],d.prototype,"collapsing",void 0),fe([t.Event()],d.prototype,"collapsed",void 0),fe([t.Event()],d.prototype,"cellSave",void 0),fe([t.Event()],d.prototype,"cellSaved",void 0),fe([t.Event()],d.prototype,"actionBegin",void 0),fe([t.Event()],d.prototype,"actionComplete",void 0),fe([t.Event()],d.prototype,"beginEdit",void 0),fe([t.Event()],d.prototype,"batchAdd",void 0),fe([t.Event()],d.prototype,"batchDelete",void 0),fe([t.Event()],d.prototype,"batchCancel",void 0),fe([t.Event()],d.prototype,"beforeBatchAdd",void 0),fe([t.Event()],d.prototype,"beforeBatchDelete",void 0),fe([t.Event()],d.prototype,"beforeBatchSave",void 0),fe([t.Event()],d.prototype,"cellEdit",void 0),fe([t.Event()],d.prototype,"actionFailure",void 0),fe([t.Event()],d.prototype,"dataBound",void 0),fe([t.Event()],d.prototype,"dataSourceChanged",void 0),fe([t.Event()],d.prototype,"dataStateChange",void 0),fe([t.Event()],d.prototype,"recordDoubleClick",void 0),fe([t.Event()],d.prototype,"rowDataBound",void 0),fe([t.Event()],d.prototype,"detailDataBound",void 0),fe([t.Event()],d.prototype,"queryCellInfo",void 0),fe([t.Property(!0)],d.prototype,"allowSelection",void 0),fe([t.Event()],d.prototype,"rowSelecting",void 0),fe([t.Event()],d.prototype,"rowSelected",void 0),fe([t.Event()],d.prototype,"rowDeselecting",void 0),fe([t.Event()],d.prototype,"rowDeselected",void 0),fe([t.Event()],d.prototype,"headerCellInfo",void 0),fe([t.Event()],d.prototype,"cellSelecting",void 0),fe([t.Event()],d.prototype,"columnMenuOpen",void 0),fe([t.Event()],d.prototype,"columnMenuClick",void 0),fe([t.Event()],d.prototype,"cellSelected",void 0),fe([t.Event()],d.prototype,"cellDeselecting",void 0),fe([t.Event()],d.prototype,"cellDeselected",void 0),fe([t.Event()],d.prototype,"resizeStart",void 0),fe([t.Event()],d.prototype,"resizing",void 0),fe([t.Event()],d.prototype,"resizeStop",void 0),fe([t.Event()],d.prototype,"columnDragStart",void 0),fe([t.Event()],d.prototype,"columnDrag",void 0),fe([t.Event()],d.prototype,"columnDrop",void 0),fe([t.Event()],d.prototype,"checkboxChange",void 0),fe([t.Event()],d.prototype,"printComplete",void 0),fe([t.Event()],d.prototype,"beforePrint",void 0),fe([t.Event()],d.prototype,"toolbarClick",void 0),fe([t.Event()],d.prototype,"beforeDataBound",void 0),fe([t.Event()],d.prototype,"contextMenuOpen",void 0),fe([t.Event()],d.prototype,"contextMenuClick",void 0),fe([t.Event()],d.prototype,"beforeCopy",void 0),fe([t.Event()],d.prototype,"beforePaste",void 0),fe([t.Event()],d.prototype,"rowDrag",void 0),fe([t.Event()],d.prototype,"rowDragStart",void 0),fe([t.Event()],d.prototype,"rowDragStartHelper",void 0),fe([t.Event()],d.prototype,"rowDrop",void 0),fe([t.Property(-1)],d.prototype,"selectedRowIndex",void 0),fe([t.Complex({},W)],d.prototype,"selectionSettings",void 0),fe([t.Property(!1)],d.prototype,"allowExcelExport",void 0),fe([t.Property(!1)],d.prototype,"allowPdfExport",void 0),fe([t.Event()],d.prototype,"pdfQueryCellInfo",void 0),fe([t.Event()],d.prototype,"pdfHeaderQueryCellInfo",void 0),fe([t.Event()],d.prototype,"excelQueryCellInfo",void 0),fe([t.Event()],d.prototype,"excelHeaderQueryCellInfo",void 0),fe([t.Event()],d.prototype,"beforeExcelExport",void 0),fe([t.Event()],d.prototype,"excelExportComplete",void 0),fe([t.Event()],d.prototype,"beforePdfExport",void 0),fe([t.Event()],d.prototype,"pdfExportComplete",void 0),d=l=fe([t.NotifyPropertyChanges],d)}(t.Component),me=function(){function e(e){r.Grid.Inject(r.Reorder),this.parent=e,this.addEventListener()}return e.prototype.getModuleName=function(){return"reorder"},e.prototype.addEventListener=function(){this.parent.on("getColumnIndex",this.getTreeColumn,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off("getColumnIndex",this.getTreeColumn)},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.getTreeColumn=function(){for(var e,t=this.parent.columnModel[this.parent.treeColumnIndex],i=this.parent.getColumns(),n=0;n<i.length;n++)if(r.getObject("field",t)===r.getObject("field",i[parseInt(n.toString(),10)])){e=n;break}this.parent.setProperties({treeColumnIndex:e},!0)},e}(),ve=function(){function e(e){r.Grid.Inject(r.Resize),this.parent=e}return e.prototype.autoFitColumns=function(e){this.parent.grid.autoFitColumns(e)},e.prototype.getModuleName=function(){return"resize"},e.prototype.destroy=function(){this.parent.isDestroyed||this.parent.grid.resizeModule.destroy()},e}(),Se=function(){function e(e){this.canDrop=!0,this.isDraggedWithChild=!1,this.modifiedRecords="modifiedRecords",this.selectedRecords="selectedRecords",this.selectedRows="selectedRows",this.hasDropItem=!0,this.isaddtoBottom=!1,r.Grid.Inject(r.RowDD),this.parent=e,this.addEventListener()}return e.prototype.getChildrecordsByParentID=function(e){return(this.parent.dataSource instanceof n.DataManager&&u(this.parent)?this.parent.grid.dataSource.dataSource.json:this.parent.grid.dataSource).filter(function(t){return t.uniqueID===e})},e.prototype.addEventListener=function(){this.parent.on("row-draging",this.Rowdraging,this),this.parent.on("row-dropped",this.rowDropped,this),this.parent.on("rows-add",this.rowsAdded,this),this.parent.on("rows-remove",this.rowsRemoved,this)},e.prototype.reorderRows=function(e,r,i){var n=this.parent;if(e[0]!==r&&-1!==["above","below","child"].indexOf(i)){"above"===i&&(this.dropPosition="topSegment"),"below"===i&&(this.dropPosition="bottomSegment"),"child"===i&&(this.dropPosition="middleSegment"),this.parent.dropPosition=this.dropPosition;for(var o=[],a=0;a<e.length;a++){g=this.parent.getRowByIndex(e[parseInt(a.toString(),10)]).rowIndex;o[parseInt(a.toString(),10)]=this.parent.getCurrentViewRecords()[parseInt(g.toString(),10)]}var d={data:o,dropIndex:r};if(s(this.parent)||this.dropRows(d,!0),n.isLocalData&&(n.flatData=this.orderToIndex(n.flatData)),"outdenting"===this.parent.action&&(t.isNullOrUndefined(o[0].parentItem)||(o[0].level=o[0].parentItem.level+1)),this.parent.grid.refresh(),this.parent.enableImmutableMode&&"middleSegment"===this.dropPosition){g=void 0;this.parent.allowRowDragAndDrop?g=this.parent.treeColumnIndex+1:"indenting"===this.parent.action&&(g=this.parent.treeColumnIndex);var l=this.parent.getRows()[e[0]],p=d.data[0],h=[];(m=[]).push(p),h.push(l);var c=y(this.parent,d.data[0].parentUniqueID),u=this.parent.getRows()[parseInt(r.toString(),10)];m.push(c),h.push(u),this.parent.updateRowAndCellElements(m,h,g)}if(this.parent.enableImmutableMode&&"outdenting"===this.parent.action){var g=void 0;this.parent.allowRowDragAndDrop?g=this.parent.treeColumnIndex+1:"outdenting"===this.parent.action&&(g=this.parent.treeColumnIndex);var f=d.data[0],l=this.parent.getRows()[e[0]],m=[],h=[];m.push(f),h.push(l),this.parent.updateRowAndCellElements(m,h,g)}}},e.prototype.indentOutdentAction=function(e,r){var i=this.parent,n=-1;if(!t.isNullOrUndefined(e)||-1!==this.parent.selectedRowIndex){this.parent.enableVirtualization&&-1!==this.parent.selectedRowIndex?n=this.parent.getSelectedRows()[0].rowIndex:-1!==this.parent.selectedRowIndex&&(n=this.parent.selectedRowIndex),this.selectedItem=t.isNullOrUndefined(e)?i.getCurrentViewRecords()[parseInt(n.toString(),10)]:e;var o=this.parent.getPrimaryKeyFieldNames()[0],a=this.parent.grid.getRowIndexByPrimaryKey(this.selectedItem[""+o]);if(this.selectedRow=this.parent[this.selectedRows]=-1!==n?this.parent.getSelectedRows()[0]:this.parent.grid.getRowByIndex(a),this.selectedRecord=this.parent[this.selectedRecords]=-1!==n?i.getCurrentViewRecords()[parseInt(n.toString(),10)]:this.selectedItem,"indent"===r){var s=i.getCurrentViewRecords()[this.selectedRow.rowIndex-1],d=void 0;if(0===this.selectedRow.rowIndex||-1===this.selectedRow.rowIndex||i.getCurrentViewRecords()[this.selectedRow.rowIndex].level-s.level==1)return;if(s.level>this.selectedRecord.level)for(p=0;p<i.getCurrentViewRecords().length;p++)i.getCurrentViewRecords()[parseInt(p.toString(),10)].taskData===s.parentItem.taskData&&(d=p,i.enableVirtualization&&(d=parseInt(i.getRows()[parseInt(p.toString(),10)].getAttribute("data-rowindex"),10)));else d=this.selectedRow.rowIndex-1;!this.parent.enableVirtualization||!this.selectedRecord||s.level>this.selectedRecord.level||(d=parseInt(this.selectedRow.getAttribute("data-rowindex"),10)-1),i.action="indenting",i.dropIndex=d,this.eventTrigger("indenting",d)}else if("outdent"===r){if(-1===this.selectedRow.rowIndex||0===this.selectedRow.rowIndex||0===i.getCurrentViewRecords()[this.selectedRow.rowIndex].level)return;for(var d=void 0,l=this.selectedRecord.parentItem,p=0;p<i.getCurrentViewRecords().length;p++)i.getCurrentViewRecords()[parseInt(p.toString(),10)].uniqueID===l.uniqueID&&(d=p);this.parent.enableVirtualization&&this.selectedRecord&&(d=parseInt(this.parent.getRows()[parseInt(d.toString(),10)].getAttribute("data-rowindex"),10)),i.action="outdenting",i.dropIndex=d,this.eventTrigger("outdenting",d)}}},e.prototype.eventTrigger=function(e,t){var r=this,i={action:e,cancel:!1,data:[this.parent[this.selectedRecords]],row:this.parent[this.selectedRows]};this.parent.trigger("actionBegin",i,function(e){e.cancel||("indenting"===e.action?r.parent.enableVirtualization?r.reorderRows([parseInt(r.selectedRow.getAttribute("data-rowindex"),10)],t,"child"):r.reorderRows([r.selectedRow.rowIndex],t,"child"):"outdenting"===e.action&&(r.parent.enableVirtualization?r.reorderRows([parseInt(r.selectedRow.getAttribute("data-rowindex"),10)],t,"below"):r.reorderRows([r.selectedRow.rowIndex],t,"below")))})},e.prototype.orderToIndex=function(e){for(var r=0;r<e.length;r++)if(e[parseInt(r.toString(),10)].index=r,!t.isNullOrUndefined(e[parseInt(r.toString(),10)].parentItem)){var i=t.getValue("uniqueIDCollection."+e[parseInt(r.toString(),10)].parentUniqueID,this.parent);e[parseInt(r.toString(),10)].parentItem.index=i.index}return e},e.prototype.rowsAdded=function(e){for(var r,i=e.records,o=e.records.length-1;o>-1;o--)if((r=i[parseInt(o.toString(),10)]).parentUniqueID){var a=i.filter(function(e){return e.uniqueID===r.parentUniqueID});if(a.length){var s=a[0].childRecords.indexOf(r),d=a[0];-1!==s&&(t.isNullOrUndefined(this.parent.idMapping)&&(d.childRecords.splice(s,1),d.childRecords.length||(d.hasChildRecords=!1,d.hasFilteredChildRecords=!1)),this.isDraggedWithChild=!0)}}if(t.isNullOrUndefined(this.parent.dataSource)||!this.parent.dataSource.length){for(var l,p=this.parent,h=e.records,o=e.records.length-1;o>-1;o--){l=h[parseInt(o.toString(),10)],!o&&l.hasChildRecords&&(l.taskData[this.parent.parentIdMapping]=null);if(t.isNullOrUndefined(p.parentIdMapping)||(p.childMapping=null),t.isNullOrUndefined(l.taskData)||t.isNullOrUndefined(p.childMapping)||Object.prototype.hasOwnProperty.call(l.taskData,p.childMapping)||(l.taskData[p.childMapping]=[]),Object.prototype.hasOwnProperty.call(l,p.childMapping)&&l[p.childMapping].length&&!this.isDraggedWithChild&&!t.isNullOrUndefined(p.parentIdMapping))for(var c=l[p.childMapping],u=0;u<c.length;u++)-1===h.indexOf(c[parseInt(u.toString(),10)])&&(h.splice(u,0,c[parseInt(u.toString(),10)]),c[parseInt(u.toString(),10)].taskData=t.extend({},c[parseInt(u.toString(),10)]),o+=1);Object.prototype.hasOwnProperty.call(l,p.parentIdMapping)&&null!==l[p.parentIdMapping]&&!this.isDraggedWithChild&&(l.taskData[p.parentIdMapping]=null,delete l.parentItem,delete l.parentUniqueID),t.isNullOrUndefined(p.dataSource)&&(p.dataSource=[]),p.dataSource.splice(0,0,l.taskData)}p.setProperties({dataSource:p.dataSource},!1)}else{for(o=0;o<i.length;o++)t.setValue("uniqueIDCollection."+i[parseInt(o.toString(),10)].uniqueID,i[parseInt(o.toString(),10)],this.parent);var g={data:e.records,dropIndex:e.toIndex};this.parent.dataSource instanceof n.DataManager?(this.treeGridData=this.parent.dataSource.dataSource.json,this.treeData=this.parent.dataSource.dataSource.json):(this.treeGridData=this.parent.grid.dataSource,this.treeData=this.parent.dataSource),t.isNullOrUndefined(this.dropPosition)&&(this.dropPosition="bottomSegment",g.dropIndex=this.parent.getCurrentViewRecords().length>1?this.parent.getCurrentViewRecords().length-1:g.dropIndex,g.data=g.data.map(function(e){return e.hasChildRecords&&t.isNullOrUndefined(e.parentItem)?(e.level=0,e):(delete e.parentItem,delete e.parentUniqueID,e.level=0,e)})),this.dropRows(g)}},e.prototype.rowsRemoved=function(e){for(var t=0;t<e.records.length;t++)this.draggedRecord=e.records[parseInt(t.toString(),10)],(this.draggedRecord.hasChildRecords||this.draggedRecord.parentItem&&-1!==this.parent.grid.dataSource.indexOf(this.getChildrecordsByParentID(this.draggedRecord.parentUniqueID)[0])||0===this.draggedRecord.level)&&this.deleteDragRow()},e.prototype.refreshGridDataSource=function(){var e,r,i=this.draggedRecord,o=this.droppedRecord,a=this.parent;if(!(e=this.parent.dataSource instanceof n.DataManager&&u(this.parent)?a.dataSource.dataSource.json:a.dataSource)||t.isNullOrUndefined(o)||o.parentItem||t.isNullOrUndefined(o.taskData)){if(!this.parent.parentIdMapping&&!t.isNullOrUndefined(o)&&o.parentItem&&("topSegment"===this.dropPosition||"bottomSegment"===this.dropPosition))for(var s=this.getChildrecordsByParentID(o.parentUniqueID)[0].childRecords,d=0;d<s.length;d++)o.parentItem.taskData[this.parent.childMapping][parseInt(d.toString(),10)]=s[parseInt(d.toString(),10)].taskData}else{for(var l=Object.keys(e),d=0;d<l.length;d++)e[parseInt(d.toString(),10)][this.parent.childMapping]===o.taskData[this.parent.childMapping]&&(r=d);"topSegment"===this.dropPosition?this.parent.idMapping||e.splice(r,0,i.taskData):"bottomSegment"===this.dropPosition&&(this.parent.idMapping||e.splice(r+1,0,i.taskData))}this.parent.parentIdMapping&&(i.parentItem?"topSegment"===this.dropPosition||"bottomSegment"===this.dropPosition?(i[this.parent.parentIdMapping]=o[this.parent.parentIdMapping],i.taskData[this.parent.parentIdMapping]=o[this.parent.parentIdMapping]):(i[this.parent.parentIdMapping]=o[this.parent.idMapping],i.taskData[this.parent.parentIdMapping]=o[this.parent.idMapping]):(i.taskData[this.parent.parentIdMapping]=null,i[this.parent.parentIdMapping]=null))},e.prototype.removeFirstrowBorder=function(e){var t="bottomSegment"===this.dropPosition;this.parent.element.getElementsByClassName("e-firstrow-border").length>0&&e&&(0!==e.rowIndex||t)&&this.parent.element.getElementsByClassName("e-firstrow-border")[0].remove()},e.prototype.removeLastrowBorder=function(e){var t,r=e&&(e.classList.contains("e-emptyrow")||e.classList.contains("e-columnheader")||e.classList.contains("e-detailrow")),i=(t=this.parent.enableVirtualization?e&&!r&&this.parent.getRows()[this.parent.getCurrentViewRecords().length-1].getAttribute("data-uid")!==e.getAttribute("data-uid"):e&&!r&&this.parent.getRowByIndex(this.parent.getCurrentViewRecords().length-1).getAttribute("data-uid")!==e.getAttribute("data-uid"))||"topSegment"===this.dropPosition;this.parent.element.getElementsByClassName("e-lastrow-border").length>0&&e&&(t||i)&&this.parent.element.getElementsByClassName("e-lastrow-border")[0].remove()},e.prototype.updateIcon=function(e,i,n){var o=n.target?t.closest(n.target,"tr"):null;this.dropPosition=void 0;var a=0;this.removeFirstrowBorder(o),this.removeLastrowBorder(o);for(var s=0;s<n.rows.length;s++)(t.isNullOrUndefined(o)||o.getAttribute("data-uid")!==n.rows[parseInt(s.toString(),10)].getAttribute("data-uid"))&&r.parentsUntil(n.target,"e-gridcontent")||(this.dropPosition="Invalid",this.addErrorElem());var d=this.parent,l=0,p=d.toolbar&&d.toolbar.length?document.getElementById(d.element.id+"_gridcontrol_toolbarItems").offsetHeight:0,h=this.getOffset(d.element),c=d.getHeaderContent().offsetHeight+h.top+p,u=d.getContent().firstElementChild.scrollTop;t.isNullOrUndefined(o)||(a=o.offsetTop-u);var g=((l=this.parent.enableVirtualization?o.getBoundingClientRect().top:a+c+0)+e[0].offsetHeight-l)/3,f=l+g,y=f+g,m=y+g,v=r.getObject("originalEvent.event",n),S=r.getObject("originalEvent.event",n),w="mousemove"===v.type?v.pageY:t.isNullOrUndefined(S)||t.isNullOrUndefined(S.changedTouches)?null:S.changedTouches[0].pageY,I=w<=f,R=w>f&&w<=y,C=w>y&&w<=m;if(I||R||C){if(I&&"Invalid"!==this.dropPosition&&(this.removeChildBorder(),this.dropPosition="topSegment",this.removetopOrBottomBorder(),this.addFirstrowBorder(o),this.removeErrorElem(),this.removeLastrowBorder(o),this.topOrBottomBorder(n.target)),R&&"Invalid"!==this.dropPosition){this.removetopOrBottomBorder();var x=[],b=t.closest(n.target,"tr");(x=[].slice.call(b.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"))).length>0&&this.addRemoveClasses(x,!0,"e-childborder"),this.addLastRowborder(o),this.addFirstrowBorder(o),this.dropPosition="middleSegment"}C&&"Invalid"!==this.dropPosition&&(this.removeErrorElem(),this.removetopOrBottomBorder(),this.removeChildBorder(),this.dropPosition="bottomSegment",this.addLastRowborder(o),this.removeFirstrowBorder(o),this.topOrBottomBorder(n.target))}return this.dropPosition},e.prototype.removeChildBorder=function(){var e=[];(e=[].slice.call(this.parent.element.querySelectorAll(".e-childborder"))).length>0&&this.addRemoveClasses(e,!1,"e-childborder")},e.prototype.addFirstrowBorder=function(e){var r=this.parent.element,i=this.parent;if(e&&0===e.rowIndex&&!e.classList.contains("e-emptyrow")){var n=this.parent.createElement("div",{className:"e-firstrow-border"}),o=this.parent.getHeaderContent(),a=0;i.toolbar&&(a=i.toolbarModule.getToolbar().offsetHeight);var s=!t.isNullOrUndefined(this.parent.rowDropSettings.targetID);s&&(n.style.top=this.parent.grid.element.getElementsByClassName("e-gridheader")[0].offsetHeight+a+"px"),n.style.width=s?r.offsetWidth+"px":r.offsetWidth-this.getScrollWidth()+"px",o.querySelectorAll(".e-firstrow-border").length||o.appendChild(n)}},e.prototype.addLastRowborder=function(e){var t=e&&(e.classList.contains("e-emptyrow")||e.classList.contains("e-columnheader")||e.classList.contains("e-detailrow"));if(e&&!t&&this.parent.getRows()[this.parent.getCurrentViewRecords().length-1].getAttribute("data-uid")===e.getAttribute("data-uid")){var r=this.parent.createElement("div",{className:"e-lastrow-border"}),i=this.parent.getContent();r.style.width=this.parent.element.offsetWidth-this.getScrollWidth()+"px",i.querySelectorAll(".e-lastrow-border").length||(i.classList.add("e-treegrid-relative"),i.appendChild(r),r.style.bottom=this.getScrollWidth()+"px")}},e.prototype.getScrollWidth=function(){var e=this.parent.getContent().firstElementChild;return e.scrollWidth>e.offsetWidth?r.Scroll.getScrollBarWidth():0},e.prototype.addErrorElem=function(){var e=document.getElementsByClassName("e-cloneproperties")[0];if(!e.querySelectorAll(".e-errorelem").length&&!this.parent.rowDropSettings.targetID){var r=document.createElement("div");t.classList(r,["e-errorcontainer"],[]),t.classList(r,["e-icons","e-errorelem"],[]);var i=e.querySelector(".errorValue"),n=e.querySelector(".e-rowcell").innerHTML;i&&(n=this.parent.sanitize(i.innerHTML),i.parentNode.removeChild(i)),e.querySelector(".e-rowcell").innerHTML="";var o=document.createElement("span");o.className="errorValue",o.style.paddingLeft="16px",o.innerHTML=this.parent.sanitize(n),e.querySelector(".e-rowcell").appendChild(r),e.querySelector(".e-rowcell").appendChild(o);var a=document.querySelector(".e-dropitemscount");if(this.hasDropItem&&a){var s=parseInt(a.style.left,10)+r.offsetWidth+16,d=this.parent.enableRtl?0:s;a.style.left=d+"px",this.hasDropItem=!1}}},e.prototype.removeErrorElem=function(){var e=document.querySelector(".e-errorelem"),r=document.querySelector(".errorValue"),i=document.querySelector(".e-dropitemscount");if(e){if(i){var n=parseInt(i.style.left,10)-e.offsetWidth-16;t.setStyleAttribute(r,{paddingLeft:"0px"}),this.parent.enableRtl||t.setStyleAttribute(i,{left:n+"px"})}e.remove()}this.hasDropItem=!0},e.prototype.topOrBottomBorder=function(e){var r=[],i=t.closest(e,"tr");(r=i?[].slice.call(i.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse")):[]).length&&("topSegment"===this.dropPosition&&(this.addRemoveClasses(r,!0,"e-droptop"),this.parent.element.getElementsByClassName("e-lastrow-dragborder").length>0&&this.parent.element.getElementsByClassName("e-lastrow-dragborder")[0].remove()),"bottomSegment"===this.dropPosition&&this.addRemoveClasses(r,!0,"e-dropbottom"))},e.prototype.removetopOrBottomBorder=function(){var e=[];(e=[].slice.call(this.parent.element.querySelectorAll(".e-dropbottom, .e-droptop"))).length&&(this.addRemoveClasses(e,!1,"e-dropbottom"),this.addRemoveClasses(e,!1,"e-droptop"))},e.prototype.addRemoveClasses=function(e,t,r){for(var i=0,n=e.length;i<n;i++)t?e[parseInt(i.toString(),10)].classList.add(r):e[parseInt(i.toString(),10)].classList.remove(r)},e.prototype.getOffset=function(e){var t=e.getBoundingClientRect(),r=document.body,i=document.documentElement,n=window.pageYOffset||i.scrollTop||r.scrollTop,o=window.pageXOffset||i.scrollLeft||r.scrollLeft,a=i.clientTop||r.clientTop||0,s=i.clientLeft||r.clientLeft||0,d=t.top+n-a,l=t.left+o-s;return{top:Math.round(d),left:Math.round(l)}},e.prototype.Rowdraging=function(e){var i=this.parent,n=this.parent.element.querySelector(".e-cloneproperties");n.style.cursor="";var o=e.target?t.closest(e.target,"tr"):null,a=o?o.rowIndex:-1,s=[],d=i.getCurrentViewRecords()[parseInt(a.toString(),10)];if(this.removeErrorElem(),this.canDrop=!0,e.data[0]?s=e.data:s.push(e.data),-1!==a?this.ensuredropPosition(s,d):(this.canDrop=!1,this.addErrorElem()),!i.rowDropSettings.targetID&&this.canDrop&&i.rowDragAndDropModule.updateIcon(e.rows,a,e),i.rowDropSettings.targetID&&(l=r.parentsUntil(e.target,"e-treegrid"))&&l.id===this.parent.rowDropSettings.targetID&&l.ej2_instances[0].rowDragAndDropModule.updateIcon(e.rows,a,e),e.target&&t.closest(e.target,"#"+i.rowDropSettings.targetID)){var l=r.parentsUntil(e.target,"e-treegrid");l||(n.style.cursor="default")}},e.prototype.rowDropped=function(e){var i=this.parent;if(i.rowDropSettings.targetID?(e.target&&t.closest(e.target,"#"+i.rowDropSettings.targetID)||r.parentsUntil(e.target,"e-treegrid")&&r.parentsUntil(e.target,"e-treegrid").id===i.rowDropSettings.targetID||e.target&&document.getElementById(i.rowDropSettings.targetID))&&(t.setValue("dropPosition",this.dropPosition,e),i.trigger("rowDrop",e),!e.cancel&&i.rowDropSettings.targetID&&(this.dragDropGrid(e),i.isLocalData&&(i.flatData=this.orderToIndex(i.flatData)))):r.parentsUntil(e.target,"e-content")&&(this.parent.element.querySelector(".e-errorelem")&&(this.dropPosition="Invalid"),t.setValue("dropPosition",this.dropPosition,e),e.dropIndex=e.dropIndex===e.fromIndex?this.getTargetIdx(e.target.parentElement):e.dropIndex,i.trigger("rowDrop",e),e.cancel||(s(this.parent)||this.dropRows(e),i.isLocalData&&(i.flatData=this.orderToIndex(i.flatData)),i.grid.refresh(),t.isNullOrUndefined(i.getHeaderContent().querySelector(".e-firstrow-border"))||i.getHeaderContent().querySelector(".e-firstrow-border").remove())),this.removetopOrBottomBorder(),this.removeChildBorder(),t.isNullOrUndefined(this.parent.element.getElementsByClassName("e-firstrow-border")[0])?t.isNullOrUndefined(this.parent.element.getElementsByClassName("e-lastrow-border")[0])||this.parent.element.getElementsByClassName("e-lastrow-border")[0].remove():this.parent.element.getElementsByClassName("e-firstrow-border")[0].remove(),this.parent.enableImmutableMode&&!this.parent.allowPaging&&!t.isNullOrUndefined(e.data[0].parentItem)){var n=this.parent.treeColumnIndex;n+=1;var o=this.parent.getPrimaryKeyFieldNames()[0],a=this.parent.grid.getRowIndexByPrimaryKey(e.data[0][""+o]),d=this.parent.getRows()[parseInt(a.toString(),10)],l=e.data[0];if("middleSegment"===this.dropPosition){var p=[],h=[];p.push(l),h.push(d);l=y(this.parent,e.data[0].parentUniqueID),a=this.parent.grid.getRowIndexByPrimaryKey(l[""+o]);var c=this.parent.getRows()[parseInt(a.toString(),10)];p.push(l),h.push(c);for(var u=0;u<p.length;u++)this.parent.renderModule.cellRender({data:p[parseInt(u.toString(),10)],cell:h[parseInt(u.toString(),10)].cells[parseInt(n.toString(),10)],column:this.parent.grid.getColumns()[this.parent.treeColumnIndex],requestType:"rowDragAndDrop"});var g=c.getElementsByClassName("e-treegridcollapse")[0];t.isNullOrUndefined(g)||(t.removeClass([g],"e-treegridcollapse"),t.addClass([g],"e-treegridexpand"))}else this.parent.renderModule.cellRender({data:l,cell:d.cells[parseInt(n.toString(),10)],column:this.parent.grid.getColumns()[this.parent.treeColumnIndex],requestType:"rowDragAndDrop"})}},e.prototype.dragDropGrid=function(e){var i,n=this.parent,o=t.closest(e.target,"tr"),d=isNaN(this.getTargetIdx(o))?0:this.getTargetIdx(o),l=r.parentsUntil(e.target,"e-treegrid");if(l&&l.id===this.parent.rowDropSettings.targetID&&!a(this.parent)&&!s(this.parent)){i=l.ej2_instances[0];for(var p=n.getSelectedRecords(),h=[],u=0;u<p.length;u++)h[parseInt(u.toString(),10)]=p[parseInt(u.toString(),10)].index;var g=i.dataSource;if(null!==this.parent.idMapping&&(t.isNullOrUndefined(this.dropPosition)||"bottomSegment"===this.dropPosition||"Invalid"===this.dropPosition)&&!g.length){for(var f=[],u=0;u<p.length;u++)if(p[parseInt(u.toString(),10)].hasChildRecords){f.push(p[parseInt(u.toString(),10)]);for(var y=c(p[parseInt(u.toString(),10)]),m=0;m<y.length;m++)f.push(y[parseInt(m.toString(),10)])}f.length&&(p=f)}n.notify("rows-remove",{indexes:h,records:p}),i.notify("rows-add",{toIndex:d,records:p});var v=i.rowDragAndDropModule.treeGridData;if(!t.isNullOrUndefined(v))for(u=0;u<v.length;u++)if(v[parseInt(u.toString(),10)].index=u,!t.isNullOrUndefined(v[parseInt(u.toString(),10)].parentItem)){var S=t.getValue("uniqueIDCollection."+v[parseInt(u.toString(),10)].parentUniqueID+".index",i);v[parseInt(u.toString(),10)].parentItem.index=S}n.grid.refresh(),i.grid.refresh(),i.grid.dataSource.length>1&&(i.grid.refresh(),t.isNullOrUndefined(i.getHeaderContent().querySelector(".e-firstrow-border"))||i.getHeaderContent().querySelector(".e-firstrow-border").remove(),t.isNullOrUndefined(i.getContent().querySelector(".e-lastrow-border"))||i.getContent().querySelector(".e-lastrow-border").remove())}s(this.parent)&&(i=l.ej2_instances[0],n.grid.refresh(),i.grid.refresh())},e.prototype.getTargetIdx=function(e){return e?parseInt(e.getAttribute("data-rowindex"),10):0},e.prototype.getParentData=function(e,t){var r=e.parentItem,i=-1;if(this.parent.enableVirtualization&&-1!==this.parent.selectedRowIndex?i=this.parent.getSelectedRows()[0].rowIndex:-1!==this.parent.selectedRowIndex&&(i=this.parent.selectedRowIndex),"bottomSegment"===this.dropPosition){var n=this.parent.getPrimaryKeyFieldNames()[0],o=-1===i?this.parent.grid.getRowIndexByPrimaryKey(t[0][""+n]):this.parent.getSelectedRowIndexes()[0],a=this.parent.getCurrentViewRecords()[parseInt(o.toString(),10)];this.droppedRecord=y(this.parent,a.parentItem.uniqueID)}"middleSegment"===this.dropPosition&&(this.parent.getCurrentViewRecords()[parseInt(i.toString(),10)].level===r.level?this.droppedRecord=y(this.parent,r.uniqueID):this.getParentData(r))},e.prototype.dropRows=function(e,r){if("Invalid"!==this.dropPosition&&!a(this.parent)){var i,n=this.parent,o=void 0;if(t.isNullOrUndefined(e.dropIndex)){var s=this.parent.getPrimaryKeyFieldNames()[0],d=-1===n.selectedRowIndex?this.parent.grid.getRowIndexByPrimaryKey(e.data[0][""+s])-1:n.getSelectedRowIndexes()[0]-1,l=n.getCurrentViewRecords()[parseInt(d.toString(),10)];this.getParentData(l,e.data)}else if(e.dropIndex=e.dropIndex===e.fromIndex?this.getTargetIdx(e.target.parentElement):e.dropIndex,this.parent.enableVirtualization){var p=this.parent.getRowByIndex(e.dropIndex).rowIndex;this.droppedRecord=n.getCurrentViewRecords()[parseInt(p.toString(),10)]}else this.droppedRecord=n.getCurrentViewRecords()[e.dropIndex];var h=[];o=this.droppedRecord,e.data[0]?h=e.data:h.push(e.data),this.parent[this.modifiedRecords].push(e.data[0],o);var c=0,u=this.parent.rowDropSettings.targetID;this.isMultipleGrid=u,u?this.isaddtoBottom=u&&this.isDraggedWithChild:this.ensuredropPosition(h,o);var g=h.length;t.isNullOrUndefined(this.parent.idMapping)||h.reverse();for(var f=this,y=0;y<g;y++)!function(a){if(i=h[parseInt(a.toString(),10)],f.draggedRecord=i,"Invalid"!==f.dropPosition){if(n.rowDropSettings.targetID&&!r||f.deleteDragRow(),f.draggedRecord===f.droppedRecord){var s=f.getTargetIdx(e.target.offsetParent.parentElement);isNaN(s)&&(s=f.getTargetIdx(e.target.parentElement)),e.dropIndex=s,o=f.droppedRecord=f.parent.getCurrentViewRecords()[e.dropIndex]}(o.parentItem||"middleSegment"===f.dropPosition)&&-1!==(g=(u=n.parentData).indexOf(f.draggedRecord))&&u.splice(g,1);var d=f.treeGridData.indexOf(o);if(f.dropAtTop(d),"bottomSegment"===f.dropPosition){if(o.hasChildRecords?(c=f.getChildCount(o,0),f.parent.parentIdMapping&&f.treeData.splice(d+c+1,0,f.draggedRecord.taskData),f.treeGridData.splice(d+c+1,0,f.draggedRecord)):(f.parent.parentIdMapping&&f.treeData.splice(d+1,0,f.draggedRecord.taskData),f.treeGridData.splice(d+1,0,f.draggedRecord)),t.isNullOrUndefined(o.parentItem)&&(delete i.parentItem,delete i.parentUniqueID,i.level=0,f.parent.parentIdMapping&&(i[f.parent.parentIdMapping]=null)),o.parentItem){var l=f.getChildrecordsByParentID(o.parentUniqueID)[0].childRecords,p=l.indexOf(o)+1;l.splice(p,0,i),(f.parent.enableImmutableMode||f.parent.isIndentEnabled&&!f.parent.parentIdMapping)&&(i.parentItem=o.parentItem,i.level=o.level),i.parentUniqueID=o.parentUniqueID,f.parent.parentIdMapping&&(i[f.parent.parentIdMapping]=o[f.parent.parentIdMapping],i.parentUniqueID=o.parentUniqueID)}if(i.hasChildRecords){f.updateChildRecordLevel(i,1),f.updateChildRecord(i,d+c+1)}}f.dropMiddle(d)}if(t.isNullOrUndefined(i.parentItem)){var u=n.parentData,g=u.indexOf(f.droppedRecord),y=0;u.filter(function(e){i.uniqueID===e.uniqueID&&y++}),"bottomSegment"===f.dropPosition&&0===y?u.splice(g+1,0,i):"topSegment"===f.dropPosition&&0===y&&u.splice(g,0,i)}n.rowDragAndDropModule.refreshGridDataSource()}(y)}},e.prototype.dropMiddle=function(e){var r=this.parent,i=c(this.droppedRecord),n=t.isNullOrUndefined(i)||0===i.length?e+1:i.length+e+1;"middleSegment"===this.dropPosition&&(r.parentIdMapping?(this.treeData.splice(n,0,this.draggedRecord.taskData),this.treeGridData.splice(n,0,this.draggedRecord)):this.treeGridData.splice(n,0,this.draggedRecord),this.recordLevel(),this.draggedRecord.hasChildRecords&&this.updateChildRecord(this.draggedRecord,n))},e.prototype.dropAtTop=function(e){var t=this.parent;if("topSegment"===this.dropPosition){if(t.parentIdMapping&&this.treeData.splice(e,0,this.draggedRecord.taskData),this.draggedRecord.parentItem=this.treeGridData[parseInt(e.toString(),10)].parentItem,this.draggedRecord.parentUniqueID=this.treeGridData[parseInt(e.toString(),10)].parentUniqueID,this.draggedRecord.level=this.treeGridData[parseInt(e.toString(),10)].level,this.treeGridData.splice(parseInt(e.toString(),10),0,this.draggedRecord),this.draggedRecord.hasChildRecords){this.updateChildRecord(this.draggedRecord,e),this.updateChildRecordLevel(this.draggedRecord,1)}if(this.droppedRecord.parentItem){var r=this.getChildrecordsByParentID(this.droppedRecord.parentUniqueID)[0].childRecords,i=r.indexOf(this.droppedRecord);r.splice(i,0,this.draggedRecord)}}},e.prototype.recordLevel=function(){var e=this.parent,r=this.draggedRecord,i=this.droppedRecord,n=e.childMapping;if(i.hasChildRecords||(i.hasChildRecords=!0,i.hasFilteredChildRecords=!0,(t.isNullOrUndefined(i.childRecords)||0===i.childRecords.length)&&(i.childRecords=[],!e.parentIdMapping&&t.isNullOrUndefined(i.taskData[""+n])&&(i.taskData[""+n]=[]))),"middleSegment"===this.dropPosition){var o=t.extend({},i);delete o.childRecords,r.parentItem=o,r.parentUniqueID=i.uniqueID,i.childRecords.splice(i.childRecords.length,0,r);if(e.isSelfReference&&(i[e.childMapping]=[],i[e.childMapping].splice(i[e.childMapping].length,0,r)),t.isNullOrUndefined(r)||e.parentIdMapping||t.isNullOrUndefined(i.taskData[""+n])||i.taskData[e.childMapping].splice(i.childRecords.length,0,r.taskData),r.hasChildRecords){r.level=i.level+1,this.updateChildRecordLevel(r,1)}else r.level=i.level+1;i.expanded=!0}},e.prototype.deleteDragRow=function(){this.parent.dataSource instanceof n.DataManager&&u(this.parent)?(this.treeGridData=this.parent.grid.dataSource.dataSource.json,this.treeData=this.parent.dataSource.dataSource.json):(this.treeGridData=this.parent.grid.dataSource,this.treeData=this.parent.dataSource);var e=y(this.parent,this.draggedRecord.uniqueID);!t.isNullOrUndefined(e.childRecords)&&e.childRecords.length&&(e.hasChildRecords=!0),this.removeRecords(e)},e.prototype.updateChildRecord=function(e,r){var i,n=this.parent,o=0;if(!e.hasChildRecords)return 0;o=e.childRecords.length;for(var a=0;a<o;a++)i=this.isMultipleGrid?e.childRecords[parseInt(a.toString(),10)]:t.getValue("uniqueIDCollection."+e.childRecords[parseInt(a.toString(),10)].uniqueID,n),r++,n.flatData.splice(r,0,i),t.setValue("uniqueIDCollection."+i.uniqueID,i,this.parent),n.parentIdMapping&&this.treeData.splice(r,0,i.taskData),i.hasChildRecords&&(r=this.updateChildRecord(i,r));return r},e.prototype.updateChildRecordLevel=function(e,r){var i,n=0;if(r++,!e.hasChildRecords)return 0;n=e.childRecords.length;for(var o=0;o<n;o++){i=this.isMultipleGrid?e.childRecords[parseInt(o.toString(),10)]:t.getValue("uniqueIDCollection."+e.childRecords[parseInt(o.toString(),10)].uniqueID,this.parent);var a=void 0;e.parentItem&&(a=y(this.parent,e.parentItem.uniqueID)),t.isNullOrUndefined(a)&&!t.isNullOrUndefined(e.parentItem)&&(a=e.parentItem),i.level=e.parentItem?a.level+r:e.level+1,i.hasChildRecords&&(r--,r=this.updateChildRecordLevel(i,r))}return r},e.prototype.removeRecords=function(e){var r,i=this.parent;r=this.parent.dataSource instanceof n.DataManager&&u(this.parent)?this.parent.dataSource.dataSource.json:this.parent.dataSource;var o=e,a=!t.isNullOrUndefined(i.parentIdMapping),s=this.getChildrecordsByParentID(o.parentUniqueID)[0];if(o){if(o.parentItem){var d=s?s.childRecords:[],l=0;d&&d.length>0&&(l=d.indexOf(o),s.childRecords.splice(l,1),this.parent.parentIdMapping&&!i.enableImmutableMode||v({value:o,action:"delete"},this.parent,a,o.index,o.index))}if(i.parentIdMapping){o.hasChildRecords&&o.childRecords.length>0&&this.removeChildItem(o);for(var p=void 0,h=void 0,c=r,g=0;g<c.length;g++)c[parseInt(g.toString(),10)][this.parent.idMapping]===o.taskData[this.parent.idMapping]&&(p=g);for(g=0;g<this.treeGridData.length;g++)this.treeGridData[parseInt(g.toString(),10)][this.parent.idMapping]===o.taskData[this.parent.idMapping]&&(h=g);-1===p||t.isNullOrUndefined(p)||r.splice(p,1),-1===h||t.isNullOrUndefined(h)||this.treeGridData.splice(h,1)}var f=this.treeGridData.indexOf(o);if(!i.parentIdMapping){var y=this.parent.parentData.indexOf(o);-1!==y&&(i.parentData.splice(y,1),r.splice(y,1))}if(-1===f&&!i.parentIdMapping)for(var m=i.getPrimaryKeyFieldNames()[0],S=0;S<this.treeGridData.length;S++)this.treeGridData[parseInt(S.toString(),10)][""+m]===o[""+m]&&(f=S);if(!i.parentIdMapping){var w=this.getChildCount(o,0);this.treeGridData.splice(f,w+1)}o.parentItem&&s&&s.childRecords&&!s.childRecords.length&&(s.expanded=!1,s.hasChildRecords=!1,s.hasFilteredChildRecords=!1),-1!==this.parent[this.modifiedRecords].indexOf(s)||t.isNullOrUndefined(s)||this.parent[this.modifiedRecords].push(s),t.isNullOrUndefined(s)||this.updateModifiedRecords(s)}},e.prototype.updateModifiedRecords=function(e){var r=y(this.parent,e.parentUniqueID);t.isNullOrUndefined(r)||(this.parent[this.modifiedRecords].push(r),this.updateModifiedRecords(r))},e.prototype.removeChildItem=function(e){var r,i,o,a;a=this.parent.dataSource instanceof n.DataManager&&u(this.parent)?this.parent.dataSource.dataSource.json:this.parent.dataSource;for(var s=0;s<e.childRecords.length;s++){r=e.childRecords[parseInt(s.toString(),10)],!t.isNullOrUndefined(r.childRecords)&&r.childRecords.length&&(r.hasChildRecords=!0);var d=void 0;d=this.parent.dataSource instanceof n.DataManager&&u(this.parent)?this.parent.dataSource.dataSource.json:this.parent.dataSource;for(var l=0;l<d.length;l++)d[parseInt(l.toString(),10)][this.parent.idMapping]===r.taskData[this.parent.idMapping]&&(i=l);for(var p=0;p<this.treeGridData.length;p++)if(this.treeGridData[parseInt(p.toString(),10)][this.parent.idMapping]===r.taskData[this.parent.idMapping]){o=p;break}-1===i||t.isNullOrUndefined(i)||a.splice(i,1),-1===o||t.isNullOrUndefined(o)||this.treeGridData.splice(o,1),r.hasChildRecords&&this.removeChildItem(r)}},e.prototype.getChildCount=function(e,t){var r;if(!e.hasChildRecords)return 0;for(var i=0;i<e.childRecords.length;i++)t++,(r=e.childRecords[parseInt(i.toString(),10)]).hasChildRecords&&(t=this.getChildCount(r,t));return t},e.prototype.ensuredropPosition=function(e,r){var i=this;e.filter(function(e){if(e.hasChildRecords&&!t.isNullOrUndefined(e.childRecords)){if(-1!==e.childRecords.indexOf(r))return i.dropPosition="Invalid",i.addErrorElem(),void(i.canDrop=!1);i.ensuredropPosition(e.childRecords,r)}})},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("row-draging",this.Rowdraging),this.parent.off("row-dropped",this.rowDropped),this.parent.off("rows-add",this.rowsAdded),this.parent.off("rows-remove",this.rowsRemoved))},e.prototype.getModuleName=function(){return"rowDragAndDrop"},e}(),we=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ie=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Re=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return we(r,e),Ie([t.Property()],r.prototype,"targetID",void 0),r}(t.ChildProperty),Ce=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),xe=function(e){function r(t){var r=e.call(this,t)||this;return r.addEventListener(),r}return Ce(r,e),r.prototype.addEventListener=function(){this.parent.on("data-listener",this.getDatas,this)},r.prototype.getDatas=function(e){this.visualData=e.data},r.prototype.getDataInfo=function(){return e.prototype.getData.call(this)},r.prototype.generateRows=function(r,i){!t.isNullOrUndefined(i.virtualInfo)&&i.virtualInfo.loadNext&&i.virtualInfo.nextInfo.page!==this.parent.pageSettings.currentPage?this.parent.setProperties({pageSettings:{currentPage:i.virtualInfo.nextInfo.page}},!0):t.isNullOrUndefined(i.virtualInfo)||i.virtualInfo.loadNext||i.virtualInfo.page===this.parent.pageSettings.currentPage||this.parent.setProperties({pageSettings:{currentPage:i.virtualInfo.page}},!0);var o=this.getDataInfo();if(t.isNullOrUndefined(i.virtualInfo)||("right"!==i.virtualInfo.direction&&"left"!==i.virtualInfo.direction?(this.parent.dataSource instanceof n.DataManager&&void 0!==this.parent.dataSource.dataSource.url&&!this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url||s(this.parent))&&1!==i.virtualInfo.blockIndexes.length||(i.virtualInfo.blockIndexes=o.blockIndexes):i.virtualInfo.blockIndexes=this.getBlockIndexes(i.virtualInfo.page)),this.parent.dataSource instanceof n.DataManager&&void 0!==this.parent.dataSource.dataSource.url&&!this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url||s(this.parent))return e.prototype.generateRows.call(this,r,i);t.isNullOrUndefined(i.requestType)||"collapseAll"!==i.requestType.toString()||(i.requestType="refresh");for(var a=e.prototype.generateRows.call(this,r,i),d=0;d<a.length;d++)a[parseInt(d.toString(),10)].index=this.visualData.indexOf(a[parseInt(d.toString(),10)].data);return a},r.prototype.checkAndResetCache=function(e){var t=["paging","refresh","sorting","filtering","searching","reorder","save","delete"].some(function(t){return e===t});if(this.parent.dataSource instanceof n.DataManager&&void 0!==this.parent.dataSource.dataSource.url&&!this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url||s(this.parent)){var r=this.model.currentPage;t?(this.cache={},this.movableCache={},this.frozenRightCache={},this.data={},this.groups={}):"virtualscroll"===e&&this.cache[parseInt(r.toString(),10)]&&this.cache[parseInt(r.toString(),10)].length>this.parent.contentModule.getBlockSize()&&delete this.cache[parseInt(r.toString(),10)]}else(t||"virtualscroll"===e)&&(this.cache={},this.data={},this.groups={},this.movableCache={},this.frozenRightCache={});return t},r}(r.VirtualRowModelGenerator),be=function(){function e(e){r.Grid.Inject(r.Filter),this.parent=e,this.isHierarchyFilter=!1,this.filteredResult=[],this.flatFilteredData=[],this.filteredParentRecs=[],this.addEventListener()}return e.prototype.getModuleName=function(){return"filter"},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.addEventListener=function(){this.parent.on("updateFilterRecs",this.updatedFilteredRecord,this),this.parent.on("clearFilters",this.clearFilterLevel,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("updateFilterRecs",this.updatedFilteredRecord),this.parent.off("clearFilters",this.clearFilterLevel))},e.prototype.updatedFilteredRecord=function(e){t.setValue("uniqueIDFilterCollection",{},this.parent),this.flatFilteredData=e.data,this.filteredParentRecs=[],this.filteredResult=[],this.isHierarchyFilter=!1;for(var i=0;i<this.flatFilteredData.length;i++){var n=this.flatFilteredData[parseInt(i.toString(),10)];this.addParentRecord(n);var o=""===this.parent.grid.searchSettings.key?this.parent.filterSettings.hierarchyMode:this.parent.searchSettings.hierarchyMode;"Child"!==o&&"None"!==o||0===this.parent.grid.filterSettings.columns.length&&""===this.parent.grid.searchSettings.key||(this.isHierarchyFilter=!0);var a=r.getObject("childRecords",n);!t.isNullOrUndefined(a)&&a.length&&t.setValue("hasFilteredChildRecords",this.checkChildExsist(n),n);var s=r.getObject("parentItem",n);if(!t.isNullOrUndefined(s)){var d=y(this.parent,n.parentItem.uniqueID,!0);t.setValue("hasFilteredChildRecords",!0,d),d&&d.parentItem&&this.updateParentFilteredRecord(d)}}this.flatFilteredData.length>0&&this.isHierarchyFilter&&this.updateFilterLevel(),this.parent.notify("updateAction",{result:this.filteredResult})},e.prototype.updateParentFilteredRecord=function(e){var r=y(this.parent,e.parentItem.uniqueID,!0),i=t.getValue("uniqueIDFilterCollection",this.parent);r&&Object.prototype.hasOwnProperty.call(i,r.uniqueID)&&t.setValue("hasFilteredChildRecords",!0,r),r&&r.parentItem&&this.updateParentFilteredRecord(r)},e.prototype.addParentRecord=function(e){var r=y(this.parent,e.parentUniqueID);if("None"!==(""===this.parent.grid.searchSettings.key?this.parent.filterSettings.hierarchyMode:this.parent.searchSettings.hierarchyMode)||0===this.parent.grid.filterSettings.columns.length&&""===this.parent.grid.searchSettings.key)t.isNullOrUndefined(r)||("Child"!==(""===this.parent.grid.searchSettings.key?this.parent.filterSettings.hierarchyMode:this.parent.searchSettings.hierarchyMode)||0===this.parent.grid.filterSettings.columns.length&&""===this.parent.grid.searchSettings.key?this.addParentRecord(r):-1!==this.flatFilteredData.indexOf(r)&&this.addParentRecord(r)),-1===this.filteredResult.indexOf(e)&&(this.filteredResult.push(e),t.setValue("uniqueIDFilterCollection."+e.uniqueID,e,this.parent));else if(t.isNullOrUndefined(r)){if(-1!==this.flatFilteredData.indexOf(e))return void(-1===this.filteredResult.indexOf(e)&&(this.filteredResult.push(e),t.setValue("uniqueIDFilterCollection."+e.uniqueID,e,this.parent),e.hasFilteredChildRecords=!0))}else this.addParentRecord(r),-1!==this.flatFilteredData.indexOf(r)||-1!==this.filteredResult.indexOf(r)?-1===this.filteredResult.indexOf(e)&&(this.filteredResult.push(e),t.setValue("uniqueIDFilterCollection."+e.uniqueID,e,this.parent)):-1===this.filteredResult.indexOf(e)&&-1!==this.flatFilteredData.indexOf(e)&&(this.filteredResult.push(e),t.setValue("uniqueIDFilterCollection."+e.uniqueID,e,this.parent))},e.prototype.checkChildExsist=function(e){for(var i=r.getObject("childRecords",e),n=!1,o=0;o<i.length;o++){var a=i[parseInt(o.toString(),10)].childRecords,s=""===this.parent.grid.searchSettings.key?this.parent.filterSettings.hierarchyMode:this.parent.searchSettings.hierarchyMode;if(!("Child"!==s&&"Both"!==s||0===this.parent.grid.filterSettings.columns.length&&""===this.parent.grid.searchSettings.key)){var d=t.getValue("uniqueIDFilterCollection",this.parent);Object.prototype.hasOwnProperty.call(d,i[parseInt(o.toString(),10)].uniqueID)||(this.filteredResult.push(i[parseInt(o.toString(),10)]),t.setValue("uniqueIDFilterCollection."+i[parseInt(o.toString(),10)].uniqueID,i[parseInt(o.toString(),10)],this.parent),n=!0)}if("None"===s&&(0!==this.parent.grid.filterSettings.columns.length||""!==this.parent.grid.searchSettings.key)&&-1!==this.flatFilteredData.indexOf(i[parseInt(o.toString(),10)])){n=!0;break}!t.isNullOrUndefined(a)&&a.length&&(n=this.checkChildExsist(i[parseInt(o.toString(),10)])),"Child"!==s&&"Both"!==s||!i.length||(n=!0)}return n},e.prototype.updateFilterLevel=function(){for(var e=this.filteredResult,t=this.filteredResult.length,r=0;r<t;r++){var i=y(this.parent,e[parseInt(r.toString(),10)].parentUniqueID);if(-1!==e.indexOf(i)){var n=y(this.parent,e[parseInt(r.toString(),10)].parentUniqueID,!0);e[parseInt(r.toString(),10)].filterLevel=n.filterLevel+1}else e[parseInt(r.toString(),10)].filterLevel=0,this.filteredParentRecs.push(e[parseInt(r.toString(),10)])}},e.prototype.clearFilterLevel=function(e){var r,i=0,n=e.flatData,o=n.length;for(i;i<o;i++){var a=(r=n[parseInt(i.toString(),10)]).filterLevel;!a&&0!==a&&t.isNullOrUndefined(r.hasFilteredChildRecords)||(r.hasFilteredChildRecords=null,r.filterLevel=null)}this.filteredResult=[],this.parent.notify("updateResults",{result:n,count:n.length})},e}(),De=function(){function e(e){this.isCollapsedStatePersist=!1,r.Grid.Inject(r.ExcelExport),this.parent=e,this.dataResults={},this.addEventListener()}return e.prototype.getModuleName=function(){return"ExcelExport"},e.prototype.addEventListener=function(){this.parent.on("updateResults",this.updateExcelResultModel,this),this.parent.on("excelCellInfo",this.excelQueryCellInfo,this),this.parent.grid.on("export-RowDataBound",this.exportRowDataBound,this),this.parent.grid.on("finalPageSetup",this.finalPageSetup,this)},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("updateResults",this.updateExcelResultModel),this.parent.off("excelCellInfo",this.excelQueryCellInfo),this.parent.grid.off("export-RowDataBound",this.exportRowDataBound),this.parent.grid.off("finalPageSetup",this.finalPageSetup))},e.prototype.updateExcelResultModel=function(e){this.dataResults=e},e.prototype.Map=function(e,i,o,a,s){var d=this,l=this.parent.dataSource,p=Object();return t.setValue("isCsv",s,p),t.setValue("cancel",!1,p),t.isNullOrUndefined(e)||(this.isCollapsedStatePersist=e.isCollapsedStatePersist),new Promise(function(h){var c=!d.isLocal()||l instanceof n.DataManager?d.parent.dataSource:new n.DataManager(l),u=new n.Query;if(d.isLocal()||(u=d.generateQuery(u),t.setValue("query",u,p)),d.parent.trigger("beforeExcelExport",t.extend(p,e)),r.getObject("cancel",p))return null;c.executeQuery(u).then(function(r){var n=null;return t.isNullOrUndefined(e)||t.isNullOrUndefined(e.dataSource)||(n=e.dataSource),e=d.manipulateExportProperties(e,l,r),d.parent.grid.excelExportModule.Map(d.parent.grid,e,i,o,s,a).then(function(t){null!=n?e.dataSource=n:delete e.dataSource,h(t)})})})},e.prototype.generateQuery=function(e,i){return!t.isNullOrUndefined(i)&&"CurrentPage"===i.exportType&&this.parent.allowPaging&&(i.exportType="AllPages",e.addParams("ExportType","CurrentPage"),e.where(this.parent.parentIdMapping,"equal",null),e=r.getObject("grid.renderModule.data.pageQuery",this.parent)(e)),e},e.prototype.manipulateExportProperties=function(e,i,o){var a=Object();if(t.setValue("query",this.parent.grid.getDataModule().generateQuery(!0),a),t.setValue("isExport",!0,a),t.isNullOrUndefined(e)||t.isNullOrUndefined(e.exportType)||t.setValue("exportType",e.exportType,a),this.isLocal()||(this.parent.parentData=[],this.parent.dataModule.convertToFlatData(r.getObject("result",o)),t.setValue("expresults",this.parent.flatData,a)),this.parent.notify("dataProcessor",a),a=this.dataResults,i=t.isNullOrUndefined(a.result)?this.parent.flatData.slice(0):a.result,this.isLocal()||(this.parent.flatData=[]),e&&e.dataSource&&this.isLocal()){var s=this.parent.flatData,d=e.dataSource instanceof n.DataManager?e.dataSource.dataSource.json:e.dataSource;this.parent.dataModule.convertToFlatData(d),i=this.parent.flatData,this.parent.flatData=s}return e=t.isNullOrUndefined(e)?Object():e,e.dataSource=new n.DataManager({json:i}),e},e.prototype.excelQueryCellInfo=function(e){if(this.parent.grid.getColumnIndexByUid(e.column.uid)===this.parent.treeColumnIndex){var r={},i=e.data,n=t.isNullOrUndefined(i.filterLevel)?i.level:i.filterLevel;r.indent=n,e.style=r}this.parent.notify("updateResults",e),this.parent.trigger("excelQueryCellInfo",e)},e.prototype.exportRowDataBound=function(e){if("excel"===e.type){var r=e.rowObj.data,i=this.parent.grid.filterSettings.columns.length,n=e.excelRows.length,o=r.level;if(r.parentItem&&y(this.parent,r.parentItem.uniqueID,Boolean(i))){var a=!1,s=!1,d=h(this.parent,r,this.parent.parentData);!this.isCollapsedStatePersist||d&&this.parent.isLocalData||(a=!0,s=!r.expanded),e.excelRows[n-1].grouping={outlineLevel:o,isCollapsed:s,isHidden:a}}else r.hasChildRecords&&t.isNullOrUndefined(r.parentItem)&&(e.excelRows[n-1].grouping={outlineLevel:o})}},e.prototype.finalPageSetup=function(e){for(var t=0;t<e.worksheets.length;t++)e.worksheets[parseInt(t.toString(),10)].rows&&(e.worksheets[parseInt(t.toString(),10)].pageSetup={isSummaryRowBelow:!1})},e.prototype.isLocal=function(){return!a(this.parent)&&u(this.parent)},e}(),Me=function(){function e(e){r.Grid.Inject(r.PdfExport),this.parent=e,this.dataResults={},this.addEventListener()}return e.prototype.getModuleName=function(){return"PdfExport"},e.prototype.addEventListener=function(){this.parent.on("pdfCellInfo",this.pdfQueryCellInfo,this),this.parent.on("updateResults",this.updatePdfResultModel,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("pdfCellInfo",this.pdfQueryCellInfo),this.parent.off("updateResults",this.updatePdfResultModel))},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.updatePdfResultModel=function(e){this.dataResults=e},e.prototype.Map=function(e,i,o,s){var d=this,l=this.parent.dataSource,p=Object(),h=!a(this.parent)&&u(this.parent);return t.setValue("cancel",!1,p),new Promise(function(a){var c=!h||l instanceof n.DataManager?d.parent.dataSource:new n.DataManager(l),u=new n.Query;if(h||(u=d.generateQuery(u),t.setValue("query",u,p)),d.parent.trigger("beforePdfExport",t.extend(p,e)),r.getObject("cancel",p))return null;c.executeQuery(u).then(function(r){var n=null;return t.isNullOrUndefined(e)||t.isNullOrUndefined(e.dataSource)||(n=e.dataSource),e=d.manipulatePdfProperties(e,l,r),d.parent.grid.pdfExportModule.Map(d.parent.grid,e,i,o,s).then(function(t){null!=n?e.dataSource=n:delete e.dataSource,a(t)})})})},e.prototype.generateQuery=function(e,i){return!t.isNullOrUndefined(i)&&"CurrentPage"===i.exportType&&this.parent.allowPaging&&(i.exportType="AllPages",e.addParams("ExportType","CurrentPage"),e.where(this.parent.parentIdMapping,"equal",null),e=r.getObject("grid.renderModule.data.pageQuery",this.parent)(e)),e},e.prototype.manipulatePdfProperties=function(e,r,i){var o={},s=!a(this.parent)&&u(this.parent);if(t.setValue("query",this.parent.grid.getDataModule().generateQuery(!0),o),t.setValue("isExport",!0,o),t.setValue("isPdfExport",!0,o),t.isNullOrUndefined(e)||t.isNullOrUndefined(e.isCollapsedStatePersist)||t.setValue("isCollapsedStatePersist",e.isCollapsedStatePersist,o),t.isNullOrUndefined(e)||t.isNullOrUndefined(e.exportType)||t.setValue("exportType",e.exportType,o),s||(this.parent.parentData=[],this.parent.dataModule.convertToFlatData(t.getValue("result",i)),t.setValue("expresults",this.parent.flatData,o)),this.parent.notify("dataProcessor",o),o=this.dataResults,r=t.isNullOrUndefined(o.result)?this.parent.flatData.slice(0):o.result,s||(this.parent.flatData=[]),e&&e.dataSource&&s){var d=this.parent.flatData,l=e.dataSource instanceof n.DataManager?e.dataSource.dataSource.json:e.dataSource;this.parent.dataModule.convertToFlatData(l),r=this.parent.flatData,this.parent.flatData=d}return e=t.isNullOrUndefined(e)?{}:e,e.dataSource=new n.DataManager({json:r}),e},e.prototype.pdfQueryCellInfo=function(e){if(this.parent.grid.getColumnIndexByUid(e.column.uid)===this.parent.treeColumnIndex){var i={},n=r.getObject("data",e),o=t.isNullOrUndefined(n.filterLevel)?n.level:n.filterLevel;i.paragraphIndent=3*o,e.style=i}this.parent.notify("updateResults",e),this.parent.trigger("pdfQueryCellInfo",e)},e}(),Oe=function(){function e(e){r.Grid.Inject(r.Page),this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on("localPagedExpandCollapse",this.collapseExpandPagedchilds,this),this.parent.on("pagingActions",this.pageAction,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("localPagedExpandCollapse",this.collapseExpandPagedchilds),this.parent.off("pagingActions",this.pageAction))},e.prototype.getModuleName=function(){return"pager"},e.prototype.refresh=function(){this.parent.grid.pagerModule.refresh()},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.goToPage=function(e){this.parent.grid.pagerModule.goToPage(e)},e.prototype.updateExternalMessage=function(e){this.parent.grid.pagerModule.updateExternalMessage(e)},e.prototype.collapseExpandPagedchilds=function(e){if(e.record.expanded="collapse"!==e.action,this.parent.flatData.map(function(t){return t.expanded=t.uniqueID===e.record.uniqueID&&t.expanded!==e.record.expanded?e.record.expanded:t.expanded}),this.parent.enableImmutableMode){var r=this.parent.getPrimaryKeyFieldNames()[0],i=this.parent.flatData.filter(function(t){return t[""+r]===e.record[""+r]});i.length&&(i[0].expanded=e.record.expanded)}var n={result:this.parent.flatData,row:e.row,action:e.action,record:e.record,count:this.parent.flatData.length};if(t.getValue("grid.renderModule",this.parent).dataManagerSuccess(n),this.parent.enableImmutableMode){var o=void 0;"collapse"===n.action?(o=n.row.getElementsByClassName("e-treegridexpand")[0],t.isNullOrUndefined(o)||(t.removeClass([o],"e-treegridexpand"),t.addClass([o],"e-treegridcollapse"))):"expand"===n.action&&(o=n.row.getElementsByClassName("e-treegridcollapse")[0],t.isNullOrUndefined(o)||(t.removeClass([o],"e-treegridcollapse"),t.addClass([o],"e-treegridexpand")))}},e.prototype.pageRoot=function(e,r,i){for(var n=t.isNullOrUndefined(i)?[]:i,o=this,a=0;a<r.length;a++)!function(t){n.push(r[parseInt(t.toString(),10)]);var i=[];r[parseInt(t.toString(),10)].hasChildRecords&&(i=e.filter(function(e){return r[parseInt(t.toString(),10)].uniqueID===e.parentUniqueID}),n=o.pageRoot(e,i,n))}(a);return n},e.prototype.updatePageSize=function(e){var t=e.result.length,r=this.parent.grid.pagerModule;!0===this.parent.pageSettings.pageSizes&&r.pagerObj.pagerdropdownModule.dropDownListObject.value===r.pagerObj.getLocalizedLabel("All")&&(r.pagerObj.totalRecordsCount=t,this.parent.grid.pageSettings.pageSize=t)},e.prototype.pageAction=function(e){var t=this,r=new n.DataManager(e.result);if("Root"===this.parent.pageSettings.pageSizeMode){var i=[],o=this.parent.grid.filterSettings.columns.length>0&&("Child"===this.parent.filterSettings.hierarchyMode||"None"===this.parent.filterSettings.hierarchyMode)?"filterLevel":"level",a=(new n.Query).where(o,"equal",0);i=r.executeLocal(a),e.count=i.length;y=(g=this.parent.grid.pageSettings.pageSize)*((f=this.parent.grid.pageSettings.currentPage)-1);a=a.skip(y).take(g),i=r.executeLocal(a);var s=this.pageRoot(e.result,i);e.result=s}else{var d=new n.DataManager(e.result),p=new n.Predicate("expanded","notequal",null).or("expanded","notequal",void 0),c=d.executeLocal((new n.Query).where(p)),u=void 0;u=!l(this.parent)||this.parent.searchSettings.key===this.parent.grid.searchSettings.key&&this.parent.filterSettings.columns.length===this.parent.grid.filterSettings.columns.length?c.filter(function(e){return h(t.parent,e,c)}):c,e.count=u.length;var a=new n.Query,g=this.parent.grid.pageSettings.pageSize;this.updatePageSize(e);var f=this.parent.grid.pageSettings.currentPage;u.length<f*g&&(f=(f=Math.floor(u.length/g)+(u.length%g?1:0))||1,this.parent.grid.setProperties({pageSettings:{currentPage:f}},!0));var y=g*(f-1);a=a.skip(y).take(g),d.dataSource.json=u,e.result=d.executeLocal(a)}this.parent.notify("updateAction",e)},e}(),Pe=function(){function e(e){r.Grid.Inject(r.Toolbar),this.parent=e,this.addEventListener()}return e.prototype.getModuleName=function(){return"toolbar"},e.prototype.addEventListener=function(){this.parent.on("rowSelected",this.refreshToolbar,this),this.parent.on("rowDeselected",this.refreshToolbar,this),this.parent.on("toolbarClick",this.toolbarClickHandler,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("rowSelected",this.refreshToolbar),this.parent.off("rowDeselected",this.refreshToolbar),this.parent.off("toolbarClick",this.toolbarClickHandler))},e.prototype.refreshToolbar=function(e){var r=this.parent.grid.toolbarModule.getToolbar();if(!t.isNullOrUndefined(r)){var i=this.parent,n=void 0,o=void 0,a=i.element.id+"_gridcontrol_indent",s=i.element.id+"_gridcontrol_outdent",d=r.querySelector("#"+a),l=r.querySelector("#"+s),p=e.row,h=i.getSelectedRows()[0];if(t.isNullOrUndefined(p[0])||(p=p[0]),p=t.isNullOrUndefined(h)||h.rowIndex===p.rowIndex?p:h,null!==d&&null!==l){if(n=r.querySelector("#"+a).parentElement,o=r.querySelector("#"+s).parentElement,0===p.rowIndex||i.getSelectedRowIndexes().length>1)n.classList.add("e-hidden"),o.classList.add("e-hidden");else if("rowDeselected"!==e.name||!t.isNullOrUndefined(h)&&i.grid.isCheckBoxSelection){var c=i.getCurrentViewRecords()[p.rowIndex];t.isNullOrUndefined(c)||(c.level>i.getCurrentViewRecords()[p.rowIndex-1].level?n.classList.add("e-hidden"):n.classList.remove("e-hidden"),c.level===i.getCurrentViewRecords()[p.rowIndex-1].level&&n.classList.remove("e-hidden"),0===c.level&&o.classList.add("e-hidden"),0!==c.level&&o.classList.remove("e-hidden"))}"rowDeselected"===e.name&&t.isNullOrUndefined(h)&&!i.grid.isCheckBoxSelection&&(this.parent.toolbar.includes("Indent")&&n.classList.add("e-hidden"),this.parent.toolbar.includes("Outdent")&&o.classList.add("e-hidden"))}}},e.prototype.toolbarClickHandler=function(e){var r=this.parent;"Cell"===this.parent.editSettings.mode&&"Batch"===this.parent.grid.editSettings.mode&&e.item.id===this.parent.grid.element.id+"_update"&&(e.cancel=!0,this.parent.grid.editModule.saveCell()),e.item.id===this.parent.grid.element.id+"_expandall"&&this.parent.expandAll(),e.item.id===this.parent.grid.element.id+"_collapseall"&&this.parent.collapseAll(),e.item.id===r.grid.element.id+"_indent"&&r.getSelectedRecords().length&&!t.isNullOrUndefined(r.rowDragAndDropModule)&&this.parent.rowDragAndDropModule.indentOutdentAction(null,"indent"),e.item.id===r.grid.element.id+"_outdent"&&r.getSelectedRecords().length&&!t.isNullOrUndefined(r.rowDragAndDropModule)&&this.parent.rowDragAndDropModule.indentOutdentAction(null,"outdent")},e.prototype.getToolbar=function(){return this.parent.grid.toolbarModule.getToolbar()},e.prototype.enableItems=function(e,t){this.parent.grid.toolbarModule.enableItems(e,t)},e.prototype.destroy=function(){this.removeEventListener()},e}(),Ee=function(){function e(e){r.Grid.Inject(r.Aggregate),this.parent=e,this.flatChildRecords=[],this.summaryQuery=[]}return e.prototype.getModuleName=function(){return"summary"},e.prototype.removeEventListener=function(){this.parent.isDestroyed},e.prototype.calculateSummaryValue=function(e,i,n){this.summaryQuery=e;for(var o,a=[],s=0,d=Object.keys(i).length;s<d;s++)r.getObject("isSummaryRow",i[parseInt(s.toString(),10)])||a.push(i[parseInt(s.toString(),10)]);var l,h=p(a),c=a.slice(),u=Object.keys(this.parent.aggregates).length,g=Object.keys(h).length,f=this.parent.getColumns();if(this.parent.aggregates.filter(function(e){return e.showChildSummary}).length){for(var y=0,d=g;y<d;y++)if(o=h[parseInt(y.toString(),10)],l=this.getChildRecordsLength(o,c)){for(var m=this,v=1,S=u;v<=S;v++)!function(e,i){var a=void 0;a={};for(var s=0;s<f.length;s++)a[""+(t.isNullOrUndefined(r.getObject("field",f[parseInt(s.toString(),10)]))?f[parseInt(s.toString(),10)]:r.getObject("field",f[parseInt(s.toString(),10)]))]=null;if(a=m.createSummaryItem(a,m.parent.aggregates[e-1]),!m.parent.aggregates[e-1].showChildSummary)return"continue";var d;c.map(function(e,t){if(e.uniqueID===o.uniqueID)return void(d=t)});var p=d+l+e,h=t.extend({},o);delete h.childRecords,delete h[m.parent.childMapping],t.setValue("parentItem",h,a);var u=r.getObject("level",h);if(t.setValue("level",u+1,a),t.setValue("isSummaryRow",!0,a),t.setValue("parentUniqueID",h.uniqueID,a),n){var g=r.getObject("childRecords",o);g.length&&g.push(a)}c.splice(p,0,a)}(v);this.flatChildRecords=[]}}else{for(var w={},I=0,R=f.length;I<R;I++)w[""+(t.isNullOrUndefined(r.getObject("field",f[parseInt(I.toString(),10)]))?f[parseInt(I.toString(),10)]:r.getObject("field",f[parseInt(I.toString(),10)]))]=null;for(var v=1,C=u;v<=C;v++)this.createSummaryItem(w,this.parent.aggregates[v-1])}return c},e.prototype.getChildRecordsLength=function(e,i){for(var n,o=0,a=Object.keys(i).length;o<a;o++)if(n=i[parseInt(o.toString(),10)],e===(t.isNullOrUndefined(n.parentItem)?null:i.filter(function(e){return e.uniqueID===n.parentItem.uniqueID})[0])){if(this.flatChildRecords.push(n),!r.getObject("hasChildRecords",n))continue;this.getChildRecordsLength(n,i)}return this.flatChildRecords.length},e.prototype.createSummaryItem=function(e,r){for(var i=0,o=Object.keys(r.columns).length;i<o;i++)for(var a=t.isNullOrUndefined(r.columns[parseInt(i.toString(),10)].columnName)?r.columns[parseInt(i.toString(),10)].field:r.columns[parseInt(i.toString(),10)].columnName,s=0,d=Object.keys(e);s<d.length;s++){var l=d[s];if(l===a)if(this.flatChildRecords.length)e[""+l]=this.getSummaryValues(r.columns[parseInt(i.toString(),10)],this.flatChildRecords);else if(this.parent.isLocalData){var p=this.parent.dataSource instanceof n.DataManager?this.parent.dataSource.dataSource.json:this.parent.flatData;e[""+l]=this.getSummaryValues(r.columns[parseInt(i.toString(),10)],p)}}return e},e.prototype.getSummaryValues=function(e,i){var o=new n.Query,a={},s={},d=t.isNullOrUndefined(e.field)?void 0:this.parent.getColumnByField(e.field).type;e.setPropertiesSilent({format:this.getFormatFromType(e.format,d)}),e.setFormatter(this.parent.grid.locale);var l=e.getFormatter()||function(){return function(e){return e}}();e.setTemplate(s);var p=e.getTemplate(2);o.queries=this.summaryQuery,o.requiresCount();var h,c=new n.DataManager(i).executeLocal(o),u=e.type;u=[e.type];for(var g=0;g<u.length;g++){h=u[parseInt(g.toString(),10)];var f=e.field+" - "+u[parseInt(g.toString(),10)].toLowerCase(),y="Custom"!==u[parseInt(g.toString(),10)]?r.getObject("aggregates",c):r.calculateAggregate(u[parseInt(g.toString(),10)],c,e,this.parent),m=e.columnName,v="Custom"!==u[parseInt(g.toString(),10)]?y[""+f]:y;a[""+m]=a[""+m]||{},a[""+m][""+f]=v,a[""+m][u[parseInt(g.toString(),10)]]=t.isNullOrUndefined(y)?" ":l(v)}s.format=e.getFormatter();var S=t.createElement("td",{className:"e-summary"});if(this.parent.isReact){p.fn(a[e.columnName],this.parent,p.property,"",null,null,S),this.parent.renderReactTemplates()}else r.appendChildren(S,p.fn(a[e.columnName],this.parent,p.property));var w=a[""+e.columnName][""+h];return-1===S.innerHTML.indexOf(w)?S.innerHTML+w:S.innerHTML},e.prototype.getFormatFromType=function(e,r){if(t.isNullOrUndefined(r)||"string"!=typeof e)return e;var i;switch(r){case"number":i={format:e};break;case"datetime":i={type:"dateTime",skeleton:e};break;case"date":i={type:r,skeleton:e}}return i},e.prototype.destroy=function(){this.removeEventListener()},e}(),Ae=function(){function e(e){r.Grid.Inject(r.Sort),this.parent=e,this.taskIds=[],this.flatSortedData=[],this.storedIndex=-1,this.isSelfReference=!t.isNullOrUndefined(this.parent.parentIdMapping),this.addEventListener()}return e.prototype.getModuleName=function(){return"sort"},e.prototype.addEventListener=function(){this.parent.on("updateModel",this.updateModel,this),this.parent.on("createSort",this.createdSortedRecords,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("updateModel",this.updateModel),this.parent.off("createSort",this.createdSortedRecords))},e.prototype.createdSortedRecords=function(e){var t=e.modifiedData,r=e.srtQry;this.iterateSort(t,r),this.storedIndex=-1,e.modifiedData=this.flatSortedData,this.flatSortedData=[]},e.prototype.iterateSort=function(e,r){for(var i=0;i<e.length;i++)if(this.parent.grid.filterSettings.columns.length>0||""!==this.parent.grid.searchSettings.key?t.isNullOrUndefined(y(this.parent,e[parseInt(i.toString(),10)].uniqueID,!0))||(this.storedIndex++,this.flatSortedData[this.storedIndex]=e[parseInt(i.toString(),10)]):(this.storedIndex++,this.flatSortedData[this.storedIndex]=e[parseInt(i.toString(),10)]),e[parseInt(i.toString(),10)].hasChildRecords){var o=new n.DataManager(e[parseInt(i.toString(),10)].childRecords).executeLocal(r);if(this.parent.allowRowDragAndDrop&&-1!==e[parseInt(i.toString(),10)].childRecords.indexOf(this.parent.rowDragAndDropModule.draggedRecord)&&"middleSegment"!==this.parent.rowDragAndDropModule.dropPosition){var a=o.indexOf(this.parent.rowDragAndDropModule.draggedRecord);o.splice(a,1);var s=o.indexOf(this.parent.rowDragAndDropModule.droppedRecord);"topSegment"===this.parent.rowDragAndDropModule.dropPosition?o.splice(s,0,this.parent.rowDragAndDropModule.draggedRecord):"bottomSegment"===this.parent.rowDragAndDropModule.dropPosition&&o.splice(s+1,0,this.parent.rowDragAndDropModule.draggedRecord)}this.iterateSort(o,r)}},e.prototype.sortColumn=function(e,t,r){this.parent.grid.sortColumn(e,t,r)},e.prototype.removeSortColumn=function(e){this.parent.grid.removeSortColumn(e)},e.prototype.updateModel=function(){this.parent.setProperties({sortSettings:r.getActualProperties(this.parent.grid.sortSettings)},!0)},e.prototype.clearSorting=function(){this.parent.grid.clearSorting(),this.updateModel()},e.prototype.destroy=function(){this.removeEventListener()},e}(),Ne=function(){function e(e){r.Grid.Inject(r.ColumnMenu),this.parent=e}return e.prototype.getColumnMenu=function(){return this.parent.grid.columnMenuModule.getColumnMenu()},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"columnMenu"},e}(),ke=function(){function e(e){r.Grid.Inject(r.ContextMenu),this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on("contextMenuOpen",this.contextMenuOpen,this),this.parent.on("contextMenuClick",this.contextMenuClick,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("contextMenuOpen",this.contextMenuOpen),this.parent.off("contextMenuClick",this.contextMenuClick))},e.prototype.contextMenuOpen=function(e){var r=t.select("#"+this.parent.element.id+"_gridcontrol_cmenu_AddRow",e.element),i=t.select("#"+this.parent.element.id+"_gridcontrol_cmenu_Edit",e.element),n=t.select("#"+this.parent.element.id+"_gridcontrol_cmenu_Indent",e.element),o=t.select("#"+this.parent.element.id+"_gridcontrol_cmenu_Outdent",e.element);r&&(!1===this.parent.grid.editSettings.allowAdding||this.parent.grid.isEdit?r.style.display="none":r.style.display="block"),"Cell"!==this.parent.editSettings.mode&&"Batch"!==this.parent.editSettings.mode||t.isNullOrUndefined(i)||i.classList.contains("e-menu-hide")||(i.style.display="none");var a=this.parent,s=a.getSelectedRows()[0];if(!n&&!o||t.isNullOrUndefined(s))a.grid.isEdit&&t.isNullOrUndefined(s)&&(n.style.display="none",o.style.display="none");else{var d=e.event.target.closest("td");if(t.isNullOrUndefined(d)||!t.isNullOrUndefined(d)&&!d.classList.contains("e-rowcell"))n.style.display=o.style.display="none";else if(0===s.rowIndex||a.getSelectedRowIndexes().length>1)n.style.display=o.style.display="none";else if("rowDeselected"!==e.name||!t.isNullOrUndefined(s)&&a.grid.isCheckBoxSelection){var l=a.getCurrentViewRecords()[s.rowIndex];t.isNullOrUndefined(l)||(l.level>a.getCurrentViewRecords()[s.rowIndex-1].level||"Batch"===this.parent.editSettings.mode||"Cell"===this.parent.editSettings.mode?n.style.display="none":n.style.display="block",l.level===a.getCurrentViewRecords()[s.rowIndex-1].level&&"Batch"!==this.parent.editSettings.mode&&"Cell"!==this.parent.editSettings.mode&&(n.style.display="block"),0===l.level||"Batch"===this.parent.editSettings.mode||"Cell"===this.parent.editSettings.mode?o.style.display="none":o.style.display="block")}}},e.prototype.contextMenuClick=function(e){if("Above"!==e.item.id&&"Below"!==e.item.id&&"Child"!==e.item.id||(this.parent.notify("savePreviousRowPosition",e),this.parent.setProperties({editSettings:{newRowPosition:e.item.id}},!0),this.parent.editModule.isAddedRowByContextMenu=!0,this.parent.addRecord()),(e.item.id===this.parent.element.id+"_gridcontrol_cmenu_Indent"||e.item.id===this.parent.element.id+"_gridcontrol_cmenu_Outdent")&&!t.isNullOrUndefined(this.parent.rowDragAndDropModule)){var r=e.item.id===this.parent.element.id+"_gridcontrol_cmenu_Indent"?"indent":"outdent";this.parent.rowDragAndDropModule.indentOutdentAction(null,r)}},e.prototype.getModuleName=function(){return"contextMenu"},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.getContextMenu=function(){return this.parent.grid.contextMenuModule.getContextMenu()},e}(),qe=function(){function e(e){this.batchChildCount=0,this.addedRecords="addedRecords",this.deletedRecords="deletedRecords",this.batchAddedRecords=[],this.batchDeletedRecords=[],this.batchAddRowRecord=[],this.parent=e,this.isSelfReference=!t.isNullOrUndefined(e.parentIdMapping),this.batchRecords=[],this.currentViewRecords=[],this.isAdd=!1,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on("cellSaved",this.cellSaved,this),this.parent.on("batchAdd",this.batchAdd,this),this.parent.on("beforeBatchAdd",this.beforeBatchAdd,this),this.parent.on("batchSave",this.batchSave,this),this.parent.on("beforeBatchDelete",this.beforeBatchDelete,this),this.parent.on("beforeBatchSave",this.beforeBatchSave,this),this.parent.on("batchPageAction",this.batchPageAction,this),this.parent.on("batchCancelAction",this.batchCancelAction,this),this.parent.grid.on("immutable-batch-cancel",this.immutableBatchAction,this),this.parent.grid.on("next-cell-index",this.nextCellIndex,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("cellSaved",this.cellSaved),this.parent.off("batchAdd",this.batchAdd),this.parent.off("batchSave",this.batchSave),this.parent.off("beforeBatchAdd",this.beforeBatchAdd),this.parent.off("beforeBatchDelete",this.beforeBatchDelete),this.parent.off("beforeBatchSave",this.beforeBatchSave),this.parent.off("batchPageAction",this.batchPageAction),this.parent.off("batchCancelAction",this.batchCancelAction),this.parent.grid.off("immutable-batch-cancel",this.immutableBatchAction),this.parent.grid.off("next-cell-index",this.nextCellIndex))},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.getBatchRecords=function(){return this.batchRecords},e.prototype.getAddRowIndex=function(){return this.addRowIndex},e.prototype.getSelectedIndex=function(){return this.selectedIndex},e.prototype.getBatchChildCount=function(){return this.batchChildCount},e.prototype.batchPageAction=function(){var e,r=this.parent.grid.dataSource instanceof n.DataManager?this.parent.grid.dataSource.dataSource.json:this.parent.grid.dataSource,i=this.parent.grid.getPrimaryKeyFieldNames()[0];if(!t.isNullOrUndefined(this.batchAddedRecords)&&this.batchAddedRecords.length)for(var o=0;o<this.batchAddedRecords.length;o++)e=r.map(function(e){return e[""+i]}).indexOf(this.batchAddedRecords[parseInt(o.toString(),10)][""+i]),r.splice(e,1);this.batchAddedRecords=this.batchRecords=this.batchAddRowRecord=this.batchDeletedRecords=this.currentViewRecords=[]},e.prototype.cellSaved=function(e){var i=e.column.index,o=this.parent.frozenColumns||this.parent.getFrozenColumns();if(o&&e.columnObject.index>o&&(i+=o),this.parent.getFrozenLeftColumnsCount()>0||this.parent.getFrozenRightColumnsCount()>0?this.parent.getFrozenLeftColumnsCount()+i===this.parent.treeColumnIndex&&this.parent.renderModule.cellRender({data:e.rowData,cell:e.cell,column:this.parent.grid.getColumnByIndex(e.column.index)}):i===this.parent.treeColumnIndex&&this.parent.renderModule.cellRender({data:e.rowData,cell:e.cell,column:this.parent.grid.getColumnByIndex(e.column.index)}),this.isAdd&&"Batch"===this.parent.editSettings.mode&&"Bottom"!==this.parent.editSettings.newRowPosition){var a=this.parent.grid.dataSource instanceof n.DataManager?this.parent.grid.dataSource.dataSource.json:this.parent.grid.dataSource,s=void 0,d=this.parent.grid.getPrimaryKeyFieldNames()[0],l=void 0,p=void 0,h=this.selectedIndex>-1?this.batchRecords[parseInt(this.addRowIndex.toString(),10)].parentItem:null,u=void 0,f=void 0,y=void 0,m="Top"===this.parent.editSettings.newRowPosition||-1===this.selectedIndex?0:"Above"===this.parent.editSettings.newRowPosition?this.addRowIndex:this.addRowIndex+1;if(m=this.getActualRowObjectIndex(m),this.newBatchRowAdded){if(this.batchRecords.length&&(u=this.batchRecords[this.addRowIndex][this.parent.idMapping],y=this.batchRecords[this.addRowIndex][this.parent.parentIdMapping],this.batchRecords[parseInt(this.addRowIndex.toString(),10)].parentItem&&(f=this.batchRecords[parseInt(this.addRowIndex.toString(),10)].parentItem.uniqueID)),this.batchAddedRecords=g(this.batchAddedRecords),this.batchAddRowRecord=g(this.batchAddRowRecord),this.batchAddRowRecord.push(this.batchRecords[this.addRowIndex]),s=this.parent.grid.getRowsObject()[parseInt(m.toString(),10)].changes,s.uniqueID=r.getUid(this.parent.element.id+"_data_"),t.setValue("uniqueIDCollection."+s.uniqueID,s,this.parent),!Object.prototype.hasOwnProperty.call(s,"level")){if(this.batchIndex=-1===this.selectedIndex?0:this.batchIndex,"Child"===this.parent.editSettings.newRowPosition){if(s.primaryParent=h,this.selectedIndex>-1){s.parentItem=t.extend({},this.batchRecords[this.addRowIndex]),s.parentUniqueID=s.parentItem.uniqueID,delete s.parentItem.childRecords,delete s.parentItem[this.parent.childMapping],s.level=s.parentItem.level+1,s.index=this.batchIndex;var v=c(this.batchRecords[this.addRowIndex]).length,S=c(this.batchRecords[this.addRowIndex])[v-1];S=t.isNullOrUndefined(S)?this.batchRecords[this.addRowIndex]:S,l=a.map(function(e){return e[""+d]}).indexOf(S[""+d]),this.isSelfReference&&(s[this.parent.parentIdMapping]=u),I(d,s.parentItem,"add",this.parent,this.isSelfReference,s)}}else if(("Above"===this.parent.editSettings.newRowPosition||"Below"===this.parent.editSettings.newRowPosition)&&!t.isNullOrUndefined(this.batchRecords[this.addRowIndex])){if(s.level=this.batchRecords[parseInt(this.addRowIndex.toString(),10)].level,s.level&&this.selectedIndex>-1&&(s.parentItem=h,s.parentUniqueID=f,delete s.parentItem.childRecords,delete s.parentItem[this.parent.childMapping]),s.index="Below"===this.parent.editSettings.newRowPosition?this.batchIndex:this.batchIndex-1,"Below"===this.parent.editSettings.newRowPosition&&this.selectedIndex>-1){var v=c(this.batchRecords[this.addRowIndex]).length,S=c(this.batchRecords[this.addRowIndex])[v-1];S=t.isNullOrUndefined(S)?this.batchRecords[this.addRowIndex]:S,l=a.map(function(e){return e[""+d]}).indexOf(S[""+d])}if("Above"===this.parent.editSettings.newRowPosition&&this.selectedIndex>-1){S=this.batchRecords[this.addRowIndex];l=a.map(function(e){return e[""+d]}).indexOf(S[""+d])}this.isSelfReference&&(s[this.parent.parentIdMapping]=y)}s.index=-1===s.index?0:s.index,s.hasChildRecords=!1,s.childRecords=[],this.batchRecords.splice(s.index,0,s),this.currentViewRecords.splice(s.index,0,s),p=l||s.index,"Above"!==this.parent.editSettings.newRowPosition&&(p=0===s.index?p:p+1),a.splice(p,0,s),this.batchAddedRecords.push(s)}this.parent.grid.getRowsObject()[parseInt(m.toString(),10)].data=s,this.newBatchRowAdded=!1}(this.parent.frozenColumns||this.parent.getFrozenColumns()&&"add"===this.parent.grid.getRowsObject()[parseInt(m.toString(),10)].edit)&&t.merge(this.currentViewRecords[parseInt(m.toString(),10)],this.parent.grid.getRowsObject()[parseInt(m.toString(),10)].changes)}},e.prototype.beforeBatchAdd=function(e){if("Cell"===this.parent.editSettings.mode&&this.parent.editModule.isTabLastRow)return e.cancel=!0,void(this.parent.editModule.isTabLastRow=!1);!this.parent.editModule.isAddedRowByMethod||t.isNullOrUndefined(this.parent.editModule.addRowIndex)||this.parent.editModule.isAddedRowByContextMenu||-1!==this.parent.grid.selectedRowIndex&&!this.parent.editModule.batchEditModule.isAdd?(this.selectedIndex=this.parent.grid.selectedRowIndex,this.addRowIndex=this.parent.grid.selectedRowIndex>-1?this.parent.grid.selectedRowIndex:0,this.parent.editModule.addRowIndex=this.parent.grid.selectedRowIndex>-1?this.parent.grid.selectedRowIndex:0,this.addRowRecord=this.parent.getSelectedRecords()[0]):(this.selectedIndex=this.parent.editModule.selectedIndex,this.addRowIndex=this.parent.editModule.addRowIndex,this.addRowRecord=this.batchRecords.length?this.batchRecords[this.selectedIndex]:this.parent.getCurrentViewRecords()[this.selectedIndex])},e.prototype.batchAdd=function(e){if("Bottom"!==this.parent.editSettings.newRowPosition){this.isAdd=!0,this.newBatchRowAdded=!0;var r=0;if(this.batchRecords.length||(this.batchAddedRecords=[],this.batchRecords=g(this.parent.grid.getCurrentViewRecords()),this.currentViewRecords=g(this.parent.grid.getCurrentViewRecords())),this.parent.editModule.isAddedRowByMethod&&!t.isNullOrUndefined(this.parent.editModule.addRowIndex)&&t.classList(this.parent.grid.getDataRows()[0],["e-batchrow"],[]),"Top"!==this.parent.editSettings.newRowPosition){var i=this.parent.grid.getCurrentViewRecords();"Batch"===this.parent.editSettings.mode&&(this.parent.getBatchChanges()[this.addedRecords].length>1||this.parent.getBatchChanges()[this.deletedRecords].length)&&(i=this.batchRecords),this.updateChildCount(i),this.parent.notify("beginAdd",{}),this.batchChildCount=0}this.updateRowIndex();var n=t.getValue("focusModule",this.parent.grid),o=this.parent.getContentTable();if(this.parent.getBatchChanges()[this.deletedRecords].length&&"Above"===this.parent.editSettings.newRowPosition?(r=e.row.rowIndex,n.getContent().matrix.matrix=this.matrix):r=o.getElementsByClassName("e-batchrow")[0].rowIndex,n.getContent().matrix.current=[r,n.getContent().matrix.current[1]],this.parent.editModule.isAddedRowByMethod&&!t.isNullOrUndefined(this.parent.editModule.addRowIndex)&&!this.parent.editModule.isAddedRowByContextMenu){var a=this.parent.getBatchChanges().addedRecords,s=parseInt(this.parent.getContentTable().getElementsByClassName("e-insertedrow")[a.length-1].getAttribute("data-rowindex"),10);this.batchRecords.splice(s,0,a[a.length-1])}}},e.prototype.beforeBatchDelete=function(e){this.batchRecords.length||(this.batchRecords=g(this.parent.grid.getCurrentViewRecords()),this.currentViewRecords=g(this.parent.grid.getCurrentViewRecords()));var r=t.getValue("focusModule",this.parent.grid);this.matrix=r.getContent().matrix.matrix;var i,n,o,a=[],s=[],d=this.parent.grid.getPrimaryKeyFieldNames()[0];t.isNullOrUndefined(e.row)||-1!==this.parent.getSelectedRows().indexOf(e.row)?(n=c(i=this.parent.grid.getSelectedRecords()[this.parent.grid.getSelectedRecords().length-1]),o=this.parent.getSelectedRows()[0].getAttribute("data-uid")):(n=c(i=e.rowData),o=e.row.getAttribute("data-uid"));var l=parseInt(this.parent.grid.getRowElementByUID(o).getAttribute("data-rowindex"),10);if(n.length)for(var p=l+n.length,h=l+1;h<=p;h++)a.push(this.parent.grid.getDataRows()[parseInt(h.toString(),10)]),(this.parent.frozenRows||this.parent.frozenColumns||this.parent.getFrozenColumns())&&a.push(this.parent.grid.getMovableRows()[parseInt(h.toString(),10)]);if(!t.isNullOrUndefined(i.parentItem)){var u=y(this.parent,i.parentItem.uniqueID);if(!t.isNullOrUndefined(u)&&u.hasChildRecords){var f=u.childRecords.indexOf(i);u.childRecords.splice(f,1)}this.batchDeletedRecords=g(this.batchDeletedRecords),this.batchDeletedRecords.push(i)}n.push(i),s=n;for(h=0;h<s.length;h++){var m=this.batchRecords.map(function(e){return e[""+d]}).indexOf(s[parseInt(h.toString(),10)][""+d]);-1!==m&&this.batchRecords.splice(m,1)}for(h=0;h<a.length;h++)t.isNullOrUndefined(a[parseInt(h.toString(),10)])||this.parent.grid.selectionModule.selectedRecords.push(a[parseInt(h.toString(),10)])},e.prototype.updateRowIndex=function(){for(var e=this.parent.grid.getDataRows(),t=0;t<e.length;t++)e[parseInt(t.toString(),10)].setAttribute("data-rowindex",t.toString());var r=this.parent.getFrozenLeftColumnsCount()>0||this.parent.getFrozenRightColumnsCount()>0;if(this.parent.frozenRows||this.parent.getFrozenColumns()||this.parent.frozenColumns||r)for(var i=this.parent.grid.getMovableDataRows(),n=this.parent.grid.getFrozenRightDataRows(),t=0;t<i.length;t++)i[parseInt(t.toString(),10)].setAttribute("data-rowindex",t.toString()),r&&n[parseInt(t.toString(),10)].setAttribute("data-rowindex",t.toString())},e.prototype.updateChildCount=function(e){for(var r=this.parent.grid.getPrimaryKeyFieldNames()[0],i="Child"===this.parent.editSettings.newRowPosition?"primaryParent":"parentItem",n=0;n<this.parent.getBatchChanges().addedRecords.length;n++)t.isNullOrUndefined(this.parent.getBatchChanges().addedRecords[parseInt(n.toString(),10)][""+i])||this.parent.getBatchChanges().addedRecords[parseInt(n.toString(),10)][""+i][""+r]===e[parseInt(this.addRowIndex.toString(),10)][""+r]&&(this.batchChildCount=this.batchChildCount+1)},e.prototype.beforeBatchSave=function(e){var t=e.batchChanges.changedRecords;if(e.batchChanges.changedRecords.length)for(i=0;i<t.length;i++)v({value:t[parseInt(i.toString(),10)],action:"edit"},this.parent,this.isSelfReference,this.addRowIndex,this.selectedIndex,void 0);if(e.batchChanges.deletedRecords.length)for(var r=e.batchChanges.deletedRecords,i=0;i<r.length;i++){this.deleteUniqueID(r[parseInt(i.toString(),10)].uniqueID);for(var n=c(r[parseInt(i.toString(),10)]),o=0;o<n.length;o++)this.deleteUniqueID(n[parseInt(o.toString(),10)].uniqueID);e.batchChanges.deletedRecords=e.batchChanges.deletedRecords.concat(n)}this.isAdd=!1},e.prototype.deleteUniqueID=function(e){delete this.parent.uniqueIDFilterCollection[""+e];delete this.parent.uniqueIDCollection[""+e]},e.prototype.batchCancelAction=function(){var e,r=this.parent.grid.getCurrentViewRecords(),i=this.parent.grid.dataSource instanceof n.DataManager?this.parent.grid.dataSource.dataSource.json:this.parent.grid.dataSource,o=this.parent.grid.getPrimaryKeyFieldNames()[0];if(!t.isNullOrUndefined(this.batchAddedRecords))for(l=0;l<this.batchAddedRecords.length;l++)if(-1!==(e=i.map(function(e){return e[""+o]}).indexOf(this.batchAddedRecords[parseInt(l.toString(),10)][""+o]))&&i.splice(e,1),"Child"===this.parent.editSettings.newRowPosition&&(e=r.map(function(e){return e[""+o]}).indexOf(this.batchAddedRecords[parseInt(l.toString(),10)].parentItem?this.batchAddedRecords[parseInt(l.toString(),10)].parentItem[""+o]:this.batchAddedRecords[parseInt(l.toString(),10)][""+o]),!t.isNullOrUndefined(r[parseInt(e.toString(),10)])))for(var a=r[parseInt(e.toString(),10)].childRecords,s=0;a&&s<a.length;s++)a[parseInt(s.toString(),10)][""+o]===this.batchAddedRecords[parseInt(l.toString(),10)][""+o]&&r[parseInt(e.toString(),10)].childRecords.splice(s,1);if(!t.isNullOrUndefined(this.parent.targetElement)){var d=this.parent.targetElement.closest("tr");this.parent.collapseRow(d),this.parent.targetElement=null}if(!t.isNullOrUndefined(this.batchDeletedRecords))for(var l=0;l<this.batchDeletedRecords.length;l++)if(!t.isNullOrUndefined(this.batchDeletedRecords[parseInt(l.toString(),10)].parentItem)){e=r.map(function(e){return e[""+o]}).indexOf(this.batchDeletedRecords[parseInt(l.toString(),10)].parentItem[""+o]);var p=0===this.batchDeletedRecords[parseInt(l.toString(),10)].index?this.batchDeletedRecords[parseInt(l.toString(),10)].index:this.batchDeletedRecords[parseInt(l.toString(),10)].index-1;t.isNullOrUndefined(r[parseInt(e.toString(),10)])||r[parseInt(e.toString(),10)].childRecords.splice(p,0,this.batchDeletedRecords[parseInt(l.toString(),10)])}this.batchAddedRecords=this.batchRecords=this.batchAddRowRecord=this.currentViewRecords=[],this.batchRecords=g(this.parent.grid.getCurrentViewRecords()),this.batchIndex=0,this.currentViewRecords=g(this.parent.grid.getCurrentViewRecords()),this.batchDeletedRecords=[],this.parent.grid.renderModule.refresh()},e.prototype.batchSave=function(e){if("Batch"===this.parent.editSettings.mode){var r=void 0,i=Object.hasOwnProperty.call(e,"updatedRecords")?e.updatedRecords:this.parent.getBatchChanges(),o=this.parent.grid.dataSource instanceof n.DataManager?this.parent.grid.dataSource.dataSource.json:this.parent.grid.dataSource,a=this.parent.grid.getCurrentViewRecords(),s=this.parent.grid.getPrimaryKeyFieldNames()[0],d=i.addedRecords,l=void 0,p=void 0,h=void 0;if(d.length>1&&"Bottom"!==this.parent.editSettings.newRowPosition&&d.reverse(),"Bottom"!==this.parent.editSettings.newRowPosition&&!Object.hasOwnProperty.call(e,"updatedRecords")){if(o.splice(o.length-d.length,d.length),this.parent.editModule.isAddedRowByMethod&&d.length&&!t.isNullOrUndefined(this.parent.editModule.addRowIndex)&&!this.parent.editModule.isAddedRowByContextMenu){d.reverse();for(var c=0;c<d.length;c++){var u=parseInt(this.parent.getContentTable().getElementsByClassName("e-insertedrow")[parseInt(c.toString(),10)].getAttribute("data-rowindex"),10);o.splice(u,0,d[parseInt(c.toString(),10)])}}if(this.parent.allowPaging||o.length===a.length){var f=g(o);if(f.length){var y=f.map(function(e){return e[""+s]}).indexOf(a[0][""+s]),m=y+this.parent.grid.pageSettings.pageSize;a=f.splice(y,m)}}else a.length>d.length&&a.splice(a.length-d.length,d.length)}for(0===this.batchAddRowRecord.length&&this.batchAddRowRecord.push(this.parent.flatData[e.index]),this.parent.editModule.isAddedRowByContextMenu&&d.reverse(),r=0;r<d.length;r++){var S=t.extend({},d[parseInt(r.toString(),10)]);if(delete S.parentItem,delete S.uniqueID,delete S.index,delete S.level,delete S.hasChildRecords,delete S.childRecords,delete S.parentUniqueID,t.isNullOrUndefined(S.primaryParent)||delete S.primaryParent,d.length>1&&this.parent.editModule.isAddedRowByContextMenu){var w=this.parent.editSettings.newRowPosition;this.parent.editSettings.newRowPosition=this.parent.editModule.previousNewRowPosition,this.parent.editModule.previousNewRowPosition=w}if(d[parseInt(r.toString(),10)].taskData=S,h=this.batchAddRowRecord[parseInt(r.toString(),10)],t.isNullOrUndefined(h)&&(h=this.batchAddRowRecord[r-1]),this.isSelfReference&&(t.isNullOrUndefined(d[parseInt(r.toString(),10)].parentItem)||I(s,d[parseInt(r.toString(),10)].parentItem,"add",this.parent,this.isSelfReference,d[parseInt(r.toString(),10)])),t.isNullOrUndefined(h)||(p=h.index),"Top"!==this.parent.editSettings.newRowPosition&&"Bottom"!==this.parent.editSettings.newRowPosition&&t.isNullOrUndefined(d[parseInt(r.toString(),10)].parentItem)&&-1===this.selectedIndex&&(l=-1,h=null),v({value:d[parseInt(r.toString(),10)],action:"add"},this.parent,this.isSelfReference,p,l,void 0,h),l=null,"Child"===this.parent.editSettings.newRowPosition&&!t.isNullOrUndefined(d[parseInt(r.toString(),10)].parentItem)&&(t.isNullOrUndefined(this.parent.editModule.addRowIndex)||this.isSelfReference))for(var R=a.map(function(e){return e[""+s]}).indexOf(d[parseInt(r.toString(),10)].parentItem[""+s]),C=a[parseInt(R.toString(),10)].childRecords,x=0;x<C.length;x++)C[parseInt(x.toString(),10)][""+s]===d[parseInt(r.toString(),10)][""+s]&&a[parseInt(R.toString(),10)].childRecords.splice(x,1)}if(i.deletedRecords.length)for(r=0;r<i.deletedRecords.length;r++)v({value:i.deletedRecords[parseInt(r.toString(),10)],action:"delete"},this.parent,this.isSelfReference,p,l,void 0,h);this.parent.parentData=[];for(var b=0;b<o.length;b++)o[parseInt(b.toString(),10)].index=b,t.setValue("uniqueIDCollection."+o[parseInt(b.toString(),10)].uniqueID+".index",b,this.parent),o[parseInt(b.toString(),10)].level||this.parent.parentData.push(o[parseInt(b.toString(),10)])}this.batchAddRowRecord=this.batchAddedRecords=this.batchRecords=this.batchDeletedRecords=this.currentViewRecords=[],this.parent.editModule.isAddedRowByContextMenu&&(this.parent.editModule.isAddedRowByContextMenu=!1)},e.prototype.getActualRowObjectIndex=function(e){var r=this.parent.grid.getDataRows();return("Below"===this.parent.editSettings.newRowPosition||"Child"===this.parent.editSettings.newRowPosition)&&this.selectedIndex>-1&&(!t.isNullOrUndefined(this.batchRecords[this.addRowIndex])&&this.batchRecords[this.addRowIndex].expanded&&(this.parent.getBatchChanges()[this.addedRecords].length>1||this.parent.getBatchChanges()[this.deletedRecords].length?(e+=c(this.batchRecords[this.addRowIndex]).length,"Child"!==this.parent.editSettings.newRowPosition&&(e+=this.getBatchChildCount())):e+=c(this.batchRecords[this.addRowIndex]).length),e>=r.length&&(e=r.length-1),this.updateChildCount(this.parent.grid.getCurrentViewRecords()),this.batchChildCount&&(e+=this.batchChildCount),this.batchChildCount=0),e},e.prototype.immutableBatchAction=function(e){e.args.cancel=!0;var t=this.parent.grid.getBatchChanges(),r=[];Object.keys(t).length&&(r=t.addedRecords);for(var i=0;i<r.length;i++)e.rows.splice(r[parseInt(i.toString(),10)].index,1)},e.prototype.nextCellIndex=function(e){this.parent.getSelectedRows().length?e.index=this.parent.getSelectedRows()[0].rowIndex:e.index=this.batchIndex},e}(),Ue=function(){function e(e){this.addedRecords="addedRecords",this.deletedRecords="deletedRecords",this.prevAriaRowIndex="-1",this.isAddedRowByMethod=!1,this.isAddedRowByContextMenu=!1,r.Grid.Inject(r.Edit),this.parent=e,this.isSelfReference=!t.isNullOrUndefined(e.parentIdMapping),this.previousNewRowPosition=null,this.internalProperties={},this.batchEditModule=new qe(this.parent),this.addEventListener()}return e.prototype.getModuleName=function(){return"edit"},e.prototype.addEventListener=function(){this.parent.on("crudAction",this.crudAction,this),this.parent.on("beginEdit",this.beginEdit,this),this.parent.on("beginAdd",this.beginAdd,this),this.parent.on("recordDoubleClick",this.recordDoubleClick,this),this.parent.on("cellSave",this.cellSave,this),this.parent.on("batchCancel",this.batchCancel,this),this.parent.grid.on("key-pressed",this.keyPressed,this),this.parent.grid.on("batchedit-form",this.lastCellTab,this),this.parent.grid.on("content-ready",this.contentready,this),this.parent.on("cellEdit",this.cellEdit,this),this.parent.on("actionBegin",this.editActionEvents,this),this.parent.on("actionComplete",this.editActionEvents,this),this.parent.grid.on("double-tap",this.recordDoubleClick,this),this.parent.grid.on("dblclick",this.gridDblClick,this),this.parent.grid.on("recordAdded",this.customCellSave,this),this.parent.on("savePreviousRowPosition",this.savePreviousRowPosition,this),this.parent.grid.on("edit-form",this.beforeStartEdit,this),this.parent.grid.on("before-batch-cancel",this.beforeBatchCancel,this),this.parent.grid.on("reset-edit-props",this.resetIsOnBatch,this),this.parent.grid.on("get-row-position",this.getRowPosition,this)},e.prototype.gridDblClick=function(e){this.doubleClickTarget=e.target},e.prototype.getRowPosition=function(e){e.newRowPosition=this.parent.editSettings.newRowPosition,e.addRowIndex=this.addRowIndex,e.dataRowIndex=+this.prevAriaRowIndex},e.prototype.beforeStartEdit=function(e){this.parent.trigger("actionBegin",e)},e.prototype.beforeBatchCancel=function(e){"Cell"===this.parent.editSettings.mode&&this.parent.trigger("actionComplete",e)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("crudAction",this.crudAction),this.parent.off("beginEdit",this.beginEdit),this.parent.off("beginAdd",this.beginAdd),this.parent.off("recordDoubleClick",this.recordDoubleClick),this.parent.off("batchCancel",this.batchCancel),this.parent.grid.off("key-pressed",this.keyPressed),this.parent.grid.off("batchedit-form",this.lastCellTab),this.parent.grid.off("content-ready",this.contentready),this.parent.off("cellEdit",this.cellEdit),this.parent.off("actionBegin",this.editActionEvents),this.parent.off("actionComplete",this.editActionEvents),this.parent.grid.off("recordAdded",this.customCellSave),this.parent.grid.off("double-tap",this.recordDoubleClick),this.parent.off("savePreviousRowPosition",this.savePreviousRowPosition),this.parent.grid.off("edit-form",this.beforeStartEdit),this.parent.grid.off("before-batch-cancel",this.beforeBatchCancel),this.parent.grid.off("dblclick",this.gridDblClick),this.parent.grid.off("reset-edit-props",this.resetIsOnBatch),this.parent.grid.off("get-row-position",this.getRowPosition))},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.applyFormValidation=function(e){this.parent.grid.editModule.applyFormValidation(e)},e.prototype.editActionEvents=function(e){var i=r.getObject("editAction",e),o=r.getObject("name",i),s=this.parent,d=s.dataSource.adaptor;if((a(s)||d instanceof n.RemoteSaveAdaptor)&&"save"===i.requestType&&"add"===i.action&&("Child"===s.editSettings.newRowPosition||"Below"===s.editSettings.newRowPosition||"Above"===s.editSettings.newRowPosition))if("actionBegin"===o){var l=t.isNullOrUndefined(i.row)||!Object.keys(i.row).length?this.selectedIndex:i.row.rowIndex-1,p=t.isNullOrUndefined(l)||-1===l?-1:s.getCurrentViewRecords()[parseInt(l.toString(),10)][s.getPrimaryKeyFieldNames()[0]];s.grid.query.addParams("relationalKey",p)}else if("actionComplete"===o)for(var h=s.grid.query.params.length,c=0;c<h;c++)"relationalKey"===s.grid.query.params[parseInt(c.toString(),10)].key&&s.grid.query.params.splice(c);this.parent.enableInfiniteScrolling&&"actionComplete"===o&&this.infiniteAddAction(i),"Batch"===this.parent.editSettings.mode&&"paging"===i.requestType&&this.parent.notify("batchPageAction",{})},e.prototype.infiniteAddAction=function(e){if("save"===e.requestType&&"add"===e.action||"delete"===e.requestType){if("Top"!==this.parent.editSettings.newRowPosition&&-1!==this.selectedIndex&&"save"===e.requestType&&"add"===e.action){var t=this.parent.grid.getRowsObject(),i=t.splice(0,1)[0],n=this.addRowIndex,o=this.parent.getCurrentViewRecords();"Below"!==this.parent.editSettings.newRowPosition&&"Child"!==this.parent.editSettings.newRowPosition||(n+=c(o[n+1]).length),n="Below"===this.parent.editSettings.newRowPosition?n+1:n,t.splice(n,0,i);var a=o.splice(0,1)[0];o.splice(n,0,a),this.updateInfiniteCurrentViewData(a,this.addRowIndex)}var s=this.parent.grid.getMovableRows(),d=this.parent.grid.getMovableRowsObject(),l=this.parent.infiniteScrollSettings.enableCache;l||(r.resetRowIndex(this.parent.grid,this.parent.grid.getRowsObject(),this.parent.grid.getRows(),0),this.updateIndex(this.parent.grid.dataSource,this.parent.getRows(),this.parent.getCurrentViewRecords())),!l&&this.parent.getFrozenColumns()>0&&(r.resetRowIndex(this.parent.grid,d,s,0),this.updateIndex(this.parent.grid.dataSource,s,this.parent.getCurrentViewRecords()))}},e.prototype.updateInfiniteCurrentViewData=function(e,r){var i=this,n=Math.ceil(r/this.parent.grid.pageSettings.pageSize),o=n>0?n:1,a=r-(o-1)*this.parent.pageSettings.pageSize,s=this.parent.grid.infiniteScrollModule.infiniteCurrentViewData;s[1].splice(0,1);var d=s[parseInt(o.toString(),10)];t.isNullOrUndefined(this.addRowRecord)||(d.filter(function(e,t){e.uniqueID===i.addRowRecord.uniqueID&&(a=t)}),(this.addRowRecord.hasChildRecords&&this.addRowRecord.childRecords.length&&"Below"===this.parent.editSettings.newRowPosition||"Child"===this.parent.editSettings.newRowPosition)&&(a+=c(this.addRowRecord).length)),a>=this.parent.pageSettings.pageSize&&(o+=1,d=s[parseInt(o.toString(),10)],a=a-this.parent.pageSettings.pageSize>=0?a-this.parent.pageSettings.pageSize:0),a="Below"===this.parent.editSettings.newRowPosition?a+1:a,d.splice(a,0,e),this.parent.grid.infiniteScrollModule.updateCurrentViewData()},e.prototype.recordDoubleClick=function(e){var i=e.target;if(!t.isNullOrUndefined(i.closest("td.e-rowcell"))&&this.parent.grid.editSettings.allowEditing&&!this.parent.grid.isEdit){var n=this.parent.grid.getColumnByIndex(+i.closest("td.e-rowcell").getAttribute("data-colindex"));if("Cell"===this.parent.editSettings.mode&&!this.isOnBatch&&n&&!n.isPrimaryKey&&this.parent.editSettings.allowEditing&&n.allowEditing&&!i.classList.contains("e-treegridexpand")&&!i.classList.contains("e-treegridcollapse")&&this.parent.editSettings.allowEditOnDblClick){if(this.isOnBatch=!0,this.parent.grid.setProperties({selectedRowIndex:e.rowIndex},!0),this.parent.enableVirtualization){var o=r.parentsUntil(e.target,"e-row");this.prevAriaRowIndex=o.getAttribute("data-rowindex"),o.setAttribute("data-rowindex",o.rowIndex+"")}this.updateGridEditMode("Batch")}else"Cell"!==this.parent.editSettings.mode||n.allowEditing&&!n.isPrimaryKey||(this.isOnBatch=!0,this.updateGridEditMode("Batch"))}},e.prototype.updateGridEditMode=function(e){this.parent.grid.setProperties({editSettings:{mode:e}},!0),r.getObject("updateEditObj",this.parent.grid.editModule).apply(this.parent.grid.editModule),this.parent.grid.isEdit=!1},e.prototype.resetIsOnBatch=function(){this.parent.enableVirtualization&&"Cell"===this.parent.editSettings.mode&&(this.isOnBatch=!1,this.updateGridEditMode("Normal"))},e.prototype.keyPressed=function(e){this.isOnBatch&&(this.keyPress=e.action),"f2"===e.action&&this.recordDoubleClick(e),"escape"===e.action&&this.parent.closeEdit()},e.prototype.deleteUniqueID=function(e){delete this.parent.uniqueIDFilterCollection[""+e];delete this.parent.uniqueIDCollection[""+e]},e.prototype.cellEdit=function(e){var r=this,i=e.promise;if(delete e.promise,this.parent.enableVirtualization&&!t.isNullOrUndefined(this.prevAriaRowIndex)&&"-1"!==this.prevAriaRowIndex&&(e.row.setAttribute("data-rowindex",this.prevAriaRowIndex),this.prevAriaRowIndex=void 0),"enter"!==this.keyPress&&this.parent.trigger("cellEdit",e,function(e){e.cancel||"Cell"!==r.parent.editSettings.mode?e.cancel&&"Cell"===r.parent.editSettings.mode&&(r.isOnBatch=!1,r.updateGridEditMode("Normal")):r.enableToolbarItems("edit"),t.isNullOrUndefined(i)||i.resolve(e)}),this.doubleClickTarget&&(this.doubleClickTarget.classList.contains("e-treegridexpand")||this.doubleClickTarget.classList.contains("e-treegridcollapse")||this.doubleClickTarget.classList.contains("e-summarycell")))return e.cancel=!0,void(this.doubleClickTarget=null);"Cell"===this.parent.editSettings.mode&&("tab"===this.keyPress||"shiftTab"===this.keyPress?this.keyPress=null:"enter"===this.keyPress&&(e.cancel=!0,this.keyPress=null,t.setValue("isEditCollapse",!1,this.parent)),e.columnObject.allowEditing||(e.cancel=!0)),this.parent.enableVirtualization&&(this.parent.grid.contentModule.editedRowIndex=this.parent.grid.editModule.editModule.index)},e.prototype.enableToolbarItems=function(e){if(!t.isNullOrUndefined(this.parent.grid.toolbarModule)){var r=this.parent.element.id+"_gridcontrol_";this.parent.grid.toolbarModule.enableItems([r+"add",r+"edit",r+"delete"],"save"===e),this.parent.grid.toolbarModule.enableItems([r+"update",r+"cancel"],"edit"===e)}},e.prototype.batchCancel=function(){if("Cell"===this.parent.editSettings.mode){var e=t.getValue("editModule.cellDetails",this.parent.grid.editModule),r=this.parent.getCellFromIndex(e.rowIndex,this.parent.treeColumnIndex);this.parent.renderModule.cellRender({data:e.rowData,cell:r,column:this.parent.grid.getColumns()[this.parent.treeColumnIndex]}),this.updateGridEditMode("Normal"),this.isOnBatch=!1}"Batch"===this.parent.editSettings.mode&&this.parent.notify("batchCancelAction",{})},e.prototype.customCellSave=function(e){s(this.parent)&&"Cell"===this.parent.editSettings.mode&&"edit"===e.action&&(this.updateCell(e,e.rowIndex),this.afterCellSave(e,e.row,e.rowIndex))},e.prototype.cellSave=function(e){var r=this;if("Cell"===this.parent.editSettings.mode&&this.parent.element.querySelector("form")){e.cancel=!0;t.setValue("isEdit",!1,this.parent.grid),t.setValue("isEditCollapse",!0,this.parent),e.rowData[e.columnName]=e.value;var i;i=t.isNullOrUndefined(e.cell)?this.parent.grid.editModule.editModule.form.parentElement.parentNode:e.cell.parentNode;var o,d=this.parent.getPrimaryKeyFieldNames();if(t.isNullOrUndefined(i))this.parent.grid.getCurrentViewRecords().filter(function(t,r){if(t[d[0]]===e.rowData[d[0]])return void(o=r)});else{var l=this.parent.getFrozenLeftColumnsCount()>0||this.parent.getFrozenRightColumnsCount()>0;o=l?-1!==this.parent.getRows().indexOf(i)?this.parent.getRows().indexOf(i):-1!==this.parent.getFrozenRightRows().indexOf(i)?this.parent.getFrozenRightRows().indexOf(i):this.parent.getMovableRows().indexOf(i):-1===this.parent.getRows().indexOf(i)&&this.parent.getFrozenColumns()>0?this.parent.grid.getMovableRows().indexOf(i):this.parent.getRows().indexOf(i)}var p={};if(t.extend(p,e),p.cancel=!1,p.type="save",i=this.parent.grid.getRows()[i.rowIndex],this.parent.trigger("actionBegin",p),p.cancel)this.parent.grid.isEdit=!0;else if(i.rowIndex===this.parent.getCurrentViewRecords().length-1&&"tab"===this.keyPress&&(this.isTabLastRow=!0),a(this.parent)||this.parent.dataSource instanceof n.DataManager&&this.parent.dataSource.adaptor instanceof n.RemoteSaveAdaptor){if(a(this.parent)||this.parent.dataSource instanceof n.DataManager&&this.parent.dataSource.adaptor instanceof n.RemoteSaveAdaptor){var h=this.parent.grid.query;this.parent.grid.dataSource.update(d[0],e.rowData,h.fromTable,h,e.previousValue).then(function(n){t.isNullOrUndefined(n)||(e.rowData[e.columnName]=n[e.columnName]),r.updateCell(e,o),r.afterCellSave(e,i,o)})}}else if(s(this.parent)){var c={requestType:"save",data:e.rowData,action:"edit",row:i,rowIndex:o,rowData:e.rowData,columnName:e.columnName,filterChoiceCount:null,excelSearchOperator:null};this.parent.grid.getDataModule().eventPromise(c,this.parent.grid.query)}else this.updateCell(e,o),this.afterCellSave(e,i,o)}this.parent.enableVirtualization&&(this.parent.grid.contentModule.virtualData={})},e.prototype.afterCellSave=function(e,r,i){var n;this.parent.grid.aggregateModule&&this.parent.grid.aggregateModule.refresh(e.rowData),this.parent.grid.editModule.destroyWidgets([this.parent.grid.getColumnByField(e.columnName)]),this.parent.grid.editModule.formObj.destroy(),"tab"!==this.keyPress&&"shiftTab"!==this.keyPress&&(this.updateGridEditMode("Normal"),this.isOnBatch=!1),this.enableToolbarItems("save"),this.parent.getFrozenLeftColumnsCount()>0||this.parent.getFrozenRightColumnsCount()>0?(n=e.cell.closest(".e-frozen-left-header")||e.cell.closest(".e-frozen-left-content")?this.parent.grid.getRows()[parseInt(i.toString(),10)]:e.cell.closest(".e-movableheader")||e.cell.closest(".e-movablecontent")?this.parent.grid.getMovableRows()[parseInt(i.toString(),10)]:this.parent.grid.getFrozenRightRows()[parseInt(i.toString(),10)],t.removeClass([n],["e-editedrow","e-batchrow"]),t.removeClass(n.querySelectorAll(".e-rowcell"),["e-editedbatchcell","e-updatedtd"])):this.parent.getFrozenColumns()>0&&(n=e.cell.closest(".e-frozenheader")||e.cell.closest(".e-frozencontent")?this.parent.grid.getRows()[parseInt(i.toString(),10)]:this.parent.grid.getMovableRows()[parseInt(i.toString(),10)],t.removeClass([n],["e-editedrow","e-batchrow"]),t.removeClass(n.querySelectorAll(".e-rowcell"),["e-editedbatchcell","e-updatedtd"])),t.removeClass([r],["e-editedrow","e-batchrow"]),t.removeClass(r.querySelectorAll(".e-rowcell"),["e-editedbatchcell","e-updatedtd"]),!1!==this.parent.isCellSaveFocus&&this.parent.grid.focusModule.restoreFocus(),v({value:e.rowData,action:"edit"},this.parent,this.isSelfReference,this.addRowIndex,this.selectedIndex,e.columnName),r.rowIndex===this.parent.getCurrentViewRecords().length-1&&"enter"===this.keyPress&&(this.keyPress=null);var o={type:"save",column:this.parent.getColumnByField(e.columnName),data:e.rowData,previousData:e.previousValue,row:r,target:e.cell};this.parent.aggregates.map(function(e){return!0===e.showChildSummary}).length&&this.parent.grid.refresh(),this.parent.trigger("actionComplete",o)},e.prototype.lastCellTab=function(){!this.parent.grid.isEdit&&this.isOnBatch&&"tab"===this.keyPress&&"Cell"===this.parent.editSettings.mode&&(this.parent.editSettings.allowNextRowEdit?this.enableToolbarItems("edit"):(this.updateGridEditMode("Normal"),this.isOnBatch=!1,this.keyPress=null))},e.prototype.updateCell=function(e,t){this.parent.grid.editModule.updateCell(t,e.columnName,e.rowData[e.columnName]),this.parent.grid.getRowsObject()[parseInt(t.toString(),10)].data=e.rowData},e.prototype.crudAction=function(e,r){v(e,this.parent,this.isSelfReference,this.addRowIndex,this.selectedIndex,r,this.addRowRecord),this.parent.parentData=[];for(var i=this.parent.grid.dataSource instanceof n.DataManager?this.parent.grid.dataSource.dataSource.json:this.parent.grid.dataSource,o=0;o<i.length;o++){i[parseInt(o.toString(),10)].index=o;var s=this.parent.grid.getPrimaryKeyFieldNames()[0];e.value[""+s]===i[parseInt(o.toString(),10)][""+s]&&"add"===e.action&&(i[parseInt(o.toString(),10)].level=this.internalProperties.level,i[parseInt(o.toString(),10)].taskData=this.internalProperties.taskData,i[parseInt(o.toString(),10)].uniqueID=this.internalProperties.uniqueID,t.isNullOrUndefined(this.internalProperties.parentItem)||(i[parseInt(o.toString(),10)].parentItem=this.internalProperties.parentItem,i[parseInt(o.toString(),10)].parentUniqueID=this.internalProperties.parentUniqueID),i[parseInt(o.toString(),10)].childRecords=this.internalProperties.childRecords),t.setValue("uniqueIDCollection."+i[parseInt(o.toString(),10)].uniqueID+".index",o,this.parent);var d=this.parent.dataSource.adaptor;(a(this.parent)||d instanceof n.RemoteSaveAdaptor)&&t.setValue("uniqueIDCollection."+i[parseInt(o.toString(),10)].uniqueID,i[parseInt(o.toString(),10)],this.parent),i[parseInt(o.toString(),10)].level||this.parent.parentData.push(i[parseInt(o.toString(),10)])}this.parent.enableInfiniteScrolling||"add"===e.action&&null!=this.previousNewRowPosition&&(this.parent.setProperties({editSettings:{newRowPosition:this.previousNewRowPosition}},!0),this.previousNewRowPosition=null)},e.prototype.updateIndex=function(e,r,i){for(var n=0;n<this.parent.getDataRows().length;n++){var o=i[parseInt(n.toString(),10)];if(!t.isNullOrUndefined(o)){u=t.getValue("uniqueIDCollection."+o.uniqueID+".index",this.parent);if(o.index=u,!t.isNullOrUndefined(o.parentItem)){var a=t.getValue("uniqueIDCollection."+o.parentItem.uniqueID+".index",this.parent);o.parentItem.index=a}}}var s=-1,d=this.parent.treeColumnIndex;if(this.parent.getFrozenColumns()>0)for(var l=r[0].querySelectorAll(".e-rowcell"),p=0;p<l.length;p++)if(l[parseInt(p.toString(),10)].classList.contains("e-gridrowindex0level0")){d=p;break}for(var h=0;h<this.parent.getRows().length;h++){r[parseInt(h.toString(),10)].classList.contains("e-detailrow")||s++;var c=i[parseInt(s.toString(),10)];if(!t.isNullOrUndefined(c)){var u=c.index,g=c.level,f=r[parseInt(h.toString(),10)];t.isNullOrUndefined(c.parentItem)||(u=t.getValue("uniqueIDCollection."+c.parentItem.uniqueID+".index",this.parent));var y=f.cells[parseInt(d.toString(),10)];if(!t.isNullOrUndefined(y)){for(p=0;p<y.classList.length;p++){var m=y.classList[parseInt(p.toString(),10)],v=m.match(/e-gridrowindex/i),S=m.match(/e-griddetailrowindex/i);null!=v&&t.removeClass([y],m),null!=S&&t.removeClass([y],m)}r[parseInt(h.toString(),10)].classList.contains("e-detailrow")?t.addClass([y],"e-griddetailrowindex"+u+"level"+g):t.addClass([y],"e-gridrowindex"+u+"level"+g)}}}},e.prototype.beginAdd=function(){var e,r=this.addRowIndex,i=this.parent.grid.getCurrentViewRecords();"Batch"===this.parent.editSettings.mode&&(r=this.batchEditModule.getAddRowIndex(),this.selectedIndex=this.batchEditModule.getSelectedIndex(),(this.parent.getBatchChanges()[this.addedRecords].length>1||this.parent.getBatchChanges()[this.deletedRecords].length)&&(i=this.batchEditModule.getBatchRecords()));var n=this.parent.grid.getDataRows(),o=n.length?+n[0].getAttribute("data-rowindex"):0,a=n.length?+n[n.length-1].getAttribute("data-rowindex"):0,s=this.selectedIndex>=o&&this.selectedIndex<=a,d=this.parent.enableVirtualization&&this.addRowIndex>-1&&"-1"!==this.prevAriaRowIndex;if("Dialog"!==this.parent.editSettings.mode&&("Above"===this.parent.editSettings.newRowPosition?e="before":("Below"===this.parent.editSettings.newRowPosition||"Child"===this.parent.editSettings.newRowPosition)&&(this.selectedIndex>-1||d)&&s&&(e="after",!t.isNullOrUndefined(i[parseInt(r.toString(),10)])&&i[parseInt(r.toString(),10)].expanded&&("Batch"===this.parent.editSettings.mode&&(this.parent.getBatchChanges()[this.addedRecords].length>1||this.parent.getBatchChanges()[this.deletedRecords].length)?(r+=c(i[parseInt(r.toString(),10)]).length,"Child"!==this.parent.editSettings.newRowPosition&&(r+=this.batchEditModule.getBatchChildCount())):r+=c(i[parseInt(r.toString(),10)]).length)),(this.selectedIndex>-1||d)&&s&&(r||"Child"===this.parent.editSettings.newRowPosition||"Below"===this.parent.editSettings.newRowPosition))){r>=n.length-1&&(r=n.length-2);var l="rows",p=this.parent.grid.contentModule[""+l][0],h=document.activeElement;n[r+1][""+e](n[0]),t.setValue("batchIndex",r+1,this.batchEditModule);var u="Above"===this.parent.editSettings.newRowPosition?r:r+1;"Batch"===this.parent.editSettings.mode&&(this.parent.grid.contentModule[""+l].splice(0,1),this.parent.grid.contentModule[""+l].splice(u,0,p));var g=this.parent.getFrozenLeftColumnsCount()>0||this.parent.getFrozenRightColumnsCount()>0;if(this.parent.frozenRows||this.parent.getFrozenColumns()||this.parent.frozenColumns||g){var f=this.parent.getMovableDataRows(),y=this.parent.grid.getRowsObject()[0];if(f[r+1][""+e](f[0]),g){var m=this.parent.getFrozenRightDataRows();m[r+1][""+e](m[0])}"Batch"===this.parent.editSettings.mode&&(this.parent.grid.contentModule.freezeRows.splice(0,1),this.parent.grid.contentModule.freezeRows.splice(u,0,y)),t.setValue("batchIndex",r+1,this.batchEditModule)}if("Row"===this.parent.editSettings.mode||"Cell"===this.parent.editSettings.mode){for(var v=this.parent.grid.getContentTable().querySelectorAll(".e-griderror"),S=0;S<v.length;S++)v[parseInt(S.toString(),10)].remove();t.setValue("errorRules",[],this.parent.grid.editModule.formObj)}d&&(this.prevAriaRowIndex="-1"),(!this.parent.enableVirtualization||this.parent.enableVirtualization&&!Object.keys(this.parent.grid.contentModule.emptyRowData).length)&&h.focus(),this.parent.enableVirtualization&&!Object.keys(this.parent.grid.contentModule.emptyRowData).length&&this.parent.grid.contentModule.createEmptyRowdata()}if("Batch"===this.parent.editSettings.mode&&!t.isNullOrUndefined(this.addRowIndex)&&-1!==this.addRowIndex&&this.isAddedRowByMethod&&!this.isAddedRowByContextMenu){r=this.batchEditModule.getAddRowIndex(),this.selectedIndex=this.batchEditModule.getSelectedIndex();var w=this.parent.getBatchChanges().addedRecords,I=void 0;if(w.length)for(S=0;S<w.length;S++)t.isNullOrUndefined(w[parseInt(S.toString(),10)].uniqueID)&&(I=w[parseInt(S.toString(),10)]);var R={action:"add",data:I,index:r,seletedRow:0};this.beginAddEdit(R),this.batchEditModule.batchAddRowRecord.push(this.batchEditModule.addRowRecord),this.batchEditModule.batchAddedRecords.push(R.data)}},e.prototype.beginEdit=function(e){if("refresh"===e.requestType&&this.isOnBatch)return void(e.cancel=!0);if("Cell"===this.parent.editSettings.mode&&"beginEdit"===e.requestType)return void(e.cancel=!0);if(this.doubleClickTarget&&(this.doubleClickTarget.classList.contains("e-treegridexpand")||this.doubleClickTarget.classList.contains("e-treegridcollapse")||this.doubleClickTarget.classList.contains("e-frame")))return e.cancel=!0,void(this.doubleClickTarget=null);if("delete"===e.requestType){var r=e.data;if(t.isNullOrUndefined(e.data[0].uniqueID))for(var i=this.parent.getPrimaryKeyFieldNames(),n=this,o=0;o<r.length;o++)!function(t){n.parent.flatData.filter(function(n){n[""+i[0]]===e.data[parseInt(t.toString(),10)][i[0]]&&(r[parseInt(t.toString(),10)]=n)})}(o);for(o=0;o<r.length;o++){this.deleteUniqueID(r[parseInt(o.toString(),10)].uniqueID);for(var a=c(r[parseInt(o.toString(),10)]),s=0;s<a.length;s++)this.deleteUniqueID(a[parseInt(s.toString(),10)].uniqueID);e.data=e.data.concat(a)}}if("add"===e.requestType||this.isAddedRowByMethod&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)){if((-1===this.parent.grid.selectedRowIndex&&this.isAddedRowByMethod||e.index!==this.parent.grid.selectedRowIndex)&&0!==e.index||(this.selectedIndex=this.parent.grid.selectedRowIndex),this.parent.enableVirtualization){var d='.e-row[data-rowindex="'+this.selectedIndex+'"]',l=void 0;this.selectedIndex>-1&&"Top"!==this.parent.editSettings.newRowPosition&&"Bottom"!==this.parent.editSettings.newRowPosition?(this.prevAriaRowIndex=this.selectedIndex.toString(),l=this.parent.getContent().querySelector(d),this.addRowIndex=l?l.rowIndex:0):this.prevAriaRowIndex&&"-1"!==this.prevAriaRowIndex?(d='.e-row[data-rowindex="'+this.prevAriaRowIndex+'"]',l=this.parent.getContent().querySelector(d),this.addRowIndex=l?l.rowIndex:0):this.addRowIndex=0}else this.isAddedRowByMethod&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)?0!==e.index?this.addRowIndex=e.index:this.addRowIndex=this.parent.grid.selectedRowIndex:this.addRowIndex=this.parent.grid.selectedRowIndex>-1?this.parent.grid.selectedRowIndex:0;this.isAddedRowByMethod&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)?(this.addRowRecord=this.parent.flatData[this.parent.grid.selectedRowIndex],this.parent.enableVirtualization&&this.isAddedRowByContextMenu&&(this.addRowRecord=this.parent.getCurrentViewRecords()[this.addRowIndex])):this.addRowRecord=this.parent.getSelectedRecords()[0]}this.isAddedRowByMethod&&0!==e.index&&(this.addRowRecord=this.parent.flatData[e.index],this.addRowIndex=e.index),"Child"===this.parent.editSettings.newRowPosition&&t.isNullOrUndefined(this.addRowRecord)&&!t.isNullOrUndefined(this.parent.getSelectedRecords()[0])&&(this.addRowRecord=this.parent.getSelectedRecords()[0]),this.isAddedRowByMethod=!1,e=this.beginAddEdit(e)},e.prototype.savePreviousRowPosition=function(){null===this.previousNewRowPosition&&(this.previousNewRowPosition=this.parent.editSettings.newRowPosition)},e.prototype.beginAddEdit=function(e){var i=e.data;if("add"===e.action){var o=this.parent.grid.getPrimaryKeyFieldNames()[0],a=null;i.taskData=t.isNullOrUndefined(i.taskData)?t.extend({},e.data):i.taskData;var s=void 0;s=this.parent.enableVirtualization&&0!==e.index?this.parent.flatData:"Batch"===this.parent.editSettings.mode&&this.isAddedRowByMethod&&!t.isNullOrUndefined(this.addRowIndex)?this.batchEditModule.batchRecords:this.parent.grid.getCurrentViewRecords(),this.parent.enableVirtualization&&0!==e.index&&(this.addRowIndex=this.parent.flatData.indexOf(this.addRowRecord),this.selectedIndex=this.addRowIndex);var d=this.addRowIndex;i.uniqueID=r.getUid(this.parent.element.id+"_data_"),t.setValue("uniqueIDCollection."+i.uniqueID,i,this.parent);var l=0,p=void 0,h=void 0,u=void 0,g=void 0,f=this.parent.enableVirtualization&&this.addRowIndex>-1&&"-1"!==this.prevAriaRowIndex,m=this.parent.getRows(),v=m.length?s.indexOf(s[0]):0,S=m.length?+m[m.length-1].getAttribute("data-rowindex"):0,w=!(!this.parent.enableVirtualization||0===e.index)||this.selectedIndex>=v&&this.selectedIndex<=S;if(s.length&&(p=s[this.addRowIndex][this.parent.idMapping],g=s[this.addRowIndex][this.parent.parentIdMapping],s[this.addRowIndex].parentItem&&(h=s[this.addRowIndex].parentItem.uniqueID),u=s[this.addRowIndex].parentItem),"Top"!==this.parent.editSettings.newRowPosition&&s.length){if(l=s[this.addRowIndex].level,"Above"===this.parent.editSettings.newRowPosition)a="before",d=s[this.addRowIndex].index;else if("Below"===this.parent.editSettings.newRowPosition){a="after";var R=c(s[this.addRowIndex]).length,C=s[this.addRowIndex].index;d=R>0?C+R:C}else if("Child"===this.parent.editSettings.newRowPosition){a="after",(this.selectedIndex>-1||f)&&w&&(i.parentItem=t.extend({},s[this.addRowIndex]),i.parentUniqueID=i.parentItem.uniqueID,delete i.parentItem.childRecords,delete i.parentItem[this.parent.childMapping]);var x=c(s[this.addRowIndex]).length,b=s[this.addRowIndex].index;this.selectedIndex>=0&&(i.level=l+1),d=x>0?b+x:b,this.isSelfReference&&(this.parent.isLocalData||-1!==this.parent.editModule.selectedIndex?i.taskData[this.parent.parentIdMapping]=i[this.parent.parentIdMapping]=p:i.taskData[this.parent.parentIdMapping]=i[this.parent.parentIdMapping]=null,t.isNullOrUndefined(i.parentItem)||I(o,i.parentItem,"add",this.parent,this.isSelfReference,i))}if("Above"!==this.parent.editSettings.newRowPosition&&"Below"!==this.parent.editSettings.newRowPosition||((this.selectedIndex>-1||f)&&l&&w&&(i.parentUniqueID=h,i.parentItem=t.extend({},u),delete i.parentItem.childRecords,delete i.parentItem[this.parent.childMapping]),i.level=l,this.isSelfReference&&(i.taskData[this.parent.parentIdMapping]=i[this.parent.parentIdMapping]=g,t.isNullOrUndefined(i.parentItem)||I(o,i.parentItem,"add",this.parent,this.isSelfReference,i))),null!=a&&(this.selectedIndex>-1||f)&&w&&(e.index="before"===a?d:d+1),"Bottom"===this.parent.editSettings.newRowPosition){var D=this.parent.grid.dataSource instanceof n.DataManager?this.parent.grid.dataSource.dataSource.json:this.parent.grid.dataSource;e.index=D.length}}t.isNullOrUndefined(i.level)&&(i.level=l),i.hasChildRecords=!1,i.childRecords=[],i.index=0}if("add"===e.action&&(this.internalProperties={level:i.level,parentItem:i.parentItem,uniqueID:i.uniqueID,taskData:i.taskData,parentUniqueID:t.isNullOrUndefined(i.parentItem)?void 0:i.parentItem.uniqueID,childRecords:i.childRecords}),"delete"===e.requestType)for(var M=e.data,O=0;O<M.length;O++)if(M[parseInt(O.toString(),10)].parentItem){u=y(this.parent,M[parseInt(O.toString(),10)].parentItem.uniqueID);if(!t.isNullOrUndefined(u)&&u.hasChildRecords){var P=u.childRecords.indexOf(M[parseInt(O.toString(),10)]);u.childRecords.splice(P,1)}}return e},e.prototype.addRecord=function(e,r,i){if(this.parent.editSettings.newRowPosition!==this.previousNewRowPosition&&null!==this.previousNewRowPosition||(this.previousNewRowPosition=this.parent.editSettings.newRowPosition),this.isSelfReference||t.isNullOrUndefined(e)||!Object.hasOwnProperty.call(e,this.parent.childMapping))e?(r>-1?(this.selectedIndex=r,this.addRowIndex=r):(this.selectedIndex=this.parent.selectedRowIndex,this.addRowIndex=this.parent.selectedRowIndex),i&&this.parent.setProperties({editSettings:{newRowPosition:i}},!0),this.parent.grid.editModule.addRecord(e,r)):this.parent.grid.editModule.addRecord(e,r);else{var n=[],o=this.parent.editSettings.mode,a=this.parent.grid.editSettings.mode;n.push(e),this.parent.setProperties({editSettings:{mode:"Batch"}},!0),this.parent.grid.setProperties({editSettings:{mode:"Batch"}},!0),t.isNullOrUndefined(i)||this.parent.setProperties({editSettings:{newRowPosition:i}},!0);var s={addedRecords:n,changedRecords:[],deletedRecords:[]};this.parent.notify("batchSave",{updatedRecords:s,index:r}),this.parent.setProperties({editSettings:{mode:o}},!0),this.parent.grid.setProperties({editSettings:{mode:a}},!0),this.parent.refresh()}},e.prototype.editFormValidate=function(){return this.parent.grid.editModule.editFormValidate()},e.prototype.destroyForm=function(){this.parent.grid.editModule.destroyForm()},e.prototype.contentready=function(e){t.isNullOrUndefined(e.args.requestType)||"delete"!==e.args.requestType.toString()&&"save"!==e.args.requestType.toString()&&("Batch"!==this.parent.editSettings.mode||"batchsave"!==e.args.requestType.toString())||(this.updateIndex(this.parent.grid.dataSource,this.parent.getRows(),this.parent.getCurrentViewRecords()),(this.parent.frozenRows||this.parent.getFrozenColumns()||this.parent.frozenColumns)&&this.parent.grid.dataSource.length===this.parent.getMovableDataRows().length&&this.updateIndex(this.parent.grid.dataSource,this.parent.getMovableDataRows(),this.parent.getCurrentViewRecords()))},e.prototype.editCell=function(e,t){"Cell"!==this.parent.editSettings.mode&&"Batch"!==this.parent.editSettings.mode||("Batch"!==this.parent.editSettings.mode&&(this.isOnBatch=!0,this.updateGridEditMode("Batch")),this.parent.grid.editModule.editCell(e,t))},e}(),Ve=function(){function e(e){r.Grid.Inject(r.CommandColumn),this.parent=e}return e.prototype.getModuleName=function(){return"commandColumn"},e.prototype.destroy=function(){},e}(),Be=function(){function e(e){r.Grid.Inject(r.DetailRow),this.parent=e,this.addEventListener()}return e.prototype.getModuleName=function(){return"detailRow"},e.prototype.addEventListener=function(){this.parent.on("dataBoundArg",this.dataBoundArg,this),this.parent.on("detaildataBound",this.detaildataBound,this),this.parent.grid.on("detail-indentcell-info",this.setIndentVisibility,this),this.parent.on("childRowExpand",this.childRowExpand,this),this.parent.on("rowExpandCollapse",this.rowExpandCollapse,this),this.parent.on("actioncomplete",this.actioncomplete,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("dataBoundArg",this.dataBoundArg),this.parent.off("detaildataBound",this.detaildataBound),this.parent.off("childRowExpand",this.childRowExpand),this.parent.off("rowExpandCollapse",this.rowExpandCollapse),this.parent.off("actioncomplete",this.actioncomplete),this.parent.grid.off("detail-indentcell-info",this.setIndentVisibility))},e.prototype.setIndentVisibility=function(e){e.visible=!1},e.prototype.dataBoundArg=function(){for(var e=this.parent.getRows().filter(function(e){return!e.classList.contains("e-detailrow")}),i=0;i<e.length;i++){var n=e[parseInt(i.toString(),10)].getElementsByClassName("e-detailrowcollapse"),o=this.parent.grid.getRowObjectFromUID(e[parseInt(i.toString(),10)].getAttribute("data-Uid")),a=r.getObject("parentItem",this.parent.grid.getCurrentViewRecords()[parseInt(i.toString(),10)]);(t.isNullOrUndefined(a)||!t.isNullOrUndefined(a)&&h(this.parent,o.data,this.parent.grid.getCurrentViewRecords()))&&this.parent.grid.detailRowModule.expand(n[0])}},e.prototype.childRowExpand=function(e){var r=e.row.getElementsByClassName("e-detailrowcollapse");t.isNullOrUndefined(r[0])||this.parent.grid.detailRowModule.expand(r[0])},e.prototype.rowExpandCollapse=function(e){if(!a(this.parent))for(var t=0;t<e.detailrows.length;t++)e.detailrows[parseInt(t.toString(),10)].style.display=e.action},e.prototype.detaildataBound=function(e){var r=e.data,i=e.detailElement.parentElement.previousSibling,n="e-gridrowindex"+(t.isNullOrUndefined(r.parentItem)?r.index:r.parentItem.index)+"level"+r.level,o=i.querySelector("."+n).classList,a=[].slice.call(o).filter(function(e){return e===n}),s=a[0].length,d="e-griddetail"+a.toString().slice(6,s);t.addClass([e.detailElement.parentElement],d)},e.prototype.actioncomplete=function(e){if("beginEdit"===e.requestType||"add"===e.requestType){var t=e.row.querySelectorAll(".e-editcell")[0].getAttribute("colSpan"),i=(parseInt(t,10)-1).toString();e.row.querySelectorAll(".e-editcell")[0].setAttribute("colSpan",i)}for(var n=this.parent.grid.contentModule.getRows(),o=0;o<n.length;o++)n[parseInt(o.toString(),10)].cells[0].visible=!1;r.getObject("focusModule",this.parent.grid).refreshMatrix(!0)({rows:this.parent.grid.contentModule.getRows()})},e.prototype.destroy=function(){this.removeEventListener()},e}(),Te=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ze=function(e){function i(t,r){var i=e.call(this,t,r)||this;return i.isExpandCollapse=!1,i.translateY=0,i.maxiPage=0,i.recordAdded=!1,i.startIndex=-1,i.endIndex=-1,i.preTranslate=0,i.isRemoteExpand=!1,i.isDataSourceChanged=!1,i.addEventListener(),i}return Te(i,e),i.prototype.getModelGenerator=function(){return new xe(this.parent)},i.prototype.getRowByIndex=function(e){return this.parent.getDataRows().filter(function(t){return parseInt(t.getAttribute("data-rowindex"),10)===e})[0]},i.prototype.getMovableVirtualRowByIndex=function(e){return this.getRowCollection(e,!0)},i.prototype.getFrozenRightVirtualRowByIndex=function(e){return this.getRowCollection(e,!1,!1,!0)},i.prototype.getRowCollection=function(e,t,r,i){var n=parseInt(this.parent.getRows()[0].getAttribute("data-rowindex"),10),o=t?this.parent.getMovableDataRows():this.parent.getDataRows();o=i?this.parent.getFrozenRightDataRows():o;var a=(r?this.parent.getCurrentViewRecords():o)[e-n];return this.parent.frozenRows&&this.parent.pageSettings.currentPage>1&&(a=r?e<=this.parent.frozenRows?this.parent.getRowsObject()[parseInt(e.toString(),10)].data:a:e<=this.parent.frozenRows?o[parseInt(e.toString(),10)]:o[e-n+this.parent.frozenRows]),a},i.prototype.addEventListener=function(){this.parent.on("virtual-action-args",this.virtualOtherAction,this),this.parent.on("index-modifier",this.indexModifier,this)},i.prototype.virtualOtherAction=function(e){e.setTop?(this.translateY=0,this.startIndex=0,this.endIndex=this.parent.pageSettings.pageSize-1):e.isExpandCollapse&&(this.isExpandCollapse=!0)},i.prototype.indexModifier=function(e){var t=this.parent.getContent().querySelector(".e-content");if(this.recordAdded&&this.startIndex>-1&&this.endIndex>-1){if(this.endIndex>e.count-this.parent.pageSettings.pageSize){var r=~~(t.scrollTop/this.parent.getRowHeight()),i=r+this.parent.getRows().length;i>e.count&&(i=r+(e.count-r)),this.startIndex=i-this.parent.getRows().length,this.endIndex=i}else("Top"!==this.parent.root.editSettings.newRowPosition&&-1!==this.parent.root.editModule.selectedIndex||-1!==this.parent.root.editModule.selectedIndex)&&(this.startIndex+=1,this.endIndex+=1);this.recordAdded=!1}this.isDataSourceChanged&&(this.startIndex=0,this.endIndex=this.parent.pageSettings.pageSize-1),e.startIndex=this.startIndex,e.endIndex=this.endIndex},i.prototype.eventListener=function(t){var r=this;this.parent.dataSource instanceof n.DataManager&&void 0!==this.parent.dataSource.dataSource.url&&this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url&&s(this.parent)?e.prototype.eventListener.call(this,"on"):(this.parent[""+t]("data-ready",this.onDataReady,this),this.parent[""+t]("refresh-virtual-block",this.refreshContentRows,this),this.fn=function(){r.observers.observes(function(e){return r.scrollListeners(e)},r.onEnteredAction(),r.parent),r.parent.off("content-ready",r.fn)},this.parent.addEventListener("dataBound",this.dataBoundEvent.bind(this)),this.parent.addEventListener("rowSelected",this.rowSelectedEvent.bind(this)),this.parent[""+t]("select-virtual-Row",this.toSelectVirtualRow,this),this.parent.on("content-ready",this.fn,this),this.parent.addEventListener("actionComplete",this.onActionComplete.bind(this)),this.parent[""+t]("virtual-scroll-edit-action-begin",this.beginEdit,this),this.parent[""+t]("virtual-scroll-add-action-begin",this.beginAdd,this),this.parent[""+t]("virtual-scroll-edit-success",this.virtualEditSuccess,this),this.parent[""+t]("edit-reset",this.resetIseditValue,this),this.parent[""+t]("get-virtual-data",this.getData,this),this.parent[""+t]("virtual-scroll-edit-cancel",this.cancelEdit,this),this.parent[""+t]("select-row-on-context-open",this.toSelectRowOnContextOpen,this),this.parent[""+t]("refresh-virtual-editform-cells",this.refreshCell,this),this.parent[""+t]("virtaul-cell-focus",this.cellFocus,this))},i.prototype.cellFocus=function(t){e.prototype.virtualCellFocus.call(this,t)},i.prototype.onDataReady=function(r){if(e.prototype.onDataReady.call(this,r),!(this.parent.dataSource instanceof n.DataManager&&void 0!==this.parent.dataSource.dataSource.url&&this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url&&s(this.parent))){if(!t.isNullOrUndefined(r.count)){if(this.totalRecords=r.count,this.parent.isFrozenGrid()&&r.count<Object.keys(this.parent.dataSource).length){var i=this.parent.enableColumnVirtualization?this.getColumnOffset(this.parent.columns.length-1)+"px":"100%",o=this.parent.getRowHeight()*r.count-this.parent.getRowHeight()*this.parent.pageSettings.pageSize;t.getValue("virtualEle",this).setVirtualHeight(o,i)}this.parent.enableColumnVirtualization||this.parent.isFrozenGrid()||t.getValue("virtualEle",this).setVirtualHeight(this.parent.getRowHeight()*r.count,"100%")}(!t.isNullOrUndefined(r.requestType)&&"collapseAll"===r.requestType.toString()||this.isDataSourceChanged&&(-1===this.startIndex||0===this.startIndex&&0===this.preStartIndex))&&(this.contents.scrollTop=0,this.isDataSourceChanged=!1)}},i.prototype.renderTable=function(){e.prototype.renderTable.call(this),this.parent.dataSource instanceof n.DataManager&&void 0!==this.parent.dataSource.dataSource.url&&this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url&&s(this.parent)||(t.getValue("observer",this).options.debounceEvent=!1,this.observers=new Le(t.getValue("observer",this).element,t.getValue("observer",this).options),this.contents=this.getPanel().firstChild)},i.prototype.getTranslateY=function(t,r,i,o){return this.parent.dataSource instanceof n.DataManager&&void 0!==this.parent.dataSource.dataSource.url&&!this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url||s(this.parent)?this.isRemoteExpand?(this.isRemoteExpand=!1,this.preTranslate):(this.preTranslate=e.prototype.getTranslateY.call(this,t,r,i,o),e.prototype.getTranslateY.call(this,t,r,i,o)):e.prototype.getTranslateY.call(this,t,r,i,o)},i.prototype.dataBoundEvent=function(){if(!t.isNullOrUndefined(this.parent.getRowByIndex(0))&&this.parent.getRows().length&&!this.initialRowTop){var r=this.parent.getRowByIndex(0).getBoundingClientRect().top,i=this.parent.element.getBoundingClientRect().top;this.initialRowTop=r>0?this.parent.getRowByIndex(0).getBoundingClientRect().top-i:this.content.getBoundingClientRect().top-this.parent.getRowByIndex(0).getBoundingClientRect().height}e.prototype.dataBound.call(this)},i.prototype.rowSelectedEvent=function(t){e.prototype.rowSelected.call(this,t)},i.prototype.toSelectVirtualRow=function(r){if(!this.parent.isEdit){t.isNullOrUndefined(this.observer.containerRect)&&(this.observer.containerRect=this.observers.containerRect),(t.isNullOrUndefined(this.parent.clipboardModule.treeGridParent.editModule)||0!==r.selectedIndex||t.isNullOrUndefined(this.parent.clipboardModule.treeGridParent.editModule.addRowIndex))&&e.prototype.selectVirtualRow.call(this,r)}},i.prototype.refreshCell=function(e){e.cells=this.generateCells()},i.prototype.generateCells=function(){for(var e=[],t=0;t<this.parent.columns.length;t++)e.push(this.generateCell(this.parent.columns[parseInt(t.toString(),10)]));return e},i.prototype.generateCell=function(e,i,n,o,a,s){var d={visible:e.visible,isDataCell:!t.isNullOrUndefined(e.field||e.template),isTemplate:!t.isNullOrUndefined(e.template),rowID:i,column:e,cellType:t.isNullOrUndefined(n)?r.CellType.Data:n,colSpan:o,commands:e.commands,isForeignKey:e.isForeignColumn&&e.isForeignColumn(),foreignKeyData:e.isForeignColumn&&e.isForeignColumn()&&t.getValue(e.field,s)};return(d.isDataCell||"checkbox"===d.column.type||d.commands)&&(d.index=a),new r.Cell(d)},i.prototype.beginEdit=function(e){this.editedRowIndex=e.index;var t='.e-row[data-rowindex="'+e.index+'"]',r=this.parent.getContent().querySelector(t).rowIndex,i=this.parent.getCurrentViewRecords()[parseInt(r.toString(),10)];e.data=i},i.prototype.beginAdd=function(t){var r={newRowPosition:this.rowPosition,addRowIndex:this.addRowIndex,dataRowIndex:this.dataRowIndex};this.parent.notify("get-row-position",r),this.rowPosition=r.newRowPosition,this.addRowIndex=r.addRowIndex,this.dataRowIndex=r.dataRowIndex;var i=this.parent.getRows(),n=i.length?+i[0].getAttribute("data-rowindex"):0,o=i.length?+i[i.length-1].getAttribute("data-rowindex"):0,a=this.parent.selectedRowIndex>=n&&this.parent.selectedRowIndex<=o;"Top"!==this.rowPosition&&"Bottom"!==this.rowPosition&&(this.isAdd=!0),"Top"!==this.rowPosition&&"Bottom"!==this.rowPosition&&(this.addRowIndex&&-1!==this.addRowIndex||-1!==this.parent.selectedRowIndex&&a)||e.prototype.addActionBegin.call(this,t)},i.prototype.restoreEditState=function(){e.prototype.restoreEdit.call(this)},i.prototype.resetIseditValue=function(){this.parent.notify("reset-edit-props",{}),"Top"!==this.rowPosition&&"Bottom"!==this.rowPosition||!this.isAdd||e.prototype.resetIsedit.call(this)},i.prototype.virtualEditSuccess=function(){var e=this.parent.getContent().querySelector(".e-content");this.isAdd&&e.querySelector(".e-addedrow")&&(this.recordAdded=!0)},i.prototype.cancelEdit=function(t){e.prototype.editCancel.call(this,t)},i.prototype.toSelectRowOnContextOpen=function(t){e.prototype.selectRowOnContextOpen.call(this,t)},i.prototype.restoreNewRow=function(){var e=this.parent.getContent().querySelector(".e-content");this.isAdd&&!e.querySelector(".e-addedrow")&&(this.parent.isEdit=!1,this.parent.editModule.addRecord(null,this.parent.root.editModule.selectedIndex))},i.prototype.getData=function(t){e.prototype.getVirtualData.call(this,t)},i.prototype.onActionComplete=function(t){if("add"===t.requestType){var r={newRowPosition:this.rowPosition,addRowIndex:this.addRowIndex,dataRowIndex:this.dataRowIndex};this.parent.notify("get-row-position",r),this.rowPosition=r.newRowPosition,this.addRowIndex=r.addRowIndex,this.dataRowIndex=this.parent.root.editModule.selectedIndex}e.prototype.actionComplete.call(this,t)},i.prototype.onEnteredAction=function(){var e=this;return function(r,i,n,o,a,s){if(!e.parent.directVirtualRender){!t.Browser.isIE||a||!s||e.preventEvent||e.parent.enableVirtualMaskRow||e.parent.showSpinner(),e.parent.enableVirtualMaskRow&&!e.preventEvent&&setTimeout(function(){e.parent.showMaskRow(i.axis),e.parent.notify("showGanttShimmer",{requestType:"showShimmer"})},0);var d=e.content.getBoundingClientRect().height,l=e.prevInfo.offsets?e.prevInfo.offsets.top:null,p="X"===i.axis,h=e.getColumnOffset(p?e.vgenerator.getColumnIndexes()[0]-1:e.prevInfo.columnIndexes[0]-1);if(p){var c=Object.keys(e.vgenerator.cOffsets).length-e.prevInfo.columnIndexes.length,u=e.vgenerator.cOffsets[c-1];h=h>u?u:h}var g=e.getTranslateY(o.top,d,p&&l===o.top?e.prevInfo:void 0,!0);if(!e.parent.isFrozenGrid()||e.parent.enableVirtualMaskRow){if(e.parent.enableVirtualMaskRow){var f=o.top-e.translateY<0;g=Math.round(e.translateY)>g&&!f?Math.round(e.translateY):g,e.virtualEle.adjustTable(h,g)}else e.virtualEle.adjustTable(h,e.translateY);e.parent.enableColumnVirtualization&&e.header.virtualEle.adjustTable(h,0)}}}},i.prototype.scrollListeners=function(e){this.scrollAfterEdit();var r=e.sentinel,i=this.parent.getRowHeight(),o=this.parent.pageSettings.pageSize-Math.ceil(this.parent.pageSettings.pageSize/2),a=this.parent.getContent().querySelector(".e-content"),d=o*i,l=e.offset.top-this.translateY<0,p=Math.ceil(e.offset.top-this.translateY)+i>=d,h=this.parent.currentViewData;if(l&&"right"!==e.direction&&"left"!==e.direction){var c=+(this.parent.height.toString().indexOf("%")<0?this.parent.height:this.parent.element.getBoundingClientRect().height),u=~~(a.scrollTop/i)+Math.ceil(c/i)-this.parent.pageSettings.pageSize;if(u=u>0?u:0,t.isNullOrUndefined(this.selectedRowIndex)||-1===this.selectedRowIndex||u===this.selectedRowIndex||(u=this.selectedRowIndex),this.startIndex=u,this.endIndex=u+this.parent.pageSettings.pageSize,this.endIndex>this.totalRecords){var g=this.totalRecords-1,f=this.endIndex%g;this.endIndex=g,this.startIndex=this.startIndex-f<0?0:this.startIndex-f}h.length&&h[0].index>=this.parent.pageSettings.pageSize/2&&h[0].index-this.startIndex<this.parent.pageSettings.pageSize/2&&(this.startIndex=h[0].index-this.parent.pageSettings.pageSize/2,this.endIndex=this.startIndex+this.parent.pageSettings.pageSize);var y=Math.ceil(e.offset.top/i);y%=this.parent.pageSettings.pageSize;var m=0;t.isNullOrUndefined(this.parent.getRows()[parseInt(y.toString(),10)])||t.isNullOrUndefined(this.parent.getContent().querySelectorAll(".e-content tr")[parseInt(y.toString(),10)])||(m=+this.parent.getContent().querySelectorAll(".e-content tr")[parseInt(y.toString(),10)].querySelector("td").getAttribute("index")),0===m?this.parent.allowRowDragAndDrop?this.translateY=e.offset.top-2*i:this.translateY=e.offset.top:this.translateY=e.offset.top-o*i>0?e.offset.top-o*i+10:0}else if(p&&"right"!==e.direction&&"left"!==e.direction){var v=~~(a.scrollTop/i),S=!(this.selectedRowIndex+this.parent.pageSettings.pageSize<this.totalRecords);t.isNullOrUndefined(this.selectedRowIndex)||-1===this.selectedRowIndex||v===this.selectedRowIndex||S||(v=this.selectedRowIndex);var w=v+this.parent.pageSettings.pageSize;w>this.totalRecords&&(w=v+(this.totalRecords-v)),this.startIndex=S?v:w-this.parent.pageSettings.pageSize,this.endIndex=w,h.length&&this.startIndex>h[0].index&&this.startIndex-h[0].index<this.parent.pageSettings.pageSize/2&&(this.startIndex=h[0].index+this.parent.pageSettings.pageSize/2),e.offset.top>i*this.totalRecords?this.translateY=this.getTranslateY(e.offset.top,a.getBoundingClientRect().height):this.parent.allowRowDragAndDrop?this.translateY=e.offset.top-2*i:this.translateY=e.offset.top}if(p&&e.offset.top<i*this.totalRecords||l||"right"===e.direction||"left"===e.direction||this.parent.dataSource instanceof n.DataManager&&void 0!==this.parent.dataSource.dataSource.url&&!this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url&&(p||l)||s(this.parent)){var I=this.currentInfo=t.getValue("getInfoFromView",this).apply(this,[e.direction,r,e.offset]);this.previousInfo=I,this.parent.setColumnIndexesInView(this.parent.enableColumnVirtualization?I.columnIndexes:[]);var R=I.loadNext&&!I.loadSelf?I.nextInfo.page:I.page;this.parent.setProperties({pageSettings:{currentPage:R}},!0),this.requestType="virtualscroll","right"!==e.direction&&"left"!==e.direction&&(I.event="refresh-virtual-block"===I.event?"model-changed":I.event),this.parent.enableVirtualMaskRow&&(this.parent.showMaskRow(r.axis),this.parent.addShimmerEffect(),this.parent.notify("showGanttShimmer",{requestType:"showShimmer"})),this.parent.notify(I.event,{requestType:"virtualscroll",virtualInfo:I,focusElement:e.focusElement})}else this.parent.enableVirtualMaskRow&&(this.parent.removeMaskRow(),this.parent.notify("removeGanttShimmer",{requestType:"hideShimmer"}))},i.prototype.appendContent=function(r,i,o){var a=this.parent.isFrozenGrid();if(this.parent.dataSource instanceof n.DataManager&&void 0!==this.parent.dataSource.dataSource.url&&!this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url||s(this.parent)||this.parent.isFrozenGrid())t.getValue("isExpandCollapse",o)&&(this.isRemoteExpand=!0),a&&(t.isNullOrUndefined(this.requestType)&&-1===t.getValue("requestTypes",this).indexOf("isFrozen")||this.parent.enableVirtualMaskRow&&"virtualscroll"===this.requestType)&&(t.getValue("requestTypes",this).push("isFrozen"),this.requestType="isFrozen"),e.prototype.appendContent.call(this,r,i,o),-1!==t.getValue("requestTypes",this).indexOf("isFrozen")&&(t.getValue("requestTypes",this).splice(t.getValue("requestTypes",this).indexOf("isFrozen"),1),this.requestType="isFrozen"===this.requestType?void 0:this.requestType),!a||this.isExpandCollapse&&0!==this.translateY?this.isExpandCollapse=!1:(this.translateY=this.translateY<0?0:this.translateY,t.getValue("virtualEle",this).adjustTable(0,this.translateY));else{var d=o.virtualInfo.sentinelInfo&&"Y"===o.virtualInfo.sentinelInfo.axis&&t.getValue("currentInfo",this).page&&t.getValue("currentInfo",this).page!==o.virtualInfo.page?t.getValue("currentInfo",this):o.virtualInfo,l=d.columnIndexes[0]-1,p=this.getColumnOffset(l),h=void 0;if(this.parent.enableColumnVirtualization){this.header.virtualEle.adjustTable(p,0);var c=d.columnIndexes;h=this.getColumnOffset(c[c.length-1])-this.getColumnOffset(c[0]-1)+"",this.header.virtualEle.setWrapperWidth(h)}this.virtualEle.setWrapperWidth(h,t.Browser.isIE||"edge"===t.Browser.info.name),(r=this.parent.createElement("tbody")).appendChild(i);this.getTable().querySelector("tbody").replaceWith(r),this.isExpandCollapse&&0!==this.translateY?this.isExpandCollapse=!1:(this.translateY=this.translateY<0?0:this.translateY,t.getValue("virtualEle",this).adjustTable(p,this.translateY)),t.setValue("prevInfo",this.previousInfo?this.previousInfo:d,this),"virtualscroll"===o.requestType&&"X"===o.virtualInfo.sentinelInfo.axis&&this.parent.notify("auto-col",{});e.prototype.focusCell.call(this,o);this.isAdd&&!this.parent.getContent().querySelector(".e-content").querySelector(".e-addedrow")&&"Top"!==this.rowPosition&&"Bottom"!==this.rowPosition&&(this.dataRowIndex>=this.startIndex?this.restoreNewRow():this.addRowIndex&&this.addRowIndex>-1&&(this.isAdd=!1,this.parent.isEdit=!1)),this.restoreEditState(),e.prototype.restoreAdd.call(this),e.prototype.ensureSelectedRowPosition.call(this)}},i.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("data-ready",this.onDataReady),this.parent.off("content-ready",this.fn),this.parent.off("select-virtual-Row",this.toSelectVirtualRow),this.parent.off("dataBound",this.dataBoundEvent),this.parent.off("rowSelected",this.rowSelectedEvent),this.parent.off("virtual-action-args",this.virtualOtherAction),this.parent.off("index-modifier",this.indexModifier),this.parent.off("virtual-scroll-edit-action-begin",this.beginEdit),this.parent.off("virtual-scroll-add-action-begin",this.beginAdd),this.parent.off("virtual-scroll-edit-success",this.virtualEditSuccess),this.parent.off("edit-reset",this.resetIseditValue),this.parent.off("get-virtual-data",this.getData),this.parent.off("virtual-scroll-edit-cancel",this.cancelEdit),this.parent.off("select-row-on-context-open",this.toSelectRowOnContextOpen),this.parent.off("refresh-virtual-editform-cells",this.refreshCell),this.parent.off("virtaul-cell-focus",this.cellFocus))},i}(r.VirtualContentRenderer),Le=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.isWheeling=!1,t.newPos=0,t.lastPos=0,t.timer=0,t}return Te(r,e),r.prototype.observes=function(r,i,n){if(e.prototype.containerRect=t.getValue("options",this).container.getBoundingClientRect(),t.EventHandler.add(t.getValue("options",this).container,"scroll",this.virtualScrollHandlers(r,i,n),this),t.getValue("options",this).movableContainer){e.prototype.movableContainerRect=t.getValue("options",this).movableContainer.getBoundingClientRect(),t.EventHandler.add(t.getValue("options",this).movableContainer,"scroll",this.virtualScrollHandlers(r,i,n),this)}},r.prototype.clear=function(){this.lastPos=null},r.prototype.virtualScrollHandlers=function(e,r,i){var o=this,a="chrome"===t.Browser.info.name?200:100,d=t.debounce(e,a),l=t.debounce(e,50);return this.options.prevTop=this.options.prevLeft=0,function(t){var a=o.options.movableContainer?o.options.container.scrollTop:t.target.scrollTop,p=o.options.movableContainer?o.options.scrollbar.scrollLeft:t.target.scrollLeft,h=o.options.prevTop<a?"down":"up";h=o.options.prevLeft===p?h:o.options.prevLeft<p?"right":"left",o.options.prevTop=a,o.options.prevLeft=p;var c=o.sentinelInfo[""+h],u=0;if(o.newPos=a,null!=o.lastPos&&(u=o.newPos-o.lastPos),o.lastPos=o.newPos,o.timer&&clearTimeout(o.timer),o.timer=setTimeout(o.clear,0),(u>100||u<-100)&&t&&t.preventDefault&&(t.returnValue=!1,t.preventDefault()),-1!==o.options.axes.indexOf(c.axis)){var g=o.check(h);if(c.entered&&("X"===c.axis||i.enableVirtualMaskRow)&&(!o.movableEle||"right"!==h&&"left"!==h?r(o.element,c,h,{top:a,left:p},o.fromWheel,g):r(o.movableEle,c,h,{top:a,left:p},o.fromWheel,g)),g){var f=l;"X"===c.axis?f({direction:h,sentinel:c,offset:{top:a,left:p},focusElement:document.activeElement}):i.dataSource instanceof n.DataManager&&void 0!==i.dataSource.dataSource.url&&!i.dataSource.dataSource.offline&&""!==i.dataSource.dataSource.url||s(i)||i.enableVirtualMaskRow?(f=i.enableVirtualMaskRow?d:f)({direction:h,sentinel:c,offset:{top:a,left:p},focusElement:document.activeElement}):e({direction:h,sentinel:c,offset:{top:a,left:p},focusElement:document.activeElement})}o.fromWheel=!1}}},r}(r.InterSectionObserver),Fe=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),je=function(){function e(e){this.prevstartIndex=-1,this.prevendIndex=-1,this.parent=e,r.Grid.Inject(_e),this.addEventListener()}return e.prototype.returnVisualData=function(e){e.data=this.visualData},e.prototype.getModuleName=function(){return"virtualScroll"},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on("localPagedExpandCollapse",this.collapseExpandVirtualchilds,this),this.parent.on("pagingActions",this.virtualPageAction,this),this.parent.on("destroy",this.destroy,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("localPagedExpandCollapse",this.collapseExpandVirtualchilds),this.parent.off("pagingActions",this.virtualPageAction),this.parent.off("destroy",this.destroy))},e.prototype.collapseExpandVirtualchilds=function(e){this.parent.grid.notify("virtual-action-args",{isExpandCollapse:!0}),this.expandCollapseRec=e.record,e.record.expanded="collapse"!==e.action;var r={result:this.parent.flatData,row:e.row,action:e.action,record:e.record,count:this.parent.flatData.length};(this.parent.enableVirtualization&&"Cell"===this.parent.selectionSettings.mode||"Row"===this.parent.selectionSettings.mode&&!this.parent.selectionSettings.persistSelection)&&this.parent.grid.clearSelection();var i=t.getValue("isCollapseAll",this.parent)?"collapseAll":"refresh";t.getValue("grid.renderModule",this.parent).dataManagerSuccess(r,{requestType:i})},e.prototype.virtualPageAction=function(e){var r=this,i=new n.DataManager(e.result),o=new n.Predicate("expanded","notequal",null).or("expanded","notequal",void 0),a=i.executeLocal((new n.Query).where(o)),s=a.filter(function(e){return h(r.parent,e,a)});this.visualData=s,this.parent.grid.notify("data-listener",{data:s});var d={startIndex:-1,endIndex:-1,count:e.count};this.parent.grid.notify("index-modifier",d);var l=d.startIndex,p=d.endIndex;if(e.count=s.length,-1===l&&-1===p){var c=new n.Query,u=this.parent.grid.pageSettings.pageSize,g=u*(this.parent.grid.pageSettings.currentPage-1);c=c.skip(g).take(u),i.dataSource.json=s,e.result=i.executeLocal(c)}else{var f=e.actionArgs.requestType;if(("filtering"===f||"collapseAll"===f||"searching"===f||"refresh"===f&&this.parent.enableCollapseAll&&p>s.length)&&(l=0,p=this.parent.grid.pageSettings.pageSize-1,this.parent.grid.getContent().firstElementChild.scrollTop=0,this.parent.grid.notify("virtual-action-args",{setTop:!0})),!t.isNullOrUndefined(this.expandCollapseRec)&&("virtualscroll"===e.actionArgs.requestType||"refresh"===e.actionArgs.requestType&&l!==this.prevstartIndex)&&l<this.parent.getRows().length&&p<=l+this.parent.getRows().length&&(l=0),!t.isNullOrUndefined(this.expandCollapseRec)){var y=this.parent.getRows(),m=s.indexOf(this.expandCollapseRec);s.slice(m,m+y.length).length<y.length&&m>=0&&0!==l?(l=m=(m=s.length-y.length)>0?m:0,p=s.length):t.getValue("isCollapseAll",this.parent)&&(l=0,p=this.parent.grid.pageSettings.pageSize-1,this.parent.grid.notify("virtual-action-args",{setTop:!0}))}!this.parent.enableCollapseAll&&!this.parent.expandStateMapping||t.isNullOrUndefined(this.expandCollapseRec)||(e.count<this.parent.getRows()[0].getBoundingClientRect().height?l=0:this.parent.isExpandAll||(l=-1===this.prevstartIndex?0:this.prevstartIndex)),this.expandCollapseRec=null,l=l<0?0:l,e.result=s.slice(l,p),this.prevstartIndex=l,this.prevendIndex=p}this.parent.notify("updateAction",e)},e.prototype.destroy=function(){this.removeEventListener()},e}(),_e=function(e){function i(r,i){var n=e.call(this,r,i)||this;return t.getValue("parent",n).off("initial-load",t.getValue("instantiateRenderer",n),n),t.getValue("parent",n).on("initial-load",n.instantiateRenderers,n),n}return Fe(i,e),i.prototype.getModuleName=function(){return"treeVirtualScroll"},i.prototype.instantiateRenderers=function(){var e=t.getValue("parent",this);t.getValue("parent",this).log(["limitation","virtual_height"],"virtualization");var i=t.getValue("locator",this).getService("rendererFactory");e.isFrozenGrid()||(e.enableColumnVirtualization&&t.getValue("addRenderer",i).apply(i,[r.RenderType.Header,new r.VirtualHeaderRenderer(t.getValue("parent",this),t.getValue("locator",this))]),t.getValue("addRenderer",i).apply(i,[r.RenderType.Content,new ze(t.getValue("parent",this),t.getValue("locator",this))])),this.ensurePageSize()},i.prototype.ensurePageSize=function(){var e=t.getValue("parent",this),r=e.getRowHeight();t.isNullOrUndefined(e.height)||"string"!=typeof e.height||-1===e.height.indexOf("%")||(e.element.style.height=e.height);var i=2*~~((e.height.toString().indexOf("%")<0?e.height:e.element.getBoundingClientRect().height)/r),n=e.pageSettings.pageSize;e.setProperties({pageSettings:{pageSize:n<i?i:n}},!0)},i}(r.VirtualScroll),He=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ge=function(e){function i(t,r){var i=e.call(this,t,r)||this;return i.addEventListener(),i}return He(i,e),i.prototype.renderTable=function(){this.freezeRowGenerator=new r.FreezeRowModelGenerator(this.parent),this.virtualRenderer=new ze(this.parent,this.serviceLoc),this.virtualRenderer.header=this.serviceLoc.getService("rendererFactory").getRenderer(r.RenderType.Header).virtualHdrRenderer,r.FreezeContentRender.prototype.renderTable.call(this),this.virtualRenderer.setPanel(this.parent.getContent()),this.scrollbar=this.parent.getContent().querySelector(".e-movablescrollbar");var e=this.getMovableContent(),t=this.parent.height;if(this.virtualRenderer.virtualEle.content=this.virtualRenderer.content=this.getPanel().querySelector(".e-content"),this.virtualRenderer.virtualEle.content.style.overflowX="hidden",this.virtualRenderer.virtualEle.renderFrozenWrapper(t),this.virtualRenderer.virtualEle.renderFrozenPlaceHolder(),this.parent.enableColumnVirtualization){this.virtualRenderer.virtualEle.movableContent=this.virtualRenderer.movableContent=this.getPanel().querySelector(".e-movablecontent"),this.virtualRenderer.virtualEle.renderMovableWrapper(t),this.virtualRenderer.virtualEle.renderMovablePlaceHolder();var i=e.querySelector("table");this.virtualRenderer.virtualEle.movableTable=i,this.virtualRenderer.virtualEle.movableWrapper.appendChild(i),e.appendChild(this.virtualRenderer.virtualEle.movableWrapper),e.appendChild(this.virtualRenderer.virtualEle.movablePlaceholder)}this.virtualRenderer.virtualEle.wrapper.appendChild(this.getFrozenContent()),this.virtualRenderer.virtualEle.wrapper.appendChild(e),this.virtualRenderer.virtualEle.table=this.getTable(),r.setDebounce(this.parent,this.virtualRenderer,this.scrollbar,this.getMovableContent())},i.prototype.appendContent=function(r,i,n){t.getValue("observer",this.virtualRenderer).options.debounceEvent=!1,this.virtualRenderer.observers=new Le(t.getValue("observer",this.virtualRenderer).element,t.getValue("observer",this.virtualRenderer).options,t.getValue("observer",this.virtualRenderer).movableEle),this.virtualRenderer.contents=this.getPanel().firstChild,e.prototype.appendContent.call(this,r,i,n)},i.prototype.generateRows=function(t,r){return e.prototype.generateRows.call(this,t,r)},i}(r.VirtualFreezeRenderer),Qe=function(e){function i(t,r){var i=e.call(this,t,r)||this;return i.serviceLoc=r,i.eventListener("on"),i}return He(i,e),i.prototype.renderTable=function(){this.virtualRenderer=new ze(this.parent,this.serviceLoc),this.virtualRenderer.header=this.serviceLoc.getService("rendererFactory").getRenderer(r.RenderType.Header).virtualHdrRenderer,this.freezeRowGenerator=new r.FreezeRowModelGenerator(this.parent),r.ColumnFreezeContentRenderer.prototype.renderTable.call(this),this.virtualRenderer.setPanel(this.parent.getContent()),this.scrollbar=this.parent.getContent().querySelector(".e-movablescrollbar");var t=this.getFrozenRightContent(),i=this.getFrozenContent(),n=this.getMovableContent();"Right"===this.parent.getFrozenMode()&&(i=t),this.virtualRenderer.virtualEle.content=this.virtualRenderer.content=this.getPanel().querySelector(".e-content"),this.virtualRenderer.virtualEle.content.style.overflowX="hidden";var o=this.parent.height;this.virtualRenderer.virtualEle.renderFrozenWrapper(o),this.virtualRenderer.virtualEle.renderFrozenPlaceHolder(),e.prototype.renderVirtualFrozenLeft.call(this,i,n),e.prototype.renderVirtualFrozenRight.call(this,i,n),e.prototype.renderVirtualFrozenLeftRight.call(this,i,n,t),this.virtualRenderer.virtualEle.table=this.getTable(),r.setDebounce(this.parent,this.virtualRenderer,this.scrollbar,this.getMovableContent())},i.prototype.appendContent=function(r,i,n){t.getValue("observer",this.virtualRenderer).options.debounceEvent=!1,this.virtualRenderer.observers=new Le(t.getValue("observer",this.virtualRenderer).element,t.getValue("observer",this.virtualRenderer).options,t.getValue("observer",this.virtualRenderer).movableEle),this.virtualRenderer.contents=this.getPanel().firstChild,e.prototype.appendContent.call(this,r,i,n)},i}(r.ColumnVirtualFreezeRenderer),Ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return He(t,e),t.prototype.renderTable=function(){e.prototype.renderTable.call(this)},t.prototype.rfshMovable=function(){e.prototype.rfshMovable.call(this)},t}(r.VirtualFreezeHdrRenderer),We=function(){function e(e){r.Grid.Inject(r.Freeze),this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on("rowExpandCollapse",this.rowExpandCollapse,this),this.parent.on("dataBoundArg",this.dataBoundArg,this),this.parent.grid.on("dblclick",this.dblClickHandler,this),this.parent.grid.on("initial-load",this.instantiateRenderer,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("rowExpandCollapse",this.rowExpandCollapse),this.parent.off("dataBoundArg",this.dataBoundArg),this.parent.grid.off("dblclick",this.dblClickHandler),this.parent.grid.off("initial-load",this.instantiateRenderer))},e.prototype.instantiateRenderer=function(){var e=t.getValue("serviceLocator",this.parent.grid).getService("rendererFactory");this.parent.getFrozenColumns()&&(this.parent.enableColumnVirtualization?t.getValue("addRenderer",e).apply(e,[r.RenderType.Header,new Ke(t.getValue("grid",this.parent),t.getValue("serviceLocator",this.parent.grid))]):t.getValue("addRenderer",e).apply(e,[r.RenderType.Header,new r.FreezeRender(t.getValue("grid",this.parent),t.getValue("serviceLocator",this.parent.grid))]),this.parent.enableVirtualization&&t.getValue("addRenderer",e).apply(e,[r.RenderType.Content,new Ge(t.getValue("grid",this.parent),t.getValue("serviceLocator",this.parent.grid))])),(this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenRightColumnsCount())&&(t.getValue("addRenderer",e).apply(e,[r.RenderType.Header,new r.ColumnFreezeHeaderRenderer(t.getValue("grid",this.parent),t.getValue("serviceLocator",this.parent.grid))]),this.parent.enableVirtualization?t.getValue("addRenderer",e).apply(e,[r.RenderType.Content,new Qe(t.getValue("grid",this.parent),t.getValue("serviceLocator",this.parent.grid))]):t.getValue("addRenderer",e).apply(e,[r.RenderType.Content,new r.ColumnFreezeContentRenderer(t.getValue("grid",this.parent),t.getValue("serviceLocator",this.parent.grid))]))},e.prototype.rowExpandCollapse=function(e){var r,i,n=this.parent.getMovableDataRows(),o=this.parent.getRows(),a=this.parent.getFrozenLeftColumnsCount()>0||this.parent.getFrozenRightColumnsCount()>0;a&&(i=this.parent.getFrozenRightRows().filter(function(t){return t.querySelector(".e-gridrowindex"+e.record.index+"level"+(e.record.level+1))})),r=e.detailrows.length?e.detailrows:n.filter(function(t){return t.querySelector(".e-gridrowindex"+e.record.index+"level"+(e.record.level+1))});for(var s=0;s<r.length;s++){var d=r[parseInt(s.toString(),10)],l=this.parent.grid.getRowObjectFromUID(d.getAttribute("data-Uid")).data;!t.isNullOrUndefined(n)&&d.parentElement.firstElementChild.clientHeight>0&&(d.style.height=d.parentElement.firstElementChild.clientHeight+"px"),d.style.display=e.action,a&&i.length&&(i[parseInt(s.toString(),10)].style.display=e.action);var p="none"===e.action?".e-treecolumn-container .e-treegridcollapse":".e-treecolumn-container .e-treegridexpand";if(o[d.rowIndex].querySelector(p)){for(var h=[],c=0;c<n.length;c++)n[parseInt(c.toString(),10)].querySelector(".e-gridrowindex"+l.index+"level"+(l.level+1))&&h.push(n[parseInt(c.toString(),10)]);if(h.length){var u=this.parent.getCurrentViewRecords()[h[0].rowIndex];this.rowExpandCollapse({detailrows:h,action:e.action,record:u})}}}},e.prototype.dblClickHandler=function(e){r.parentsUntil(e.target,"e-rowcell")&&this.parent.grid.editSettings.allowEditOnDblClick&&"Cell"!==this.parent.editSettings.mode&&!e.target.classList.contains("e-treegridcollapse")&&!e.target.classList.contains("e-treegridexpand")&&this.parent.grid.editModule.startEdit(r.parentsUntil(e.target,"e-row"))},e.prototype.dataBoundArg=function(){this.parent.getColumns().filter(function(e){return e.showCheckbox}).length&&this.parent.freezeModule&&this.parent.initialRender&&t.addClass([this.parent.element.getElementsByClassName("e-grid")[0]],"e-checkselection")},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.getModuleName=function(){return"freeze"},e}(),Ye=function(){function e(e){r.Grid.Inject(r.ColumnChooser),this.parent=e}return e.prototype.openColumnChooser=function(e,t){return this.parent.grid.columnChooserModule.openColumnChooser(e,t)},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"ColumnChooser"},e}(),Je=function(){function e(e){this.parent=e,r.Grid.Inject(r.InfiniteScroll),this.addEventListener()}return e.prototype.getModuleName=function(){return"infiniteScroll"},e.prototype.addEventListener=function(){this.parent.on("pagingActions",this.infinitePageAction,this),this.parent.on("infinite-remote-expand",this.infiniteRemoteExpand,this),this.parent.grid.on("delete-complete",this.infiniteDeleteHandler,this),this.parent.grid.on("infinite-edit-handler",this.infiniteEditHandler,this),this.parent.grid.on("infinite-crud-cancel",this.createRows,this),this.parent.grid.on("content-ready",this.contentready,this),this.parent.on("localPagedExpandCollapse",this.collapseExpandInfinitechilds,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("infinite-remote-expand",this.infiniteRemoteExpand),this.parent.grid.off("delete-complete",this.infiniteDeleteHandler),this.parent.grid.off("infinite-edit-handler",this.infiniteEditHandler),this.parent.off("pagingActions",this.infinitePageAction),this.parent.grid.off("infinite-crud-cancel",this.createRows),this.parent.grid.off("content-ready",this.contentready),this.parent.off("localPagedExpandCollapse",this.collapseExpandInfinitechilds))},e.prototype.infiniteRemoteExpand=function(e){for(var t=this.parent.grid.getRowsObject(),i=this.parent.grid.infiniteScrollModule.serviceLocator,n=new r.RowRenderer(i,null,this.parent.grid),o=this.parent.getRows(),a=e.index===o.length-1?"after":"before",s=this.parent.grid.getColumns(),d=this.parent.grid.infiniteScrollModule.generateRows(e.childData,e),l=[],p=0;p<d.length;p++)l.push(n.render(d[parseInt(p.toString(),10)],s));t.splice.apply(t,[e.index+1,0].concat(d));for(p=0;p<l.length;p++)"after"===a?o[e.index+p][""+a](l[parseInt(p.toString(),10)]):o[e.index+p+1][""+a](l[parseInt(p.toString(),10)]),o.splice(e.index+1+p,0,l[parseInt(p.toString(),10)]);r.resetRowIndex(this.parent.grid,this.parent.grid.getRowsObject(),this.parent.grid.getRows(),0)},e.prototype.contentready=function(){if(this.parent.infiniteScrollSettings.enableCache&&!t.isNullOrUndefined(this.parent.editModule)){this.parent.editModule.updateIndex(this.parent.grid.dataSource,this.parent.getRows(),this.parent.getCurrentViewRecords()),this.parent.getFrozenColumns()&&this.parent.editModule.updateIndex(this.parent.grid.dataSource,this.parent.getMovableDataRows(),this.parent.getCurrentViewRecords())}},e.prototype.collapseExpandInfinitechilds=function(e){e.record.expanded="collapse"!==e.action;var r={result:this.parent.flatData,row:e.row,action:e.action,record:e.record,count:this.parent.flatData.length},i=t.getValue("isCollapseAll",this.parent)?"collapseAll":"refresh";t.getValue("grid.renderModule",this.parent).dataManagerSuccess(r,{requestType:i})},e.prototype.infinitePageAction=function(e){var r=this,i=new n.DataManager(e.result),o=new n.Predicate("expanded","notequal",null).or("expanded","notequal",void 0),a=i.executeLocal((new n.Query).where(o)),s=a.filter(function(e){return h(r.parent,e,a)}),d=t.getValue("actionArgs",e.actionArgs),l=t.getValue("actions",this.parent.grid.infiniteScrollModule);this.parent.grid.infiniteScrollModule.isInitialRender&&!this.parent.initialRender&&(this.parent.grid.pageSettings.currentPage=1);var p=!!l.some(function(e){return e===d.requestType})||!!this.parent.initialRender;if(this.visualData=s,e.count=s.length,t.getValue("isPrinting",e.actionArgs))e.result=s;else{var c=new n.Query,u=this.parent.infiniteScrollSettings.enableCache;u&&this.parent.infiniteScrollSettings.initialBlocks>this.parent.infiniteScrollSettings.maxBlocks&&(this.parent.infiniteScrollSettings.initialBlocks=this.parent.infiniteScrollSettings.maxBlocks);var g=p?this.parent.grid.pageSettings.pageSize*this.parent.infiniteScrollSettings.initialBlocks:this.parent.grid.pageSettings.pageSize,f=this.parent.grid.pageSettings.currentPage;if(t.isNullOrUndefined(d))c=c.page(f,g);else{var y=t.getValue("lastIndex",this.parent.grid.infiniteScrollModule),m=t.getValue("firstIndex",this.parent.grid.infiniteScrollModule);if(u||"delete"!==d.requestType)u&&"delete"===d.requestType||"save"===d.requestType&&"add"===d.action?c=(c=c.skip(m)).take(this.parent.infiniteScrollSettings.initialBlocks*this.parent.pageSettings.pageSize):("expand"!==e.actionArgs.action&&"collapse"!==e.actionArgs.action||1===this.parent.grid.pageSettings.currentPage||(f=1,g=this.parent.grid.pageSettings.pageSize*this.parent.grid.pageSettings.currentPage),c=c.page(f,g));else{var v=y-d.data.length+1,S=d.data.length;c=c.skip(v).take(S)}}i.dataSource.json=s,u||t.isNullOrUndefined(d)||"save"!==d.requestType||"add"!==d.action?e.result=i.executeLocal(c):e.result=[d.data]}this.parent.notify("updateAction",e)},e.prototype.infiniteEditHandler=function(e){var t=this.parent.grid.infiniteScrollModule.infiniteCurrentViewData,r=Object.keys(t);if("delete"===e.e.requestType&&e.result.length>1)for(var i=1;i<e.result.length;i++)t[r[r.length-1]].push(e.result[parseInt(i.toString(),10)])},e.prototype.infiniteDeleteHandler=function(e){if("delete"===e.requestType){var t=this.parent.grid.getRowsObject(),r=this.parent.getRows(),i=e.data instanceof Array?e.data:[e.data],n=this.parent.grid.getPrimaryKeyFieldNames()[0];if(this.removeRows(r,t,i,n,!0),this.parent.getFrozenColumns()>0){var o=this.parent.grid.getMovableRowsObject(),a=this.parent.grid.getMovableRows();this.removeRows(a,o,i,n)}}},e.prototype.removeRows=function(e,r,i,n,o){for(var a=this,s=0;s<i.length;s++)!function(s){r.filter(function(d,l){if(d.data[""+n]===i[parseInt(s.toString(),10)][""+n]){if(o){var p=Math.ceil((l+1)/a.parent.grid.pageSettings.pageSize);a.parent.grid.infiniteScrollModule.resetInfiniteCurrentViewData(p,l)}r.splice(l,1),t.remove(e[parseInt(l.toString(),10)]),e.splice(l,1)}})}(s)},e.prototype.createRows=function(e){var i,n=e.args.e,o=e.row,a=this.parent.grid.infiniteScrollModule.serviceLocator,s=new r.RowRenderer(a,null,this.parent.grid),d=this.parent.getCurrentViewRecords(),l=e.isMovable?this.parent.grid.getMovableRows():this.parent.grid.getDataRows();i=e.isFrozenRight?this.parent.element.querySelector(".e-frozen-right-content").querySelector("tbody"):this.parent.grid.isFrozenGrid()?e.isMovable?this.parent.grid.getMovableVirtualContent().querySelector("tbody"):this.parent.grid.getFrozenVirtualContent().querySelector("tbody"):this.parent.getContent().querySelector("tbody"),this.parent.frozenRows&&(i=e.isFrozenRows&&"add"!==this.parent.grid.infiniteScrollModule.requestType||!e.isFrozenRows&&"add"===this.parent.grid.infiniteScrollModule.requestType?this.parent.grid.isFrozenGrid()?e.isMovable?this.parent.grid.getMovableVirtualHeader().querySelector("tbody"):e.isFrozenRight?this.parent.element.querySelector(".e-frozen-right-header").querySelector("tbody"):this.parent.grid.getFrozenVirtualHeader().querySelector("tbody"):this.parent.getHeaderContent().querySelector("tbody"):i);for(var p,h=this.parent.editModule.addRowIndex,u=0;u<o.length;u++){var g=s.render(o[parseInt(u.toString(),10)],this.parent.grid.getColumns());"save"===n.requestType&&"add"===n.action?-1!==t.getValue("selectedIndex",this.parent.editModule)&&"Top"!==this.parent.editSettings.newRowPosition?"Below"===this.parent.editSettings.newRowPosition||"Child"===this.parent.editSettings.newRowPosition?(p="after",h+=c(d[parseInt(h.toString(),10)]).length,"Child"===this.parent.editSettings.newRowPosition&&(h-=1),l[parseInt(h.toString(),10)][""+p](g)):"Above"===this.parent.editSettings.newRowPosition&&(p="before",l[this.parent.editModule.addRowIndex][""+p](g)):"Bottom"===this.parent.editSettings.newRowPosition?i.appendChild(g):i.insertBefore(g,i.firstElementChild):"delete"===n.requestType&&i.appendChild(g)}e.cancel=!0},e.prototype.destroy=function(){this.removeEventListener()},e}();return ye.Inject(be,Oe,Ae,me,Pe,Ee,ve,Ne,De,Me,Ve,ke,Ue,F,je,Be,Se,We,Ye,B,Je),e.TreeGrid=ye,e.load="load",e.rowDataBound="rowDataBound",e.dataBound="dataBound",e.queryCellInfo="queryCellInfo",e.beforeDataBound="beforeDataBound",e.actionBegin="actionBegin",e.dataStateChange="dataStateChange",e.actionComplete="actionComplete",e.rowSelecting="rowSelecting",e.rowSelected="rowSelected",e.checkboxChange="checkboxChange",e.rowDeselected="rowDeselected",e.toolbarClick="toolbarClick",e.beforeExcelExport="beforeExcelExport",e.beforePdfExport="beforePdfExport",e.resizeStop="resizeStop",e.expanded="expanded",e.expanding="expanding",e.collapsed="collapsed",e.collapsing="collapsing",e.remoteExpand="remoteExpand",e.localPagedExpandCollapse="localPagedExpandCollapse",e.pagingActions="pagingActions",e.printGridInit="printGrid-Init",e.contextMenuOpen="contextMenuOpen",e.contextMenuClick="contextMenuClick",e.beforeCopy="beforeCopy",e.beforePaste="beforePaste",e.savePreviousRowPosition="savePreviousRowPosition",e.crudAction="crudAction",e.beginEdit="beginEdit",e.beginAdd="beginAdd",e.recordDoubleClick="recordDoubleClick",e.cellSave="cellSave",e.cellSaved="cellSaved",e.cellEdit="cellEdit",e.batchDelete="batchDelete",e.batchCancel="batchCancel",e.batchAdd="batchAdd",e.beforeBatchDelete="beforeBatchDelete",e.beforeBatchAdd="beforeBatchAdd",e.beforeBatchSave="beforeBatchSave",e.batchSave="batchSave",e.keyPressed="key-pressed",e.updateData="update-data",e.doubleTap="double-tap",e.virtualColumnIndex="virtualColumnIndex",e.virtualActionArgs="virtual-action-args",e.destroy="destroy",e.dataListener="data-listener",e.indexModifier="index-modifier",e.beforeStartEdit="edit-form",e.beforeBatchCancel="before-batch-cancel",e.batchEditFormRendered="batcheditform-rendered",e.detailDataBound="detailDataBound",e.rowDrag="rowDrag",e.rowDragStartHelper="rowDragStartHelper",e.rowDrop="rowDrop",e.rowDragStart="rowDragStart",e.rowsAdd="rows-add",e.rowsRemove="rows-remove",e.rowdraging="row-draging",e.rowDropped="row-dropped",e.autoCol="auto-col",e.rowDeselecting="rowDeselecting",e.headerContent="e-headercontent",e.movableContent="e-movablecontent",e.movableHeader="e-movableheader",e.frozenContent="e-frozencontent",e.frozenHeader="e-frozenheader",e.content="e-content",e.table="e-table",e.leftRight="Left-Right",e.frozenRight="frozen-right",e.frozenLeft="frozen-left",e.dataColIndex="data-colindex",e.ariaColIndex="aria-colindex",e.dataRowIndex="data-rowindex",e.ariaRowIndex="aria-rowindex",e.DataManipulation=J,e.Reorder=me,e.Resize=ve,e.RowDD=Se,e.Column=R,e.EditSettings=ae,e.Predicate=O,e.FilterSettings=P,e.PageSettings=Z,e.SearchSettings=G,e.SelectionSettings=W,e.AggregateColumn=re,e.AggregateRow=ie,e.SortDescriptor=le,e.SortSettings=pe,e.RowDropSettings=Re,e.InfiniteScrollSettings=ue,e.LoadingIndicator=b,e.Render=Y,e.TreeVirtualRowModelGenerator=xe,e.isRemoteData=a,e.isCountRequired=s,e.isCheckboxcolumn=d,e.isFilterChildHierarchy=l,e.findParentRecords=p,e.getExpandStatus=h,e.findChildrenRecords=c,e.isOffline=u,e.extendArray=g,e.getPlainData=f,e.getParentData=y,e.isHidden=m,e.Filter=be,e.ExcelExport=De,e.PdfExport=Me,e.Page=Oe,e.Toolbar=Pe,e.Aggregate=Ee,e.Sort=Ae,e.TreeClipboard=L,e.ColumnMenu=Ne,e.ContextMenu=ke,e.Edit=Ue,e.CommandColumn=Ve,e.Selection=F,e.DetailRow=Be,e.VirtualScroll=je,e.TreeVirtual=_e,e.Freeze=We,e.ColumnChooser=Ye,e.Logger=B,e.treeGridDetails=T,e.InfiniteScroll=Je,e}({},ej.base,ej.grids,ej.buttons,ej.data,ej.popups),this.ejs=ej;
//# sourceMappingURL=ej2-treegrid.min.js.map
